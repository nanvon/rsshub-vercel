import{__dirname as e,init_esm_shims as t}from"./esm-shims-CtP6w_ML.js";import{config as n}from"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./proxy-kot7LoOQ.js";import{cache_default as r}from"./cache-CvppK6AM.js";import{art as i}from"./render-DE4LRFBD.js";import{parseDate as a}from"./parse-date-DHsdom8D.js";import{timezone as o}from"./timezone-CCdTtC9I.js";import{invalid_parameter_default as s}from"./invalid-parameter-CvwVNf6G.js";import{puppeteer_default as c}from"./puppeteer-DQCLzTv0.js";import l from"node:path";import u from"dayjs";import{createDecipheriv as d}from"node:crypto";t();const f=n.cache.contentExpire,p=6,m=async(e,t,n,r,i=`aweme`)=>{let a={url:`https://trendinsight.oceanengine.com/api/open/index/get_multi_keyword_hot_trend`,method:`POST`,data:JSON.stringify({keyword_list:[t],start_date:n,end_date:r,app_name:i})},o=await e.evaluate(e=>{function t(){let t=new Promise(t=>{let n=new XMLHttpRequest;n.open(e.method,e.url,!0),n.setRequestHeader(`accept`,`application/json, text/plain, */*`),n.setRequestHeader(`content-type`,`application/json;charset=UTF-8`),n.setRequestHeader(`tea-uid`,`7054893410171930123`),n.addEventListener(`readystatechange`,()=>{if(n.readyState===4&&n.status===200)t(n.responseText);else return}),n.send(e.data)});return t}return Promise.resolve(t()).then(e=>e)},a);return o[0]},h=`anN2bXA2NjYsamlh`,g=`amlheW91LHFpYW53`,_=`aes-128-cfb`,v=e=>{let t=Buffer.from(e,`base64`).toString(`hex`),n=d(_,h,g),r=n.update(t,`hex`,`utf8`)+n.final(`utf8`);return JSON.parse(r)},y=e=>[`https://tophub.today/search?e=tophub&q=${e}`,`https://www.baidu.com/s?wd=${e}`,`https://www.google.com/search?q=${e}`,`https://m.zhihu.com/search?type=content&q=${e}`,`https://s.weibo.com/weibo/${e}`,`https://www.douyin.com/search/${e}`,`https://so.toutiao.com/search?keyword=${e}`],b=[`ä»Šæ—¥çƒ­æ¦œ`,`ç™¾åº¦`,`è°·æ­Œ`,`çŸ¥ä¹`,`å¾®åš`,`æŠ–éŸ³`,`å¤´æ¡`],x=(t,n,r)=>i(l.join(e,`templates/content-1e5ec464.art`),{keyword:t,queryListText:r,queries:n.map(e=>({links:y(encodeURIComponent(e)).map((e,t)=>`<a href="${e}" rel="noopener noreferrer" target="_blank">${b[t]}</a>`),key:e}))}),S={path:`/index/:keyword/:channel?`,name:`Unknown`,maintainers:[`Jkker`],handler:C};async function C(e){let t=u(),n=t.subtract(p,`month`).format(`YYYYMMDD`),i=t.format(`YYYYMMDD`),l=e.req.param(`keyword`);if(!l)throw new s(`Invalid keyword`);if(e.req.param(`channel`)&&![`douyin`,`toutiao`].includes(e.req.param(`channel`)))throw new s("Invalid channelã€‚ Only support `douyin` or `toutiao`");let d=e.req.param(`channel`)===`toutiao`?`toutiao`:`aweme`,h=e.req.param(`channel`)===`toutiao`?`å¤´æ¡`:`æŠ–éŸ³`,g=`https://trendinsight.oceanengine.com/arithmetic-index/analysis?keyword=${l}&appName=${d}`,_=await r.tryGet(g,async()=>{let e=await c(),t=await e.newPage();await t.setRequestInterception(!0),t.on(`request`,e=>{e.resourceType()===`document`||e.resourceType()===`script`||e.resourceType()===`xhr`?e.continue():e.abort()}),await t.goto(`https://trendinsight.oceanengine.com/arithmetic-index`);let r=await m(t,l,n,i,d);await e.close();let s=JSON.parse(r).data,u=v(s).hot_list[0],f=Number.parseInt(u.average.search_average);return u.search_top_point_list.map(({date:e,query_list:t})=>{let n=Number.parseInt(u.search_hot_list.find(t=>t.datetime===e).index),r=Math.round((n-f)/f*100),i=r>0?`ğŸ“ˆ`:`ğŸ“‰`,s=t.filter(e=>e!==l),c=s.join(`, `),d=x(l,[l,...s],c);return{title:`${i} ${l} ${r}% | ${c}`,author:`å·¨é‡ç®—æ•° - ${h}ç®—æ•°æŒ‡æ•°`,description:d,link:g,pubDate:o(a(e),8),guid:`å·¨é‡ç®—æ•° - ${h}ç®—æ•°æŒ‡æ•° | ${l} - ${e}`}})},f,!1);return{title:`${l} - ${h}æŒ‡æ•°æ³¢å³°`,link:g,description:`å·¨é‡ç®—æ•° - ${h}ç®—æ•°æŒ‡æ•° | å…³é”®è¯: ${l}`,language:`zh-cn`,item:_}}export{S as route};