import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{got_default as e}from"./got-BwctkUCD.js";import t from"currency-symbol-map";const n={path:`/price/:country/:type/:id`,categories:[`program-update`],example:`/appstore/price/us/mac/id1152443474`,parameters:{country:"App Store Country, obtain from the app URL https://apps.apple.com/us/app/id1152443474, in this case, `us`",type:"App type，either `iOS` or `mac`",id:"App Store app id, obtain from the app URL https://apps.apple.com/us/app/id1152443474, in this case, `id1152443474`"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`apps.apple.com/`]}],name:`Price Drop`,maintainers:[`HenryQW`],handler:r,url:`apps.apple.com/`};async function r(n){let r=n.req.param(`country`),i=n.req.param(`type`).toLowerCase()===`mac`?`macapps`:`apps`,a=n.req.param(`id`).replace(`id`,``),o=`https://buster.cheapcharts.de/v1/DetailData.php?&store=itunes&country=${r}&itemType=${i}&idInStore=${a}`,s=await e({method:`get`,url:o,headers:{Referer:`http://www.cheapcharts.info/itunes/${r}/apps/detail-view/${a}`}});if(!s.data.results){let e=`当前 app 未被收录. Price monitor is not available for this app.`;return{title:e,item:[{title:e}]}}let c=s.data.results.apps;i===`macapps`&&(c=s.data.results.macapps);let l=[],u=`${r===`cn`?`限免提醒`:`Price watcher`}: ${c.title} for ${i===`macapps`?`macOS`:`iOS`}`,d=`https://apps.apple.com/${r}/app/id${a}`;if(c.priceDropIndicator===-1){let e={title:`${c.title} is now ${t(c.currency)}${c.price} `,description:`<a href="${d}" target="_blank">Go to App Store</a>`,link:d,guid:a+c.priceLastChangeDate};l.push(e)}return{title:u,link:d,item:l,allowEmpty:!0}}export{n as route};