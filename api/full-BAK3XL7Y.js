import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CDAeBYLA.js";import"./helpers-RrXnNmv1.js";import{cache_default as e}from"./cache-7MGQxbL-.js";import{got_default as t}from"./got-Cw4D6IS5.js";import{ViewType as n}from"./types-DygLf1a3.js";import{rss_parser_default as r}from"./rss-parser-CSgwUI7l.js";import{load as i}from"cheerio";const a=n=>e.tryGet(n,async()=>{let e=await t(n),r=i(e.data);r(`div.article-audio-player__center-tooltip`).remove();let a=JSON.parse(r(`head script[type="application/ld+json"]`).first().text()),o=r(`figure[class^=css-]`).first().parent().parent().html()||``,s=r(`p[data-component="paragraph"]`).parent().parent().html(),c=o+s,l=a.keywords?.map(e=>e);return{article:c,categories:l}}),o={path:`/:endpoint`,categories:[`traditional-media`,`popular`],view:n.Articles,example:`/economist/latest`,parameters:{endpoint:`Category name, can be found on the [official page](https://www.economist.com/rss). For example, https://www.economist.com/china/rss.xml to china`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`economist.com/:endpoint`]}],name:`Category`,maintainers:[`ImSingee`],handler:s};async function s(e){let t=e.req.param(`endpoint`),n=await r.parseURL(`https://www.economist.com/${t}/rss.xml`),i=await Promise.all(n.items.slice(0,e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):30).map(async e=>{let t=e.link.slice(e.link.lastIndexOf(`/`)+1),n=!/^\d{4}-\d{2}-\d{2}$/.test(t),r=n?await a(e.link):null;return{title:e.title,description:n?r.article:e.content,link:e.link,guid:e.guid,pubDate:e.pubDate,category:n?r.categories:null}}));return{title:n.title,link:n.link,description:n.description,item:i}}export{o as route};