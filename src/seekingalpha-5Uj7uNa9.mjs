import{n as e,t}from"./esm-shims-DIdKin6S.mjs";import"./config-PItPnVIx.mjs";import"./logger-BoKmWr7Z.mjs";import{t as n}from"./ofetch-rVU2XYFs.mjs";import{t as r}from"./cache-KwJARS5Z.mjs";import{t as i}from"./render-ZYpwNl2L.mjs";import{t as a}from"./parse-date-9Tu6hSFW.mjs";import o from"node:path";e();const s=`https://seekingalpha.com`,c={path:`/:symbol/:category?`,categories:[`finance`],example:`/seekingalpha/TSM/transcripts`,parameters:{symbol:`Stock symbol`,category:"Category, see below, `news` by default"},features:{antiCrawler:!0},radar:[{source:[`seekingalpha.com/symbol/:symbol/:category`,`seekingalpha.com/symbol/:symbol/earnings/:category`],target:`/:symbol/:category`}],name:`Summary`,maintainers:[`TonyRL`],handler:d,description:`| Analysis | News | Transcripts | Press Releases | Related Analysis |
| -------- | ---- | ----------- | -------------- | ---------------- |
| analysis | news | transcripts | press-releases | related-analysis |`},l=()=>r.tryGet(`seekingalpha:machine_cookie`,async()=>(await n.raw(s)).headers.getSetCookie().map(e=>e.split(`;`)[0])),u={article:{slug:`/articles`,include:`author,primaryTickers,secondaryTickers,otherTags,presentations,presentations.slides,author.authorResearch,author.userBioTags,co_authors,promotedService,sentiments`},news:{slug:`/news`,include:`author,primaryTickers,secondaryTickers,otherTags`},pr:{slug:`/press_releases`,include:`acquireService,primaryTickers`}};async function d(e){let{category:c=`news`,symbol:d}=e.req.param(),f=`${s}/symbol/${d.toUpperCase()}/${c===`transcripts`?`earnings/${c}`:c}`,p=await l(),m=await n(`${s}/api/v3/symbols/${d.toUpperCase()}/${c}`,{headers:{cookie:p.join(`; `)},query:{"filter[since]":0,"filter[until]":0,id:d.toLowerCase(),include:`author,primaryTickers,secondaryTickers,sentiments`,"page[size]":e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):c===`news`?40:20,"page[number]":1}}),h=m.data?.map(e=>({title:e.attributes.title,link:new URL(e.links.self,s).href,pubDate:a(e.attributes.publishOn),author:m.included.find(t=>t.id===e.relationships.author.data.id).attributes.nick,id:e.id,articleType:e.links.self.split(`/`)[1]})),g=h?await Promise.all(h.map(e=>r.tryGet(e.link,async()=>{let r=await n(`${s}/api/v3${u[e.articleType].slug}/${e.id}`,{headers:{cookie:p.join(`; `)},query:{include:u[e.articleType].include}});return e.category=r.included.filter(e=>e.type===`tag`).map(e=>e.attributes.company?`${e.attributes.company} (${e.attributes.name})`:e.attributes.name),e.description=(r.data.attributes.summary?.length?i(o.join(t,`templates/summary-32bc2e37.art`),{summary:r.data.attributes.summary}):``)+r.data.attributes.content,e.updated=a(r.data.attributes.lastModified),e}))):[];return{title:m.meta.page.title,description:m.meta.page.description,link:f,image:`https://seekingalpha.com/samw/static/images/favicon.svg`,item:g,allowEmpty:!0,language:`en-US`}}export{c as route};