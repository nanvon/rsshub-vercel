import{__dirname as e,init_esm_shims as t}from"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-DqHh1IN2.js";import"./helpers-gUVC02jt.js";import{art as n}from"./render-CSnicFA3.js";import{parseDate as r}from"./parse-date-DHsdom8D.js";import{got_default as i}from"./got-VGofQtEf.js";import{invalid_parameter_default as a}from"./invalid-parameter-CfUmvEUg.js";import o from"node:path";import{load as s}from"cheerio";t();const c={path:`/album/:id`,categories:[`multimedia`],example:`/iqiyi/album/神武天尊-2020-1b4lufwxd7h`,parameters:{id:`剧集 id, 可在该主页 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`剧集`,maintainers:[`TonyRL`],handler:l,description:`::: tip
  可抓取內容根据服务器所在地区而定
:::`};async function l(t){let c=t.req.param(`id`),{data:l}=await i(`https://www.iq.com/album/${c}`),u=s(l),{album:d}=JSON.parse(u(`#__NEXT_DATA__`).text()).props.initialState,{data:{data:f}}=await i(`https://pcw-api.iqiyi.com/album/album/baseinfo/${d.videoAlbumInfo.albumId}`);if(Object.keys(d.cacheAlbumList).length===0)throw new a(`${f.name} is not available in this server region.`);let p=1,m=!1,h=[];do{let{data:{data:e}}=await i(`https://pcw-api.iq.com/api/v2/episodeListSource/${d.videoAlbumInfo.albumId}`,{searchParams:{platformId:3,modeCode:`intl`,langCode:`zh_cn`,endOrder:d.videoAlbumInfo.maxOrder,startOrder:p}});h=[...h,...e.epg],p=e.pos,m=e.hasMore}while(m);let g=h.map(t=>({title:t.name,description:n(o.join(e,`templates/album-456d4501.art`),{item:t}),link:`https://www.iq.com/play/${t.playLocSuffix}`,pubDate:r(t.initIssueTime)}));return{title:f.name,description:f.description,image:d.videoAlbumInfo.albumFocus1024,link:`https://www.iq.com/album/${d.videoAlbumInfo.albumLocSuffix}`,item:g,allowEmpty:!0}}export{c as route};