import"./esm-shims-DhF_MXa4.mjs";import{t as e}from"./config-PItPnVIx.mjs";import"./logger-BoKmWr7Z.mjs";import"./ofetch-DVhBwO41.mjs";import"./helpers-vRt84cId.mjs";import{t}from"./cache-KwJARS5Z.mjs";import{t as n}from"./parse-date-9Tu6hSFW.mjs";import{r}from"./common-utils-Cj5w6--o.mjs";import{t as i}from"./got-D_XeVuz-.mjs";import{t as a}from"./timezone-CQaZZkB1.mjs";import{t as o}from"./config-not-found-B5bqcMj-.mjs";import{load as s}from"cheerio";import c from"iconv-lite";const l=new Set([`www.xbiquwx.la`,`www.biqu5200.net`,`www.xbiquge.so`,`www.biqugeu.net`,`www.b520.cc`,`www.ahfgb.com`,`www.ibiquge.la`,`www.biquge.tv`,`www.bswtan.com`,`www.biquge.co`,`www.bqzhh.com`,`www.biqugse.com`,`www.ibiquge.info`,`www.ishuquge.com`,`www.mayiwxw.com`]),u={path:`*`,name:`Unknown`,maintainers:[],handler:d};async function d(u){let d=r(u).split(`/`).slice(1,4).join(`/`),f=r(u).slice(1);if(!e.feature.allow_user_supply_unsafe_domain&&!l.has(new URL(d).hostname))throw new o(`This RSS is disabled unless 'ALLOW_USER_SUPPLY_UNSAFE_DOMAIN' is set to 'true'.`);let p=await i({method:`get`,url:f,responseType:`buffer`,https:{rejectUnauthorized:!1}}),m=/charset="?'?gb/i.test(p.data.toString())?`gbk`:`utf-8`,h=s(c.decode(p.data,m)),g=h(`meta[property="og:novel:author"]`).attr(`content`),_=a(n(h(`meta[property="og:novel:update_time"]`).attr(`content`)),8),v=h(`dl dd a`).toArray().toReversed().slice(0,u.req.query(`limit`)?Number.parseInt(u.req.query(`limit`)):1).map(e=>{e=h(e);let t=``,n=e.attr(`href`);return t=n.startsWith(`http`)?n:/^\//.test(n)?`${d}${n}`:`${f}/${n}`,{title:e.text(),link:t,author:g,pubDate:_}});return v=await Promise.all(v.map(e=>t.tryGet(e.link,async()=>{let t=await i({method:`get`,url:e.link,responseType:`buffer`,https:{rejectUnauthorized:!1}});return e.description=s(c.decode(t.data,m))(`#content`).html(),e}))),{title:`${h(`meta[property="og:title"]`).attr(`content`)} - 笔趣阁`,link:f,item:v}}export{u as route};