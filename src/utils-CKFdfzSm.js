import{__dirname as e,init_esm_shims as t}from"./esm-shims-rNwigI-Q.js";import{ofetch_default as n}from"./ofetch-CeMUzp5K.js";import{cache_default as r}from"./cache-Dfid4xgQ.js";import{art as i}from"./render-DftO2d-b.js";import{parseDate as a}from"./parse-date-DHsdom8D.js";import o from"node:path";import{load as s}from"cheerio";t();const c=`https://dribbble.com`;async function l(t){let r=s(await n(t)),c=JSON.parse(r(`script`).text().match(/shotData:\s({.+?}),\n/)?.[1]??`{}`),l=r(`.media-shot, .main-shot, .block-media-wrapper`).toArray().map(e=>{let t=r(e);return t.find(`span.cropped-indicator, button`).remove(),t.find(`video`).each((e,t)=>{t=r(t),!t.attr(`src`)&&t.data(`src`)&&(t.attr(`src`,t.data(`src`)),t.removeAttr(`data-src`),t.removeAttr(`data-video-small`),t.removeAttr(`data-video-medium`),t.removeAttr(`data-video-large`))}),t.find(`img`).each((e,t)=>{t=r(t),t.data(`animated-url`)&&(t.attr(`src`,t.data(`animated-url`)),t.removeAttr(`data-animated-url`),t.removeAttr(`srcset`)),!t.attr(`src`)&&t.data(`src`)&&(t.attr(`src`,t.data(`src`).split(`?`)[0]),t.removeAttr(`data-src`)),t.attr(`src`,t.attr(`src`).split(`?`)[0]),t.removeAttr(`srcset`),t.removeAttr(`data-srcset`)}),t.find(`a`).each((e,t)=>{t=r(t),t.removeAttr(`data-pswp-srcset`)}),t.html()}).join(``),u=r(`.shot-description-container`),d=`${c.shotUser.name}${c.shotUser.team.length?` for ${c.shotUser.team.name}`:``}`;return{description:i(o.join(e,`templates/description-4f32d945.art`),{shotMedia:l,shotData:c,description:u}),pubDate:a(c.postedOn),author:d,category:c.tags}}function u(e){return Promise.all(e.map(e=>{let t=s(e),n=t(e).data(`thumbnail-id`),i=new URL(`/shots/${n}`,c).href,a=new URL(t(e).find(`.shot-thumbnail-link`).attr(`href`),c).href;return r.tryGet(i,async()=>{let{description:e,pubDate:n,author:r,category:o}=await l(a);return{title:t(`.shot-title`).text(),link:a,guid:i,description:e,pubDate:n,author:r,category:o}})}))}var d={getData:async(e,t)=>{let r=s(await n(e)),i=await u(r(`ol.dribbbles.group > li`).toArray());return{title:t,link:e,description:r(`meta[name="description"]`).attr(`content`),item:i}}};export{d as utils_default};