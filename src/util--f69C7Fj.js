import{n as e,t}from"./esm-shims-BC3isTv8.js";import{t as n}from"./render-d6AVTUl2.js";import{t as r}from"./parse-date-CHEO0z5G.js";import{t as i}from"./got-dCh-Ojgc.js";import a from"node:path";import{load as o}from"cheerio";e();const s=`xinpianchang.com`,c=`https://www.${s}`,l=`https://mod-api.${s}`,u=(e,t)=>t(e,async()=>{let{data:t}=await i(e),n=o(t),r=new URL(`favicon.ico`,c).href,a=n(`meta[property="og:site_name"]`).prop(`content`);return{data:{title:n(`span.bg-clip-text`).text()||`${a}Â·${n(`meta[property="og:title"]`).prop(`content`).split(`-`)[0]}`,link:e,description:n(`meta[property="og:description"]`).prop(`content`),language:n(`html`).prop(`lang`),image:n(`meta[property="og:image"]`).prop(`content`),icon:r,logo:r,subtitle:n(`meta[property="og:description"]`).prop(`content`),author:a,itunes_author:a,itunes_category:`TV &amp Film`,allowEmpty:!0},response:t}}),d=async(e,o)=>(e=e.map(e=>({title:e.title,link:e.web_url,description:e.content,author:e.author.userinfo.username,category:e.categories.flatMap(e=>[e.category_name,e.sub?.category_name]).filter(Boolean),guid:`xinpianchang-${e.id}`,pubDate:r(e.publish_time*1e3),itunes_item_image:e.cover,itunes_duration:e.duration,enclosure_url:e.video_library_id,upvotes:e.count.count_liked??e.count.count_like,comments:e.count.count_comment??0})),await Promise.all(e.map(e=>o(e.guid,async()=>{let r=new URL(`mod/api/v2/media/${e.enclosure_url}?appKey=61a2f329348b3bf77`,l).href,{data:o}=await i(r),s=o.data,c=s.resource?.progressive?s.resource.progressive[0]:void 0;return e.title=s.title??e.title,e.description=n(a.join(t,`templates/description-f6d7881b.art`),{content:e.description,cover:s.cover??e.itunes_item_image,enclousure:c}),e.author=s.owner.username??e.author,e.category=[...new Set([...e.category,...s.categories??[],...s.keywords??[]])],e.itunes_item_image=s.cover??e.itunes_item_image,e.itunes_duration=s.duration??e.itunes_duration,c&&(e.enclosure_url=c.url??c.backupUrl,e.enclosure_length=c.filesize,e.enclosure_type=c.mime),e}))));export{d as n,c as r,u as t};