import"./esm-shims-BGJi2y--.js";import{config as e}from"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-DqHh1IN2.js";import"./helpers-gUVC02jt.js";import{cache_default as t}from"./cache-Dfid4xgQ.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./md5-15Cn4YyR.js";import{got_default as r}from"./got-VGofQtEf.js";import{ViewType as i}from"./types-Bi82qguM.js";import{header as a}from"./utils-BFDjMQlh.js";const o={path:`/people/allCollections/:id`,categories:[`social-media`],view:i.Articles,example:`/zhihu/people/allCollections/87-44-49-67`,parameters:{id:`作者 id，可在用户主页 URL 中找到`},features:{requireConfig:[{name:`ZHIHU_COOKIES`,description:``}],requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.zhihu.com/people/:id`]}],name:`用户全部收藏内容`,maintainers:[`Healthyyue`],handler:s};async function s(i){let o=i.req.param(`id`),s=`https://api.zhihu.com/people/${o}/collections`,c=(await r(s,{headers:{cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/people/${o}/collections`}})).data.data,l=(await Promise.all(c.map(async n=>{let{data:i,paging:{totals:o}}=(await r(`https://www.zhihu.com/api/v4/collections/${n.id}/items?offset=0&limit=20`,{headers:{...a,cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/collection/${n.id}`}})).data;if(o>20){let s=Array.from({length:Math.ceil(o/20)-1},(e,t)=>(t+1)*20),c=await Promise.all(s.map(i=>t.tryGet(`https://www.zhihu.com/api/v4/collections/${n.id}/items?offset=${i}&limit=20`,async()=>(await r(`https://www.zhihu.com/api/v4/collections/${n.id}/items?offset=${i}&limit=20`,{headers:{...a,cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/collection/${n.id}`}})).data.data)));i.push(...c.flat())}return{collectionId:n.id,collectionTitle:n.title,items:i}}))).flatMap(e=>e.items.map(t=>({...t,collectionTitle:e.collectionTitle})));return{title:`${c[0].creator.name}的知乎收藏`,link:`https://www.zhihu.com/people/${o}/collections`,item:l.map(e=>{let t=e.content;return{title:t.type===`article`||t.type===`zvideo`?t.title:t.question.title,link:t.url,description:t.type===`zvideo`?`<img src=${t.video.url}/>`:t.content,pubDate:n((t.type===`article`?t.updated:t.updated_time)*1e3),category:[e.collectionTitle]}})}}export{o as route};