import{n as e,t}from"./esm-shims-L08rKynx.mjs";import{t as n}from"./ofetch-1TBKTiHL.mjs";import{t as r}from"./render-CBhnapAf.mjs";import{t as i}from"./parse-date-bKmkZ9gg.mjs";import a from"node:path";e();const o=`https://www.newslaundry.com`;async function s(e,t,r=!1){let i=`${o}/api/v1/collections/${e}`,a=t||`${o}/${e}`,s=await n(i);if(!s.items||!s.items.length)throw Error(`No articles found`);let l=(r?s.items.slice(1):s.items).map(e=>c(e.story));return{title:`${s.name} - Newslaundry`,description:s.summary||`${s.name} articles from Newslaundry`,link:a,item:l,language:`en`,logo:`${o}/favicon.ico`,icon:`${o}/favicon.ico`}}function c(e){let n=e.url,s=e[`published-at`]?i(e[`published-at`]):null,c=e[`hero-image-s3-key`]?`https://media.assettype.com/${e[`hero-image-s3-key`]}?auto=format%2Ccompress&fit=max&dpr=1.0&format=webp`:null,l=e.cards?.flatMap(e=>e?.[`story-elements`]?.map(e=>{if(e.type===`text`&&e.text)return{type:`text`,text:e.text};if(e.type===`image`&&e[`image-s3-key`])return{type:`image`,url:`https://media.assettype.com/${e[`image-s3-key`]}?auto=format%2Ccompress&format=webp`,alt:e[`alt-text`]||``,title:e.title||``};if(e.type===`jsembed`&&e[`embed-js`])try{return{type:`jsembed`,content:Buffer.from(e[`embed-js`],`base64`).toString()}}catch{return null}else if(e.type===`youtube-video`&&e.url)return{type:`youtube-video`,url:e.url,embedUrl:e[`embed-url`]||``};return null}).filter(Boolean)||[])||[],u=r(a.join(t,`templates/description-d23336fb.art`),{heroImage:c,heroAlt:e[`hero-image-alt-text`]||``,heroCaption:e[`hero-image-caption`]||``,heroAttribution:e[`hero-image-attribution`],elements:l,subheadline:e.subheadline}),d=e.authors?.map(e=>({name:e.name,url:e.slug?`${o}/author/${e.slug}`:void 0}))||[];return{title:e.headline,link:n,image:c,description:u||e.subheadline,pubDate:s,updated:e[`last-correction-published-at`]?i(e[`last-correction-published-at`]):void 0,author:d.length>0?d:e[`author-name`],category:e.tags?.map(e=>e.name)||[]}}export{o as n,s as t};