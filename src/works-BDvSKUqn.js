import"./esm-shims-DE2PJqdr.js";import{config as e}from"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as t}from"./ofetch-CJF2SF6b.js";import{cache_default as n}from"./cache-Dfid4xgQ.js";import"./render-CSnicFA3.js";import{config_not_found_default as r}from"./config-not-found-mNOcOzCd.js";import{baseUrl as i,processWork as a}from"./utils-lcp-BLxO.js";const o={path:`/works/:username`,categories:[`picture`],example:`/skeb/works/@brm2_1925`,parameters:{username:`Skeb Username with @`},features:{requireConfig:[{name:`SKEB_BEARER_TOKEN`,optional:!1,description:'在瀏覽器開發者工具（F12）的主控台中輸入 `localStorage.getItem("token")` 獲取'}],requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`Creator Works`,maintainers:[`SnowAgar25`],handler:s,radar:[{title:`Creator Works`,source:[`skeb.jp/:username`],target:`/works/:username`}],description:`Get the latest works of a specific creator on Skeb`};async function s(o){let s=o.req.param(`username`);if(!e.skeb||!e.skeb.bearerToken)throw new r(`Skeb works RSS is disabled due to the lack of <a href="https://docs.rsshub.app/deploy/config#route-specific-configurations">relevant config</a>`);let c=`${i}/api/users/${s.replace(`@`,``)}/works`,l=await n.tryGet(c,async()=>{let r=async(i=0,a=3)=>await t(c,{retry:0,method:`GET`,query:{role:`creator`,sort:`date`,offset:`0`},headers:{"User-Agent":e.ua,Cookie:`request_key=${n.get(`skeb:request_key`)}`,Authorization:`Bearer ${e.skeb.bearerToken}`}}).catch(e=>{if(i>=a)throw Error(`Max retries reached`);let t=e.response?._data?.match(/request_key=(.*?);/)?.[1];if(t)return n.set(`skeb:request_key`,t),r(i+1,a);throw e}),i=await r();if(!i||!Array.isArray(i))throw Error(`Invalid data received from API`);return i.map(e=>a(e)).filter(Boolean)});return{title:`Skeb - ${s}'s Works`,link:`${i}/${s}`,item:l}}export{o as route};