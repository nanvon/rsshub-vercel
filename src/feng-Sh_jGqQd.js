import{n as e,t}from"./esm-shims-CMsyBHYK.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CRUPiVpr.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-BlqYKpVp.js";import{t as o}from"./timezone-BPfwRbwD.js";import s from"node:path";import{load as c}from"cheerio";e();const l=e=>e.map(e=>{let t=e.type;return t===`video`?u(e.data):t===`text`?e.data.replaceAll(/data-lazyload=(.+?) src=(.+?) style=".+?"/g,`src=$1`):``}).join(`<br>`),u=e=>r(s.join(t,`templates/video-e05cff83.art`),{videoInfo:e}),d={path:`/feng/:id/:type`,categories:[`new-media`],example:`/ifeng/feng/2583/doc`,parameters:{id:`对应 id，可在 大风号作者页面 找到`,type:`类型，见下表`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`大风号`,maintainers:[`Jamch`],handler:f,description:`| 文章 | 视频  |
| ---- | ----- |
| doc  | video |`};async function f(e){let{id:t,type:r}=e.req.param(),{data:s}=await a(`https://ishare.ifeng.com/mediaShare/home/${t}/media`,{headers:{Referer:`https://feng.ifeng.com/author/${t}`}}),{data:d}=await a(`https://shankapi.ifeng.com/season/ishare/getShareListData/${t}/${r}/1/ifengnewsh5/getListData`,{headers:{Referer:`https://feng.ifeng.com/author/${t}`}}),f=c(s),{sockpuppetInfo:p}=JSON.parse(f(`script`).text().match(/var allData = (.*?);/)[1]),{data:m}=JSON.parse(d.match(/getListData\((.*)\)/)[1]),{weMediaName:h,honorDesc:g,description:_,logo:v}=p,y=m.map(e=>({title:e.title,pubDate:o(i(e.newsTime),8),author:h,link:`https:${e.url}`})),b=await Promise.all(y.map(e=>n.tryGet(e.link,async()=>{let{data:t}=await a(e.link),n=c(t),i=JSON.parse(n(`script`).text().match(/var allData = ({.*?});/)[1]);return r===`doc`&&(e.description=l(i.docData.contentData.contentList)),r===`video`&&(e.description=u(i.videoInfo)),e.category=i.keywords.split(`,`),e.author=i.docData?.editorName??e.author,e})));return{title:`大风号-${h}-${r===`doc`?`文章`:`视频`}`,description:`${g} ${_}`,image:`https:${v}`,link:`https://ishare.ifeng.com/mediaShare/home/${t}/media`,item:b}}export{d as route};