import{t as e}from"./config-CDM38Tpk.mjs";import"./logger-B0B1yUZ6.mjs";import{t}from"./cache-C6z2tE2n.mjs";import{n}from"./parse-date-Cv8vEJfE.mjs";import{t as r}from"./types-CypZ_btd.mjs";import{load as i}from"cheerio";async function a(t,n){try{return(await(await fetch(`${e.puppeteerRealBrowserService}?url=${encodeURIComponent(t)}&selector=${encodeURIComponent(n)}`)).json()).data?.at(0)||``}catch{return``}}const o={path:`/user/:id/:type?`,categories:[`social-media`],example:`/picnob/user/xlisa_olivex`,parameters:{id:`Instagram id`,type:`Type of profile page (profile or tagged)`},features:{requireConfig:!1,requirePuppeteer:!0,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.pixnoy.com/profile/:id`],target:`/user/:id`},{source:[`www.pixnoy.com/profile/:id/tagged`],target:`/user/:id/tagged`}],name:`User Profile - Pixnoy`,maintainers:[`TonyRL`,`micheal-death`,`AiraNadih`,`DIYgod`,`hyoban`],handler:s,view:r.Pictures};async function s(r){if(!e.puppeteerRealBrowserService)throw Error(`PUPPETEER_REAL_BROWSER_SERVICE is required to use this route.`);let o=`https://www.pixnoy.com`,s=r.req.param(`id`),c=r.req.param(`type`)??`profile`,l=`${o}/profile/${s}/${c===`tagged`?`tagged/`:``}`,u=await a(l,`.post_box`);if(!u)throw Error(`Failed to fetch user profile page. User may not exist or there are no posts available.`);let d=i(u),f=d(`.post_box`).toArray().map(e=>{let t=d(e),r=t.find(`.cover_link`).attr(`href`),i=r?.split(`/`)?.[2],a=t.find(`.cover .cover_link img`),s=a.attr(`alt`)||``;return{title:s,description:`<img src="${a.attr(`data-src`)}" /><br />${s}`,link:`${o}${r}`,guid:i,pubDate:n(t.find(`.time .txt`).text())}}),p=(await Promise.all(f.map(e=>t.tryGet(`picnob:user:${s}:${e.guid}:html`,async()=>await a(e.link,`.view`))))).map(e=>{if(!e)return``;let t=i(e);if(t(`.video_img`).length>0)return`<video src="${t(`.video_img a`).attr(`href`)}" poster="${t(`.video_img img`).attr(`data-src`)}"></video><br />${t(`.sum_full`).text()}`;{let e=``;for(let n of t(`.pic img`).toArray())e+=`<img src="${t(n).attr(`data-src`)}" /><br />`;return e+=t(`.sum_full`).text(),e}});return{title:`${d(`h1.fullname`).text()} (@${s}) ${c===`tagged`?`tagged`:`public`} posts - Picnob`,description:d(`.info .sum`).text(),link:l,image:d(`.ava .pic img`).attr(`src`),item:f.map((e,t)=>({...e,description:p[t]||e.description}))}}export{o as route};