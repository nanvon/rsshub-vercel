import{__dirname as e,init_esm_shims as t}from"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as n}from"./ofetch-CISb_5Uo.js";import{cache_default as r}from"./cache-Dfid4xgQ.js";import{art as i}from"./render-CSnicFA3.js";import{parseDate as a}from"./parse-date-DHsdom8D.js";import{timezone as o}from"./timezone-CMz5pnRe.js";import s from"node:path";import{load as c}from"cheerio";t();const l=t=>i(s.join(e,`templates/mod-810bfe96.art`),{mod:t}),u={path:`/:type`,categories:[`game`],example:`/mcmod/new`,parameters:{type:`查询类型，详见下表`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`最新MOD`,maintainers:[`hualiong`],description:`\`:type\` 类型可选如下

| 随机显示MOD | 最新收录MOD | 最近编辑MOD |
| ------ | --- | ---- |
| random | new | edit |`,handler:async e=>{let t=e.req.param(`type`),i=n.create({baseURL:`https://www.mcmod.cn`}),s=await i(`/`),u=c(s),d=u(`div.left > ul > li[i='${t}']`).attr(`title`),f=u(`#indexNew_${t} > .block`).toArray().map(e=>{let t=u(e),n=t.find(`div .time`);return{title:t.find(`div > .name > a`).text(),image:t.find(`img`).attr(`src`)?.split(`@`)[0],link:t.children(`a`).attr(`href`),pubDate:n.attr(`title`)&&o(a(n.attr(`title`).slice(6),`YYYY-MM-DD HH:mm:ss`),8)}}),p=await Promise.all(f.map(e=>r.tryGet(e.link,async()=>{let t=await i(e.link),n=c(t);e.author=n(`.author li`).toArray().map(e=>{let t=n(e),r=t.find(`.name a`);return{name:r.text(),url:`https://www.mcmod.cn`+r.attr(`href`),avatar:t.find(`.avatar img`).attr(`src`)?.split(`?`)[0]}});let r=n(`.common-text[data-id="1"]`).html(),a=n(`.mcver > ul > ul`).toArray().map(e=>{let t=n(e),r=t.children(`li:first-child`).text(),i=t.children(`li:not(:first-child)`).toArray().map(e=>n(e).text()).join(`，`);return{label:r,versions:i}});return e.description=l({pic:`https:`+e.image,label:n(`.class-info  li.col-lg-4`).toArray().map(e=>n(e).text()),support:a})+r.replaceAll(/\ssrc=".+?"/g,``).replaceAll(`data-src`,`src`),e})));return{title:`${d} - MC百科`,description:u(`meta[name="description"]`).attr(`content`),link:`https://www.mcmod.cn`,item:p}}};export{u as route};