import{t as e}from"./md5-DQN6cWFb.mjs";import{t}from"./cache-Bv3_kFbE.mjs";import{t as n}from"./parse-date-_GmTZfjS.mjs";import{t as r}from"./got-BglkE51W.mjs";import{load as i}from"cheerio";const a={0:`基本动态`,8:`酷图`,9:`评论`,10:`提问`,11:`回答`,12:`图文`,15:`二手`,17:`观点`,20:`交易动态`},o=()=>{let e=[10,6,6,6,14];return e=e.map(e=>Math.random().toString(36).substring(2,e)),e.join(`-`)},s=()=>{let t=o(),n=Math.round(Date.now()/1e3),r=`0x`+n.toString(16),i=`token://com.coolapk.market/c67ef5943784d09750dcfbb31020f0ab?`+e(n.toString())+`$`+t+`&com.coolapk.market`;return e(Buffer.from(i).toString(`base64`))+t+r},c=()=>({"X-Requested-With":`XMLHttpRequest`,"X-App-Id":`com.coolapk.market`,"X-App-Token":s(),"X-Sdk-Int":`29`,"X-Sdk-Locale":`zh-CN`,"X-App-Version":`11.0`,"X-Api-Version":`11`,"X-App-Code":`2101202`,"User-Agent":`Dalvik/2.1.0 (Linux; U; Android 10; Redmi K30 5G MIUI/V12.0.3.0.QGICMXM) (#Build; Redmi; Redmi K30 5G; QKQ1.191222.002 test-keys; 10) +CoolMarket/11.0-2101202`}),l=e=>e.map(e=>e.type===`text`?e.message.split(`
`).filter(e=>e!==``).map(e=>`<p>${e}</p>`).join(``):e.type===`image`?`<div class="img-container" style="text-align: center;">
                <img src="${e.url}">
                <p class="image-caption" style="text-align: center;">${e.description}</p></div>`:`Unkown type`);var u={get_app_token:s,base_url:`https://api.coolapk.com`,getHeaders:c,parseDynamic:async e=>{let a=n(e.dateline,`X`);if(e.entityType===`sponsorCard`||!e.url)return;let o=`https://api2.coolapk.com/v6${e.url.replace(`/feed/`,`/feed/detail?id=`)}`,s,u,d=Number.parseInt(e.type);switch(d){case 0:case 5:case 7:case 8:case 9:case 10:case 11:case 13:case 15:case 17:case 20:if(e.issummary)s=await t.tryGet(o,async()=>`<p>`+(await r(o,{headers:c()})).data.data?.message.split(`
`).join(`<br>`)+`</p>`+e.picArr.filter(Boolean).map(e=>`<img src="${e}">`).join(``));else{let t=e.picArr.filter(Boolean).map(e=>`<img src="${e}">`);s=`<p>`+e.message+`</p>`+t.join(``)}if(u=i(`<div class="title-filter">`+s+`</div>`)(`.title-filter`).text().trim(),d===17){let t=e.extra_key.split(`,`);s+=`<p>`+e.vote.message_title+` 已选${t.length}项</p>`;for(let n of e.vote.options)t.includes(String(n.id))&&(s+=`<p>${n.title}√</p>`)}else (d===10||d===11)&&(u=`${e.message_title} 更多:`+u);break;case 12:u=e.title,s=await t.tryGet(o,async()=>{let e=await r(o,{headers:c()}),t=l(JSON.parse(e.data.data.message_raw_output));return`<img src="${e.data.data.pic}"><hr>`+t.join(``)});break;default:break}return{title:u,description:s,pubDate:a,link:`https://www.coolapk.com${e.url}`,author:e.username}},dynamicTpye:a};export{u as t};