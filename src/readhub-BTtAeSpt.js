import{n as e,t}from"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CfXAR0UO.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-dCh-Ojgc.js";import{i as o,n as s,r as c}from"./util-Cb9eb8u0.js";import l from"node:path";import{load as u}from"cheerio";e();const d={path:`/:category?`,categories:[`new-media`],example:`/readhub`,parameters:{category:`分类，见下表，默认为热门话题`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`分类`,maintainers:[`WhiteWorld`,`nczitzk`,`Fatpandac`],handler:f,description:`| 热门话题 | 科技动态 | 医疗产业 | 财经快讯           |
| -------- | -------- | -------- | ------------------ |
|          | news     | medical  | financial_express |`};async function f(e){let{category:d=``}=e.req.param(),f=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):30,p=new URL(d??``,o).href,{data:m}=await a(p),{data:h}=await a(s,{searchParams:{type:m.match(/\[\\"type\\",\\"(\d+)\\",\\"d\\"]/)?.[1]??`1`,page:1,size:f}}),g=h.data.items.slice(0,f).map(e=>({title:e.title,link:e.url??new URL(`topic/${e.uid}`,o).href,description:r(l.join(t,`templates/description-71daa88b.art`),{description:e.summary,news:e.newsAggList,timeline:e.timeline}),author:e.siteNameDisplay,category:[...e.entityList.map(e=>e.name)??[],...e.tagList.map(e=>e.name)??[]],guid:e.uid,pubDate:i(e.publishDate)}));g=await c(g,n.tryGet);let _=u(m),v=_(`meta[property="og:site_name"]`).prop(`content`),y=_(`a[data-path="/${d}"]`).text(),b=_(`link[rel="preload"][as="image"]`).prop(`href`),x=_(`meta[property="og:image"]`).prop(`content`);return{item:g,title:`${v} - ${y}`,link:p,description:_(`meta[property="og:description"]`).prop(`content`),language:`zh`,image:b,icon:x,logo:x,subtitle:y,author:v,allowEmpty:!0}}export{d as route};