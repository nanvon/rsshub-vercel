import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseRelativeDate as e}from"./parse-date-D4osZfpm.js";import"./proxy-C5Qog9Rm.js";import"./dist-0j_z2rfc.js";import{cache_default as t}from"./cache-GwMhal7i.js";import{ofetch_default as n}from"./ofetch-ZUQ1sEMc.js";import{ViewType as r}from"./types-A5bA50Mg.js";import{getPuppeteerPage as i}from"./puppeteer-U-cQNky4.js";import{load as a}from"cheerio";import o from"sanitize-html";const s=async e=>{let t,{destory:n}=await i(e,{onBeforeLoad:async e=>{await e.setRequestInterception(!0),e.on(`request`,e=>{e.resourceType()===`document`?e.continue():e.abort()}),e.on(`response`,async e=>{t=await(e.request().url().includes(`/api/posts`)?e.json():e.text())})}});return await n(),t},c={path:`/user/:id/:type?`,categories:[`social-media`],example:`/picnob/user/xlisa_olivex`,parameters:{id:`Instagram id`,type:`Type of profile page (profile or tagged)`},features:{requireConfig:!1,requirePuppeteer:!0,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.pixnoy.com/profile/:id`],target:`/user/:id`},{source:[`www.pixnoy.com/profile/:id/tagged`],target:`/user/:id/tagged`}],name:`User Profile - Picnob`,maintainers:[`TonyRL`,`micheal-death`,`AiraNadih`,`DIYgod`],handler:l,view:r.Pictures};async function l(r){let i=`https://www.pixnoy.com`,c=r.req.param(`id`),l=r.req.param(`type`)??`profile`,u=`${i}/profile/${c}/${l===`tagged`?`tagged/`:``}`,d,f=!1;try{let e=await n(u);d=e}catch{d=await s(u),f=!0}let p=a(d),m=p(`.post_box`).toArray().map(t=>{let n=p(t),r=n.find(`.sum`).text(),a=n.find(`.cover_link`).attr(`href`),s=a?.split(`/`)?.[2];return{title:o(r.split(`
`)[0],{allowedTags:[],allowedAttributes:{}}),description:`<img src="${n.find(`.preview_w img`).attr(`data-src`)}" /><br />${r.replaceAll(`
`,`<br>`)}`,link:`${i}${a}`,guid:s,pubDate:e(n.find(`.time .txt`).text())}}),h=await Promise.all(m.map(e=>t.tryGet(`picnob:user:${c}:${e.guid}`,async()=>{try{let t=f?await s(e.link):await n(e.link,{headers:{"user-agent":`PostmanRuntime/7.44.0`}}),r=a(t);if(r(`.video_img`).length>0)return`<video src="${r(`.video_img a`).attr(`href`)}" poster="${r(`.video_img img`).attr(`data-src`)}"></video><br />${r(`.sum_full`).text()}`;{let e=``;for(let t of r(`.swiper-slide`).toArray()){let n=r(t);e+=`<img src="${n.find(`.pic img`).attr(`data-src`)}" /><br />`}return e+=r(`.sum_full`).text(),e}}catch{return``}})));return{title:`${p(`h1.fullname`).text()} (@${c}) ${l===`tagged`?`tagged`:`public`} posts - Picnob`,description:p(`.info .sum`).text(),link:u,image:p(`.ava .pic img`).attr(`src`),item:m.map((e,t)=>({...e,description:h[t]||e.description}))}}export{c as route};