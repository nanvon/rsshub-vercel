import{n as e,t}from"./esm-shims-C3MSy80G.mjs";import"./config-PItPnVIx.mjs";import"./logger-BoKmWr7Z.mjs";import"./ofetch-Byd8Ct7M.mjs";import"./helpers-vRt84cId.mjs";import{t as n}from"./cache-KwJARS5Z.mjs";import{t as r}from"./render-ZYpwNl2L.mjs";import{t as i}from"./parse-date-9Tu6hSFW.mjs";import{t as a}from"./got-BYElsd7I.mjs";import o from"node:path";import{load as s}from"cheerio";e();const c={path:`/eshop/hk`,radar:[{source:[`nintendo.com.hk/software/switch`,`nintendo.com.hk/`]}],name:`Unknown`,maintainers:[],handler:l,url:`nintendo.com.hk/software/switch`};async function l(e){let c=(await a(`https://www.nintendo.com.hk/data/json/switch_software.json`)).data.filter(({link:e})=>e.startsWith(`https://`)).slice(0,e.req.query(`limit`)?Number(e.req.query(`limit`)):30);return{title:`Nintendo eShop（港服）新游戏`,link:`https://www.nintendo.com.hk/software/switch/`,description:`Nintendo eShop（港服）新上架的游戏`,item:await Promise.all(c.map(e=>n.tryGet(e.link,async()=>{let{data:n}=await a(e.link),c=s(n),l;if(e.link.startsWith(`https://store.nintendo.com.hk/`)){let e={platform:c(`.platform .product-attribute-val`).text(),game_category:c(`.game_category .product-attribute-val`).text(),release_date:c(`.release_date .product-attribute-val`).text(),publisher:c(`.publisher .product-attribute-val`).text(),no_of_players:c(`.no_of_players .product-attribute-val`).text(),supported_languages:c(`.supported_languages .product-attribute-val`).text(),required_space:c(`.required_space .product-attribute-val`).text(),supported_controllers:c(`.supported_controllers .product-attribute-val`).text(),supported_play_modes:c(`.supported_play_modes .product-attribute-val`).text(),disclaimer:c(`.disclaimer .product-attribute-val p`).text(),price:c(`meta[property="product:price:amount"]`).attr(`content`),currency:c(`meta[property="product:price:currency"]`).attr(`content`)},n=JSON.parse(c(`[type=text/x-magento-init]`).text().match(/{\n\s+"\[data-gal{2}ery-role=gal{2}ery-placeholder]": {\n\s+"mage(?:\/gal{2}ery){2}".*?}{4}(?:\s+}\n){3}/s));l=r(o.join(t,`templates/eshop_hk-5162b30c.art`),{attributes:e,description:c(`.description`).html(),gallery:n[`[data-gallery-role=gallery-placeholder]`][`mage/gallery/gallery`].data,host:`store.nintendo.com.hk`})}else if(e.link.startsWith(`https://ec.nintendo.com/`)){let e=JSON.parse(n.match(/NXSTORE\.titleDetail\.jsonData = ({.*?});/)[1]),{data:i}=await a(`https://ec.nintendo.com/api/HK/zh/guest_prices`,{searchParams:{ns_uids:e.id}});l=r(o.join(t,`templates/eshop_hk-5162b30c.art`),{host:`ec.nintendo.com`,jsonData:e,priceData:i[0]})}return{title:e.title,description:l,link:e.link,pubDate:i(e.release_date,`YYYY.M.D`)}})))}}export{c as route};