import{n as e,t}from"./esm-shims-BC3isTv8.js";import{t as n}from"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t as r}from"./ofetch-CfXAR0UO.js";import"./helpers-Cqaav28H.js";import{t as i}from"./cache-CpEhLexq.js";import{t as a}from"./render-d6AVTUl2.js";import{t as o}from"./parse-date-CHEO0z5G.js";import{t as s}from"./got-dCh-Ojgc.js";import c from"node:path";e();const l={path:`/:handle`,categories:[`picture`],example:`/artstation/wlop`,parameters:{handle:`Artist handle, can be found in URL`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.artstation.com/:handle`]}],name:`Artist Profolio`,maintainers:[`TonyRL`],handler:u};async function u(e){let l=e.req.param(`handle`),u={accept:`application/json, text/plain, */*`,"accept-language":`en-US,en;q=0.9`,"content-type":`application/json`,"user-agent":n.trueUA},d=await i.tryGet(`artstation:csrfToken`,async()=>(await r.raw(`https://www.artstation.com/api/v2/csrf_protection/token.json`,{method:`POST`,headers:u})).headers.getSetCookie()[0].split(`;`)[0].split(`=`)[1]),{data:f}=await s(`https://www.artstation.com/users/${l}/quick.json`,{headers:{...u,cookie:`PRIVATE-CSRF-TOKEN=${d}`}}),{data:p}=await s(`https://www.artstation.com/users/${l}/projects.json`,{headers:{...u,cookie:`PRIVATE-CSRF-TOKEN=${d}`},searchParams:{user_id:f.id,page:1}}),m=e=>e.replace(/\/\d{14}\/small_square\//,`/large/`),h=p.data.map(e=>({title:e.title,description:a(c.join(t,`templates/description-674eb99b.art`),{description:e.description,image:{src:m(e.cover.small_square_url),title:e.title}}),pubDate:o(e.published_at),updated:o(e.updated_at),link:e.permalink,author:f.full_name,assetsCount:e.assets_count,hashId:e.hash_id,icons:e.icons})),g=await Promise.all(h.map(e=>i.tryGet(e.link,async()=>{if(e.assetsCount>1||!e.icons.image){let{data:n}=await s(`https://www.artstation.com/projects/${e.hashId}.json`,{headers:{...u,cookie:`PRIVATE-CSRF-TOKEN=${d}`}});e.description=a(c.join(t,`templates/description-674eb99b.art`),{description:n.description,assets:n.assets});for(let e of n.assets)if(e.asset_type!==`video`&&e.asset_type!==`image`&&e.asset_type!==`video_clip`&&e.asset_type!==`cover`)throw Error(`Unhandle asset type: ${e.asset_type}`)}return e})));return{title:`${f.full_name} - ArtStation`,description:f.headline,link:f.permalink,logo:f.large_avatar_url,icon:f.large_avatar_url,image:f.default_cover_url,item:g}}export{l as route};