import{n as e,t}from"./esm-shims-mGm6WwCc.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t as n}from"./ofetch-BASlBuka.js";import{t as r}from"./cache-CpEhLexq.js";import{t as i}from"./render-d6AVTUl2.js";import{t as a}from"./parse-date-CHEO0z5G.js";import{t as o}from"./timezone-BPfwRbwD.js";import{t as s}from"./types-Bn7An2Wc.js";import c from"node:path";import{load as l}from"cheerio";e();const u=async e=>{let s=Number.parseInt(e.req.query(`limit`)??`10`,10),u=`https://musikguru.de`,d=new URL(`news/`,u).href,f=l(await n(d)),p=f(`html`).attr(`lang`)??`de`,m=[];return m=f(`section`).eq(1).find(`div.card`).slice(0,s).toArray().map(e=>{let n=f(e),r=n.find(`h5.card-title`).text(),a=n.find(`img`).attr(`src`),o=i(c.join(t,`templates/description-881baa33.art`),{images:a?[{src:a,alt:r}]:void 0,intro:n.find(`p.card-text`).text()}),s=n.find(`a`).first().attr(`href`);return{title:r,description:o,link:s?new URL(s,u).href:void 0,content:{html:o,text:o},image:a,banner:a,language:p}}),m=await Promise.all(m.map(e=>e.link?r.tryGet(e.link,async()=>{let r=l(await n(e.link)),s=r(`div.article h1`).text(),u=e.description+i(c.join(t,`templates/description-881baa33.art`),{description:(r(`p.lead`).html()??``)+(r(`div.lead`).html()??``)}),d=r(`div.article div.text-muted`).text().split(/\sUhr/)?.[0],f=r(`div.article img`).first().attr(`src`),m=d,h={title:s,description:u,pubDate:d?o(a(d,`DD.MM.YYYY HH:mm`),1):e.pubDate,content:{html:u,text:u},image:f,banner:f,updated:m?o(a(m,`DD.MM.YYYY HH:mm`),1):e.updated,language:p};return{...e,...h}}):e)),{title:f(`title`).text(),description:f(`meta[name="description"]`).attr(`content`),link:d,item:m,allowEmpty:!0,image:f(`a.navbar-brand img`).attr(`src`)?new URL(f(`a.navbar-brand img`).attr(`src`),u).href:void 0,author:f(`a.navbar-brand img`).attr(`alt`),language:p,id:d}},d={path:`/news`,name:`News`,url:`musikguru.de`,maintainers:[`nczitzk`],handler:u,example:`/musikguru/news`,parameters:void 0,description:void 0,categories:[`multimedia`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`musikguru.de/news`],target:`news`}],view:s.Articles};export{u as handler,d as route};