import{n as e,t}from"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CfXAR0UO.js";import"./helpers-Cqaav28H.js";import{t as n}from"./render-d6AVTUl2.js";import{t as r}from"./parse-date-CHEO0z5G.js";import{t as i}from"./got-dCh-Ojgc.js";import a from"node:path";import o from"crypto-js";e();const s={m3u8:`x-mpegURL`,mp3:`mpeg`,mp4:`mp4`,m4a:`mp4`},c={path:`/zhibo/:id`,categories:[`multimedia`],example:`/radio/zhibo/1395528`,parameters:{id:`直播 id，可在对应点播页面的 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!0,supportScihub:!1},name:`直播`,maintainers:[`nczitzk`],handler:l,description:"如果订阅 [新闻和报纸摘要](http://www.radio.cn/pc-portal/sanji/zhibo_2.html?name=1395528)，其 URL 为 `http://www.radio.cn/pc-portal/sanji/zhibo_2.html?name=1395528`，可以得到 `name` 为 `1395528`\n\n  所以对应路由为 [`/radio/zhibo/1395528`](https://rsshub.app/radio/zhibo/1395528)\n\n::: tip\n  查看更多电台直播节目，可前往 [电台直播](http://www.radio.cn/pc-portal/erji/radioStation.html)\n:::"};async function l(e){let c=e.req.param(`id`),l=`columnId=${c}&pageNo=0&pageSize=${e.req.query(`limit`)??`100`}`,u=`https://www.radio.cn`,d=`${u}/pc-portal/image/icon_32.jpg`,f=`${u}/pc-portal/sanji/zhibo_2.html?name=${c}`,p=`https://ytmsout.radio.cn/web/appProgram/pageByColumn?${l}`,m=Date.now(),h=(await i({method:`get`,url:p,headers:{sign:o.MD5(`${l}&timestamp=${m}&key=f0fc4c668392f9f9a447e48584c214ee`).toString().toUpperCase(),timestamp:m,"Content-Type":`application/json`,equipmentId:`0000`,platformCode:`WEB`}})).data.data.data,g=h.map(e=>{let i=e.playUrlHigh??e.playUrlLow;i=/\.m3u8$/.test(i)?e.downloadUrl:i;let o=new URL(i).pathname.split(`.`).pop(),c=o?`audio/${s[o]}`:``,l=new Date(e.startTime),u=`${l.getFullYear()}-${l.getMonth()+1}-${l.getDate()}`;return{guid:e.id,title:`${u} ${e.name}`,link:i,description:n(a.join(t,`templates/description-2b297c34.art`),{description:e.des,enclosure_url:i,enclosure_type:c}),pubDate:r(e.startTime),enclosure_url:i,enclosure_type:c,itunes_duration:e.durationStr,itunes_item_image:d}});return{title:`云听 - ${h[0].name}`,link:f,item:g,image:d,itunes_author:`radio.cn`,description:h[0].des}}export{c as route};