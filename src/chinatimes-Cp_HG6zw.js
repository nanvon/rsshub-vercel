import"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import{logger_default as e}from"./logger-BvonkID1.js";import"./proxy-DMKMSIEA.js";import{ofetch_default as t}from"./ofetch-DqHh1IN2.js";import{cache_default as n}from"./cache-Dfid4xgQ.js";import{parseDate as r}from"./parse-date-DHsdom8D.js";import{timezone as i}from"./timezone-CMz5pnRe.js";import{puppeteer_default as a}from"./puppeteer-BZKI4hv7.js";import{load as o}from"cheerio";const s={path:`/:category?`,categories:[`traditional-media`],example:`/chinatimes/realtimenews`,parameters:{category:"分類，見下表，留空為 `realtimenews`"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.chinatimes.com/:category/`,`www.chinatimes.com/`]}],name:`分類`,maintainers:[`KingJem`],handler:c,url:`www.chinatimes.com/`,description:`|     即時     |   熱門  |   政治  | 生活 | 娛樂 |  財經 |  國際 |   言論  |   兩岸  |   軍事   |   社會  |  健康  |  體育  |      科技      |   運勢  | 有影 |  寶島  |
| :----------: | :-----: | :-----: | :--: | :--: | :---: | :---: | :-----: | :-----: | :------: | :-----: | :----: | :----: | :------------: | :-----: | :--: | :----: |
| realtimenews | hotnews | politic | life | star | money | world | opinion | chinese | armament | society | health | sports | technologynews | fortune | tube | taiwan |`};async function c(s){let c=`https://www.chinatimes.com`,{category:l=`realtimenews`}=s.req.param(`category`),u=`${c}/${l}/?chdtv`,d=await t(u),f=o(d),p=await a(),m=f(`.articlebox-compact`).toArray().slice(0,s.req.query(`limit`)?Number.parseInt(s.req.query(`limit`),10):20).map(e=>{let t=f(e),n=t.find(`.title a`);return{title:n.text().trim(),link:`${c}${n.attr(`href`)}?chdtv`,guid:`${c}${n.attr(`href`)}`,pubDate:i(r(t.find(`time`).attr(`datetime`)),8),category:t.find(`.category a`).toArray().map(e=>f(e).text().trim())}}),h=await Promise.all(m.map(t=>n.tryGet(t.link,async()=>{let n=await p.newPage();await n.setRequestInterception(!0),n.on(`request`,e=>{e.resourceType()===`document`?e.continue():e.abort()}),e.http(`Requesting ${t.link}`),await n.goto(t.link,{waitUntil:`domcontentloaded`});let r=await n.content();await n.close();let i=o(r);return t.category=[...new Set([...t.category,...i(`.article-hash-tag a`).toArray().map(e=>i(e).text().trim())])],i(`.ad, #donate-form-container, .promote-word, .google-news-promote, .article-hash-tag`).remove(),t.description=i(`.main-figure`).html()+i(`.article-body`).html(),t})));return await p.close(),{title:f(`head title`).text(),description:f(`head meta[name="description"]`).attr(`content`),link:u,language:f(`html`).attr(`lang`),image:`${c}/images/2020/apple-touch-icon.png`,item:h}}export{s as route};