import{n as e,t}from"./esm-shims-BKVRry6h.mjs";import"./ofetch-BRplXtiZ.mjs";import"./config-D7dgKYF5.mjs";import"./logger-CkUWGGaS.mjs";import{t as n}from"./cache-Bv3_kFbE.mjs";import"./helpers-Tm7Pw8Vq.mjs";import{t as r}from"./parse-date-_GmTZfjS.mjs";import{t as i}from"./render-CSqLtqb8.mjs";import{t as a}from"./got-BglkE51W.mjs";import o from"node:path";import{load as s}from"cheerio";e();const c={path:`/:bookName/book-series/:bookId`,radar:[{source:[`routledge.com/:bookName/book-series/:bookId`]}],name:`Unknown`,maintainers:[`TonyRL`],handler:l};async function l(e){let{bookName:c,bookId:l}=e.req.param(),u=`https://www.routledge.com/${c}/book-series/${l}`,{data:d}=await a(u,{headers:{accept:`text/html, */*; q=0.01`},searchParams:{publishedFilter:`alltitles`,pd:`published,forthcoming`,pg:1,pp:12,so:`pub`,view:`list`}}),f=s(d),p=f(`.row.book`).toArray().map(e=>{e=f(e);let t=e.find(`h3 a`),n=e.find(`p.description`),i=e.find(`p.description`).prev().text().split(`
`);return{title:t.text(),link:t.attr(`href`),description:n.text(),pubDate:r(i.pop().trim(),`MMMM DD, YYYY`),author:i.map(e=>e.trim()).filter(Boolean).join(`, `)}}),m=await Promise.all(p.map(e=>n.tryGet(e.link,async()=>{let{data:n}=await a(e.link),r=s(n),{data:c}=await a(`https://productimages.routledge.com`,{searchParams:{isbn:r(`meta[property="books:isbn"]`).attr(`content`),size:`amazon`,ext:`jpg`}}),l=r(`.sticky-div`);return l.find(`button.accordion-button`).contents().unwrap(),l.find(`.fa-shopping-cart`).parent().parent().remove(),e.description=i(o.join(t,`templates/description-c2244266.art`),{image:c,description:l.html()}),e})));return{title:f(`head title`).text(),description:f(`head meta[name="description"]`).attr(`content`),link:u,item:m}}export{c as route};