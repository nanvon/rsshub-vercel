import{n as e,t}from"./esm-shims-L08rKynx.mjs";import"./config-L8Ls2W7q.mjs";import"./logger-C50fTRi5.mjs";import"./ofetch-DXVwJZV0.mjs";import"./helpers-mo8InLYm.mjs";import{t as n}from"./cache-ZTWfXd2T.mjs";import{t as r}from"./render-CBhnapAf.mjs";import{t as i}from"./parse-date-bKmkZ9gg.mjs";import{t as a}from"./got-D6JCV29k.mjs";import{t as o}from"./timezone-CE0MDOJ-.mjs";import s from"node:path";import{load as c}from"cheerio";e();const l=async e=>{let{id:l=`xijiayi`}=e.req.param(),u=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):50,d=`https://www.ithome.com`,f=new URL(`zt/${l}`,d).href,{data:p}=await a(f),m=c(p),h=`IT之家`,g=m(`div.newsbody`).slice(0,u).toArray().map(e=>{e=m(e);let t=e.find(`h2`).text(),n=e.find(`img`).prop(`data-original`)??e.find(`img`).prop(`src`);return{title:t,pubDate:o(i(e.find(`span.time script`).text().match(/'(.*?)'/)),8),link:e.find(`a`).first().prop(`href`),author:e.find(`div.editor`).contents().first().text(),image:n,banner:n,language:`zh`}});g=await Promise.all(g.map(e=>n.tryGet(e.link,async()=>{let{data:n}=await a(e.link),l=c(n);l(`p.ad-tips, a.topic-bar`).remove(),l(`div#paragraph p img`).each((e,n)=>{n=l(n);let i=n.prop(`data-original`);i&&n.replaceWith(r(s.join(t,`templates/description-463c9506.art`),{images:[{src:i,alt:n.prop(`alt`)}]}))});let u=l(`h1`).text(),d=l(`div#paragraph`).html(),f=l(`div#paragraph img`).first().prop(`src`);return e.title=u,e.description=d,e.pubDate=o(i(l(`span#pubtime_baidu`).text()),8),e.category=l(`div.cv a`).toArray().map(e=>l(e).text()).slice(1),e.author=l(`span#author_baidu`).contents().last().text()||l(`span#source_baidu`).contents().last().text()||l(`span#editor_baidu`).contents().last().text(),e.content={html:d,text:l(`div#paragraph`).text()},e.image=f,e.banner=f,e.language=`zh`,e})));let _=new URL(m(`meta[property="og:image"]`).prop(`content`),d).href;return{title:`${h} - ${m(`title`).text()}`,description:m(`meta[name="description"]`).prop(`content`),link:f,item:g,allowEmpty:!0,image:_,author:h,language:`zh`}},u={path:`/zt/:id?`,name:`专题`,url:`ithome.com`,maintainers:[`nczitzk`],handler:l,example:`/ithome/zt/xijiayi`,parameters:{category:`专题 id，默认为 xijiayi，即 [喜加一](https://www.ithome.com/zt/xijiayi)，可在对应专题页 URL 中找到`},description:`::: tip
  更多专题请见 [IT之家专题](https://www.ithome.com/zt)
:::`,categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`ithome.com/zt/:id`],target:`/zt/:id`}]};export{l as handler,u as route};