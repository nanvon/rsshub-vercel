import"./ofetch-BRplXtiZ.mjs";import"./config-D7dgKYF5.mjs";import"./logger-CkUWGGaS.mjs";import{t as e}from"./cache-Bv3_kFbE.mjs";import"./helpers-Tm7Pw8Vq.mjs";import{t}from"./parse-date-_GmTZfjS.mjs";import{t as n}from"./got-BglkE51W.mjs";import{load as r}from"cheerio";const i=new Map([[`notice`,`tzgg`],[`news`,`xw`]]),a={path:[`/jwb/:type?`],radar:[{source:[`www.shu.edu.cn/index`],target:`/:type?`}],name:`教务部`,maintainers:[`tuxinghuan`,`GhhG123`],handler:o,description:`| 通知通告 | 新闻 | 政策文件(bug) |
| -------- | ---- | -------- |
| notice   | news | policy   |`};async function o(a){let o=a.req.param(`type`)||`notice`,s=`https://jwb.shu.edu.cn/index/${i.get(o)||o}.htm`,c=r((await n.get(s)).data),l=c(`title`).text(),u=c(`.only-list`).find(`li`).slice(0,10).toArray().map(e=>({title:c(e).find(`a`).text(),link:new URL(c(e).find(`a`).attr(`href`),`https://jwb.shu.edu.cn/`).href,date:c(e).children(`span`).text()}));return{title:l,link:s,image:`https://www.shu.edu.cn/__local/0/08/C6/1EABE492B0CF228A5564D6E6ABE_779D1EE3_5BF7.png`,item:await Promise.all(u.map(i=>e.tryGet(i.link,async()=>{let e=r((await n.get(i.link)).data);return i.author=e(`[id$=_lblUser]`).text().trim(),i.pubDate=t(i.date,`YYYY年MM月DD日`),i.description=e(`.v_news_content`).html()||i.title,i})))}}export{a as route};