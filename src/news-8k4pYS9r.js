import{__dirname as e,init_esm_shims as t}from"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as n}from"./ofetch-rK3Yp7nj.js";import{cache_default as r}from"./cache-Dfid4xgQ.js";import{art as i}from"./render-DftO2d-b.js";import{parseDate as a}from"./parse-date-DHsdom8D.js";import{timezone as o}from"./timezone-CMz5pnRe.js";import{ViewType as s}from"./types-Bi82qguM.js";import c from"node:path";import{load as l}from"cheerio";t();const u=async t=>{let s=Number.parseInt(t.req.query(`limit`)??`10`,10),u=`https://musikguru.de`,d=new URL(`news/`,u).href,f=l(await n(d)),p=f(`html`).attr(`lang`)??`de`,m=[];return m=f(`section`).eq(1).find(`div.card`).slice(0,s).toArray().map(t=>{let n=f(t),r=n.find(`h5.card-title`).text(),a=n.find(`img`).attr(`src`),o=i(c.join(e,`templates/description-881baa33.art`),{images:a?[{src:a,alt:r}]:void 0,intro:n.find(`p.card-text`).text()}),s=n.find(`a`).first().attr(`href`);return{title:r,description:o,link:s?new URL(s,u).href:void 0,content:{html:o,text:o},image:a,banner:a,language:p}}),m=await Promise.all(m.map(t=>t.link?r.tryGet(t.link,async()=>{let r=l(await n(t.link)),s=r(`div.article h1`).text(),u=t.description+i(c.join(e,`templates/description-881baa33.art`),{description:(r(`p.lead`).html()??``)+(r(`div.lead`).html()??``)}),d=r(`div.article div.text-muted`).text().split(/\sUhr/)?.[0],f=r(`div.article img`).first().attr(`src`),m=d,h={title:s,description:u,pubDate:d?o(a(d,`DD.MM.YYYY HH:mm`),1):t.pubDate,content:{html:u,text:u},image:f,banner:f,updated:m?o(a(m,`DD.MM.YYYY HH:mm`),1):t.updated,language:p};return{...t,...h}}):t)),{title:f(`title`).text(),description:f(`meta[name="description"]`).attr(`content`),link:d,item:m,allowEmpty:!0,image:f(`a.navbar-brand img`).attr(`src`)?new URL(f(`a.navbar-brand img`).attr(`src`),u).href:void 0,author:f(`a.navbar-brand img`).attr(`alt`),language:p,id:d}},d={path:`/news`,name:`News`,url:`musikguru.de`,maintainers:[`nczitzk`],handler:u,example:`/musikguru/news`,parameters:void 0,description:void 0,categories:[`multimedia`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`musikguru.de/news`],target:`news`}],view:s.Articles};export{u as handler,d as route};