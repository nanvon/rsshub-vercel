import{n as e,t}from"./esm-shims-BKVRry6h.mjs";import"./ofetch-BRplXtiZ.mjs";import"./config-D7dgKYF5.mjs";import"./logger-CkUWGGaS.mjs";import{t as n}from"./cache-Bv3_kFbE.mjs";import"./helpers-Tm7Pw8Vq.mjs";import{t as r}from"./parse-date-_GmTZfjS.mjs";import{t as i}from"./render-CSqLtqb8.mjs";import{t as a}from"./got-BglkE51W.mjs";import{t as o}from"./timezone-BAp4uBjD.mjs";import s from"node:path";import{load as c}from"cheerio";e();const l=e=>e.map(e=>{let t=e.type;return t===`video`?u(e.data):t===`text`?e.data.replaceAll(/data-lazyload=(.+?) src=(.+?) style=".+?"/g,`src=$1`):``}).join(`<br>`),u=e=>i(s.join(t,`templates/video-e05cff83.art`),{videoInfo:e}),d={path:`/feng/:id/:type`,categories:[`new-media`],example:`/ifeng/feng/2583/doc`,parameters:{id:`对应 id，可在 大风号作者页面 找到`,type:`类型，见下表`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`大风号`,maintainers:[`Jamch`],handler:f,description:`| 文章 | 视频  |
| ---- | ----- |
| doc  | video |`};async function f(e){let{id:t,type:i}=e.req.param(),{data:s}=await a(`https://ishare.ifeng.com/mediaShare/home/${t}/media`,{headers:{Referer:`https://feng.ifeng.com/author/${t}`}}),{data:d}=await a(`https://shankapi.ifeng.com/season/ishare/getShareListData/${t}/${i}/1/ifengnewsh5/getListData`,{headers:{Referer:`https://feng.ifeng.com/author/${t}`}}),f=c(s),{sockpuppetInfo:p}=JSON.parse(f(`script`).text().match(/var allData = (.*?);/)[1]),{data:m}=JSON.parse(d.match(/getListData\((.*)\)/)[1]),{weMediaName:h,honorDesc:g,description:_,logo:v}=p,y=m.map(e=>({title:e.title,pubDate:o(r(e.newsTime),8),author:h,link:`https:${e.url}`})),b=await Promise.all(y.map(e=>n.tryGet(e.link,async()=>{let{data:t}=await a(e.link),n=c(t),r=JSON.parse(n(`script`).text().match(/var allData = ({.*?});/)[1]);return i===`doc`&&(e.description=l(r.docData.contentData.contentList)),i===`video`&&(e.description=u(r.videoInfo)),e.category=r.keywords.split(`,`),e.author=r.docData?.editorName??e.author,e})));return{title:`大风号-${h}-${i===`doc`?`文章`:`视频`}`,description:`${g} ${_}`,image:`https:${v}`,link:`https://ishare.ifeng.com/mediaShare/home/${t}/media`,item:b}}export{d as route};