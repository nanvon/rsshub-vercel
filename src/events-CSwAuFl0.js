import"./esm-shims-CGUM9TC6.js";import{config as e}from"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as t}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as n}from"./cache-GwMhal7i.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as r}from"./got-CB83B8oA.js";import i from"markdown-it";const a=i({html:!0}),o={path:`/events/:owner/:repo`,categories:[`programming`],example:`/gitee/events/y_project/RuoYi`,parameters:{owner:`用户名`,repo:`仓库名`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`gitee.com/:owner/:repo`]}],name:`仓库动态`,maintainers:[`TonyRL`],handler:s};async function s(i){let{owner:o,repo:s}=i.req.param(),c=`https://gitee.com/api/v5/repos/${o}/${s}/events`,l=await n.tryGet(c,async()=>(await r(c,{searchParams:{access_token:e.gitee.access_token??void 0,limit:i.req.query(`limit`)?Number(i.req.query(`limit`)):100}})).data),u=l.map(e=>({title:e.type,author:e.actor.login,pubDate:t(e.created_at),guid:e.id,type:e.type,payload:e.payload}));return u=u.map(e=>{switch(e.type){case`IssueEvent`:e.title=e.payload.title,e.description=a.render(e.payload.body),e.link=e.payload.html_url;break;case`ForkEvent`:e.title=`${e.author||e.actor.login} forked ${o}/${s}`,e.link=e.payload.html_url;break;case`StarEvent`:e.title=`${e.author||e.actor.login} ${e.payload.action} ${o}/${s}`;break;case`IssueCommentEvent`:e.title=e.payload.issue.title,e.description=a.render(e.payload.comment.body),e.link=e.payload.comment.html_url;break;default:break}return delete e.type,delete e.payload,e}),{title:`${o}/${s} - 仓库动态`,link:`https://gitee.com/${o}/${s}`,item:u}}export{o as route};