import{__dirname as e,init_esm_shims as t}from"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-rK3Yp7nj.js";import"./helpers-gUVC02jt.js";import{cache_default as n}from"./cache-Dfid4xgQ.js";import{art as r}from"./render-DftO2d-b.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import{got_default as a}from"./got-Bnno2HfO.js";import o from"node:path";import{load as s}from"cheerio";t();const c={path:[`/sh/wgj/:page?`,`/shanghai/wgj/:page?`],categories:[`government`],example:`/gov/sh/wgj`,parameters:{page:`页数，默认第 1 页`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`wsbs.wgj.sh.gov.cn/`],target:`/sh/wgj`}],name:`上海市文旅局审批公告`,maintainers:[`gideonsenku`],handler:l,url:`wsbs.wgj.sh.gov.cn/`};async function l(t){let c=`http://wsbs.wgj.sh.gov.cn`,l=`${c}/shwgj_ywtb/core/web/welcome/index!toResultNotice.action`,u=t.req.param(`page`)??1,d=s((await a({method:`post`,url:l,searchParams:{flag:1,"pageDoc.pageNo":u}})).data),f=d(`#div_md > table > tbody > tr > td:nth-child(1) > a`).toArray().map(e=>(e=d(e),{title:e.prop(`innerText`).replaceAll(/\s/g,``),link:e.attr(`href`)})),p=await Promise.all(f.map(t=>n.tryGet(t.link,async()=>{let n=s((await a({method:`get`,url:c+t.link})).data),l=n(`div[align="right"][style*="padding: 10px"]`).last().text().trim(),u=n(`td:contains("举办单位：")`).next().text().trim(),d=n(`td:contains("许可证号：")`).next().text().trim(),f=n(`td:contains("演出名称:")`).next().text().trim(),p=n(`td:contains("演出日期：")`).next().text().trim(),m=n(`td:contains("演出场所：")`).next().text().trim(),h=n(`td:contains("主要演员：")`).next().text().trim(),g=n(`td:contains("演员人数：")`).next().text().trim(),_=n(`td:contains("场次：")`).next().text().trim();return t.description=r(o.join(e,`templates/wgj-5a172aec.art`),{hostingUnit:u,licenseNumber:d,performanceName:f,performanceDate:p,performanceVenue:m,mainActors:h,actorCount:g,showCount:_}),t.pubDate=i(l),t})));return{title:d(`title`).text(),link:l,item:p}}export{c as route};