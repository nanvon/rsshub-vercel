import{n as e,t}from"./esm-shims-mGm6WwCc.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-BASlBuka.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-CgQXMNWI.js";import o from"node:path";import{load as s}from"cheerio";e();const c={zhengce:`政策`,fenxishishuo:`行情`,defi:`DeFi`,kuang:`矿业`,"以太坊2.0":`以太坊 2.0`,industry:`产业`,IPFS:`IPFS`,tech:`技术`,baike:`百科`,capitalmarket:`研报`},l={path:`/:category?`,categories:[`finance`],example:`/jinse/zhengce`,parameters:{category:`分类，见下表，默认为政策`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`分类`,maintainers:[`nczitzk`],handler:u,description:`| 政策    | 行情         | DeFi | 矿业  | 以太坊 2.0 |
| ------- | ------------ | ---- | ----- | ---------- |
| zhengce | fenxishishuo | defi | kuang | 以太坊 2.0 |

| 产业     | IPFS | 技术 | 百科  | 研报          |
| -------- | ---- | ---- | ----- | ------------- |
| industry | IPFS | tech | baike | capitalmarket |`};async function u(e){let{category:l=`zhengce`}=e.req.param(),u=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):50,d=`https://www.jinse.cn`,f=new URL(`v6/www/information/list`,`https://api.jinse.cn`).href,p=d,{data:m}=await a(f,{searchParams:{catelogue_key:l,limit:u,flag:`up`}}),h=m.list.slice(0,u).map(e=>({title:e.title,link:e.extra.topic_url,description:r(o.join(t,`templates/description-d03b585b.art`),{images:e.extra.thumbnails_pics.length>0?e.extra.thumbnails_pics.map(e=>({src:e.replace(/_[^\W_]+(\.\w+)$/,`_true$1`)})):void 0,intro:e.extra.summary}),author:e.extra.nickname,guid:`jinse${/\/lives\//.test(e.extra.topic_url)?`-lives`:``}-${e.extra.topic_id}`,pubDate:i(e.extra.published_at,`X`),upvotes:e.extra.up_counts??0,downvotes:e.extra.down_counts??0,comments:e.extra.comment_count??0}));h=await Promise.all(h.map(e=>n.tryGet(e.link,async()=>{if(/\/lives\//.test(e.link))return e;let{data:n}=await a(e.link),i=s(n);return e.description+=r(o.join(t,`templates/description-d03b585b.art`),{description:i(`section.js-article-content`).html()||i(`div.js-article`).html()}),e.category=i(`section.js-article-tag_state_1 a span`).toArray().map(e=>i(e).text()),e})));let{data:g}=await a(p),_=s(g),v=_(`meta[name="author"]`).prop(`content`),y=_(`a.js-logoBox img`).prop(`src`),b=new URL(_(`link[rel="favicon"]`).prop(`href`),d).href;return{item:h,title:`${v} - ${Object.hasOwn(c,l)?c[l]:l}`,link:p,description:_(`meta[name="description"]`).prop(`content`),language:_(`html`).prop(`lang`),image:y,icon:b,logo:b,subtitle:_(`meta[name="keywords"]`).prop(`content`),author:v,allowEmpty:!0}}export{l as route};