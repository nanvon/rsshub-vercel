import"./esm-shims-mGm6WwCc.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-BASlBuka.js";import"./helpers-Cqaav28H.js";import{t as e}from"./cache-CpEhLexq.js";import{t}from"./parse-date-CHEO0z5G.js";import{t as n}from"./got-CgQXMNWI.js";import{t as r}from"./invalid-parameter-CLGd_tte.js";import{t as i}from"./valid-host-COjFWLEv.js";import{load as a}from"cheerio";const o={path:`/:domain/tag/:tag`,name:`Unknown`,maintainers:[],handler:s};async function s(o){let{domain:s=`news`,tag:c}=o.req.param();if(!i(s))throw new r(`Invalid domain`);let l=`https://${s}.gamme.com.tw`,u=`${l}/tag/${c}`,{data:d}=await n(u),f=a(d),p=f(`#category_new li a, .List-4 h3 a`).toArray().map(e=>(e=f(e),{title:e.attr(`title`)||e.text(),link:e.attr(`href`)})),m=await Promise.all(p.map(r=>e.tryGet(r.link,async()=>{let{data:e}=await n(r.link),i=a(e);return i(`.entry img`).each((e,t)=>{(t.attribs[`data-original`]||t.attribs[`data-src`])&&(t.attribs.src=t.attribs[`data-original`]||t.attribs[`data-src`],delete t.attribs[`data-original`],delete t.attribs[`data-src`])}),r.author=i(`.author_name`).text().trim(),r.category=i(`.tags a`).toArray().map(e=>i(e).text()),i(`.social_block, .tags`).remove(),r.pubDate=t(i(`.postDate`).attr(`content`)),r.description=i(`.entry`).html(),r})));return{title:`${c} | ${s===`news`?`宅宅新聞`:`西斯新聞`}`,description:f(`meta[name=description]`).attr(`content`),link:u,image:s===`news`?`${l}/blogico.ico`:`${l}/favicon.ico`,item:m}}export{o as route};