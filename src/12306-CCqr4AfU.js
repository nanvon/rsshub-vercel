import{n as e,t}from"./esm-shims-CaZMYoY8.js";import{t as n}from"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-VsB2Peor.js";import"./helpers-Cqaav28H.js";import{t as r}from"./cache-CpEhLexq.js";import{t as i}from"./render-d6AVTUl2.js";import{t as a}from"./got-BVCqvF6m.js";import{t as o}from"./invalid-parameter-CLGd_tte.js";import s from"node:path";e();const c=`https://kyfw.12306.cn`;async function l(e){return(await a({method:`get`,url:e,headers:{UserAgent:n.ua,Referer:`https://www.12306.cn/index/index.html`}})).headers[`set-cookie`].join(`,`).match(/JSESSIONID=([^;]+);/)[0]}function u(e){return r.tryGet(e,async()=>(await a({method:`get`,url:`${c}/otn/resources/js/framework/station_name.js`,headers:{UserAgent:n.ua,Referer:`https://kyfw.12306.cn/otn/leftTicket/init`}})).data.split(`@`).map(t=>{let n=t.split(`|`);return n.includes(e)?{code:n[2],name:n[1]}:null}).find(Boolean))}const d={path:`/:date/:from/:to/:type?`,categories:[`travel`],example:`/12306/2022-02-19/重庆/永川东`,parameters:{date:`时间，格式为（YYYY-MM-DD）`,from:`始发站`,to:`终点站`,type:`售票类型，成人和学生可选，默认为成人`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`售票信息`,maintainers:[`Fatpandac`],handler:f};async function f(e){let r=e.req.param(`date`),d=await u(e.req.param(`from`)),f=await u(e.req.param(`to`)),p=e.req.param(`type`)??`ADULT`,m=`${c}/otn/leftTicket/queryA?leftTicketDTO.train_date=${r}&leftTicketDTO.from_station=${d.code}&leftTicketDTO.to_station=${f.code}&purpose_codes=${p}`,h=`${c}/otn/leftTicket/init?linktypeid=dc&fs=${d.code}&ts=${f.code}&date=${r}&flag=N,N,Y`,g=await a.get(m,{headers:{UserAgent:n.ua,Referer:`https://kyfw.12306.cn/otn/leftTicket/init`,Cookie:await l(h)}});if(g.data.data===void 0||g.data.data.length===0)throw new o(`没有找到相关车次，请检查参数是否正确`);let _=g.data.data.result,v=g.data.data.map,y=_.map(e=>{let n=e.split(`|`),r={trainNo:n[3],fromStation:v[n[6]],toStation:v[n[7]],startTime:n[8],arriveTime:n[9],duration:n[10],today:n[11],A9:n[32],M:n[31],O:n[30],A6:n[29],A4:n[28],F:n[27],A3:n[26],A2:n[25],A1:n[24],WZ:n[23],QT:n[22]};return{title:`${r.fromStation} → ${r.toStation} ${r.startTime} ${r.arriveTime}`,description:i(s.join(t,`templates/train-11793805.art`),{trainInfo:r}),link:h,guid:Object.values(r).join(`|`)}});return{title:`${d.name} → ${f.name} ${r}`,link:h,item:y}}export{d as route};