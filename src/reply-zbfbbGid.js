import"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t as e}from"./ofetch-CfXAR0UO.js";import{t}from"./parse-date-CHEO0z5G.js";import{t as n}from"./timezone-BPfwRbwD.js";import{load as r}from"cheerio";const i={path:`/topic/:id`,categories:[`anime`],example:`/bangumi.tv/topic/367032`,parameters:{id:`话题 id, 在话题页面地址栏查看`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`bgm.tv/group/topic/:id`]}],name:`小组话题的新回复`,maintainers:[`ylc395`],handler:a};async function a(i){let a=`https://bgm.tv/group/topic/${i.req.param(`id`)}`,o=r(await e(a)),s=o(`#pageHeader h1`).text(),c=o(`.row_reply`).toArray().map(e=>{let t=o(e);return{id:t.attr(`id`),author:t.find(`.userInfo .l`).text(),content:t.find(`.reply_content .message`).html(),date:t.children().first().find(`small`).children().remove().end().text().slice(3)}}),l=o(`.sub_reply_bg`).toArray().map(e=>{let t=o(e);return{id:t.attr(`id`),author:t.find(`.userName .l`).text(),content:t.find(`.cmt_sub_content`).html(),date:t.children().first().find(`small`).children().remove().end().text().slice(3)}}),u=[...c,...l].toSorted((e,t)=>e.id<t.id?1:-1),d={title:s,description:o(`.postTopic .topic_content`).html(),author:o(`.postTopic .inner strong a`).first().text(),pubDate:n(t(o(`.postTopic .re_info small`).text().trim().slice(5)),8),link:a};return{title:`${s}的最新回复`,link:a,item:[...u.map(e=>({title:`${e.author} 回复了小组话题《${s}》`,description:e.content,pubDate:n(t(e.date),8),author:e.author,link:`${a}#${e.id}`})),d]}}export{i as route};