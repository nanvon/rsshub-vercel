import{__dirname as e,init_esm_shims as t}from"./esm-shims-B6VgfGYP.js";import{ofetch_default as n}from"./ofetch-CHIwZNTj.js";import{cache_default as r}from"./cache-Dfid4xgQ.js";import{art as i}from"./render-CSnicFA3.js";import a from"node:path";import{load as o}from"cheerio";t();const s=async e=>(await n(`https://api.aeonmedia.co/graphql`,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({query:`query getImageById($id: ID!) { image(id: $id) { id url alt caption width height } }`,variables:{id:e,site:`Aeon`},operationName:`getImageById`})})).data.image.url;function c(t){let n=t.type.toLowerCase(),r=``,s=``,c=``;switch(n){case`film`:r=i(a.join(e,`templates/video-eb6996af.art`),{article:t});break;case`guide`:{s=t.imageSquare?.url,c=t.authors.map(e=>e.bio).join(` `);let n=[`Need To Know`,`What To Do`,`Key Points`,`Learn More`,`Links & Books`],l=Object.keys(t).filter(e=>e.startsWith(`section`)&&e!==`section`).map(e=>{let r=o(t[e]);return r(`p.pullquote`).remove(),`<h2>${n.shift()}</h2>`+r.html()}).join(``);r=i(a.join(e,`templates/essay-18b14798.art`),{banner:s,authorsBio:c,content:l});break}case`idea`:{s=t.imageLandscape?.url,c=t.authors.map(e=>e.bio).join(` `);let n=o(t.body);n(`p.pullquote`).remove(),r=i(a.join(e,`templates/essay-18b14798.art`),{banner:s,authorsBio:c,content:n.html()});break}default:break}return r}const l=async e=>await Promise.all(e.map(e=>r.tryGet(e.link,async()=>{let t=(await n(e.json)).pageProps.article;e.pubDate=new Date(t.publishedAt).toUTCString();let r=c(t),i=o(r);await Promise.all(i(`dl > dt`).toArray().map(async e=>{let t=i(e).text(),n=await s(t);i(e).replaceWith(`<img src="${n}" alt="${t}">`)}));let a=``;return a=t.type===`film`?t.creditsShort:t.authors.map(e=>e.name).join(`, `),e.description=i.html(),e.author=a,e})));export{l as getData};