import{n as e,t}from"./esm-shims-BC3isTv8.js";import{t as n}from"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t as r}from"./ofetch-CfXAR0UO.js";import{t as i}from"./render-d6AVTUl2.js";import{t as a}from"./parse-date-CHEO0z5G.js";import o from"node:path";import s from"markdown-it";e();const c=r.create({headers:{"user-agent":n.trueUA}}),l=s({html:!0}),u={path:`/project/:id/versions/:routeParams?`,categories:[`game`],example:`/modrinth/project/sodium/versions`,parameters:{id:`Id or slug of the Modrinth project`,routeParams:`Extra route params. See the table below for options`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`modrinth.com/mod/:id/*`,`modrinth.com/plugin/:id/*`,`modrinth.com/datapack/:id/*`,`modrinth.com/shader/:id/*`,`modrinth.com/resourcepack/:id/*`,`modrinth.com/modpack/:id/*`,`modrinth.com/mod/:id`,`modrinth.com/plugin/:id`,`modrinth.com/datapack/:id`,`modrinth.com/shader/:id`,`modrinth.com/resourcepack/:id`,`modrinth.com/modpack/:id`],target:`/project/:id/versions`}],name:`Project versions`,maintainers:[`SettingDust`],handler:d,description:`| Name           | Example                                      |
| -------------- | -------------------------------------------- |
| loaders        | loaders=fabric&loaders=quilt&loaders=forge |
| game_versions | game_versions=1.20.1&game_versions=1.20.2 |
| featured       | featured=true                                |`};async function d(e){let{id:n,routeParams:r}=e.req.param(),s=new URLSearchParams(r);try{let e=await c(`https://api.modrinth.com/v2/project/${n}`),r=await c(`https://api.modrinth.com/v2/project/${n}/version`,{query:{loaders:s.has(`loaders`)?JSON.stringify(s.getAll(`loaders`)):``,game_versions:s.has(`game_versions`)?JSON.stringify(s.getAll(`game_versions`)):``}}),u=await c(`https://api.modrinth.com/v2/users`,{query:{ids:JSON.stringify([...new Set(r.map(e=>e.author_id))])}}),d={};for(let e of u)d[e.id]=e;return{title:`${e.title} Modrinth versions`,description:e.description,link:`https://modrinth.com/project/${n}`,item:r.map(e=>({title:`${e.name} for ${e.loaders.join(`/`)} on ${[...new Set([e.game_versions[0],e.game_versions.at(-1)])].join(`-`)}`,link:`https://modrinth.com/project/${n}/version/${e.version_number}`,pubDate:a(e.date_published),description:i(o.join(t,`templates/version-e32ed699.art`),{...e,changelog:l.render(e.changelog)}),guid:e.id,author:d[e.author_id].username}))}}catch(e){throw e?.response?.statusCode===404?Error(`${e.message}: Project ${n} not found`):e}}export{u as route};