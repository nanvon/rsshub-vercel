import{__dirname as e,init_esm_shims as t}from"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-rK3Yp7nj.js";import"./helpers-gUVC02jt.js";import{art as n}from"./render-DftO2d-b.js";import{parseDate as r}from"./parse-date-DHsdom8D.js";import{got_default as i}from"./got-Bnno2HfO.js";import a from"node:path";t();const o={path:`/post/:id`,categories:[`bbs`],example:`/douyu/post/631737151576473201`,parameters:{id:`帖子 id，可在帖子页 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`yuba.douyu.com/p/:id`,`yuba.douyu.com/`]}],name:`鱼吧跟帖`,maintainers:[`nczitzk`],handler:s};async function s(t){let o=t.req.param(`id`),s=`https://yuba.douyu.com`,c=`${s}/p/${o}`,l=(await i({method:`get`,url:`${s}/wbapi/web/post/detail/${o}`})).data.data,u=`${s}/wbapi/web/post/comments/${o}?group_id=${l.group_id}&sink=1&page=1`,d=await i({method:`get`,url:u});u=`${s}/wbapi/web/post/comments/${o}?group_id=${l.group_id}&sink=1&page=${d.data.page_total}`,d=await i({method:`get`,url:u});let f=d.data.data.map(t=>({title:`${t.nick_name}: ${t.content}`,link:`${c}#${t.comment_id}${t.sub_replies.length>0?`+${t.sub_replies.map(e=>e.comment_id).join(`+`)}`:``}`,pubDate:r(t.created_ts*1e3),description:n(a.join(e,`templates/description-45e4c66d.art`),{content:t.content,images:t.imglist.map(e=>({size:e.size,url:e.url})),replies:t.sub_replies.map(e=>({nickname:e.nickname,content:e.content,time:new Date(e.created_ts*1e3).toLocaleString()}))??void 0})}));return{title:`斗鱼鱼吧 - ${l.title}`,link:c,item:f,description:l.content}}export{o as route};