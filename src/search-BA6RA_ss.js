import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-BpwDbAkH.js";import"./logger-B3QfaIfn.js";import{ofetch_default as n}from"./ofetch-TsvCL7Kz.js";import{art as r}from"./render-DE4LRFBD.js";import{ViewType as i}from"./types-Bi82qguM.js";import a from"node:path";import{load as o}from"cheerio";t();const s=async t=>{let{filter:i=`order=sell_desc`}=t.req.param(),s=Number.parseInt(t.req.query(`limit`)??`24`,10),c=`https://www.bookwalker.com.tw`,l=new URL(`search?${i}`,c).href,u=await n(l),d=o(u),f=d(`html`).attr(`lang`)??`zh-TW`,p=d(`div.bwbook_package`).slice(0,s).toArray().map(t=>{let n=d(t),i=n.find(`h4.bookname`).text(),o=n.find(`h5.bprice`).text(),s=n.find(`h5.booknamesub`).text().trim(),l=`${i} - ${s} ${o}`,u=n.find(`img`).attr(`data-src`)?.replace(/_\d+(\.\w+)$/,`$1`),p=r(a.join(e,`templates/description-463c9506.art`),{images:u?[{src:u,alt:i}]:void 0}),m=n.find(`div.bwbookitem a`).attr(`href`),h=s.split(/,/).map(e=>({name:e})),g={title:l,description:p,link:m?new URL(m,c).href:void 0,author:h,content:{html:p,text:p},image:u,banner:u,language:f};return g});return{title:d(`title`).text(),description:d(`meta[property="og:description"]`).attr(`content`),link:l,item:p,allowEmpty:!0,image:d(`meta[property="og:image"]`).attr(`content`),author:d(`meta[property="og:site_name"]`).attr(`content`),language:f,id:d(`meta[property="og:url"]`).attr(`content`)}},c={path:`/search/:filter?`,name:`搜尋`,url:`www.bookwalker.com.tw`,maintainers:[`nczitzk`],handler:s,example:`/bookwalker/search/order=sell_desc&s=34`,parameters:{filter:{description:"过滤器，默认为 `order=sell_desc`，即依發售日新至舊排序"}},description:":::tip\n订阅 [依發售日新至舊排序的文學小說](https://www.bookwalker.com.tw/search?order=sell_desc&s=34)，其源网址为 `https://www.bookwalker.com.tw/search?order=sell_desc&s=34`，请参考该 URL 指定部分构成参数，此时路由为 [`/bookwalker/search/order=sell_desc&s=34`](https://rsshub.app/bookwalker/search/order=sell_desc&s=34)。\n:::\n",categories:[`shopping`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.bookwalker.com.tw/search`],target:`/bookwalker/search`}],view:i.Articles};export{s as handler,c as route};