import"./esm-shims-BFmOnnpb.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as e}from"./ofetch-am9EnuPq.js";import{cache_default as t}from"./cache-Dfid4xgQ.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{load as r}from"cheerio";const i={name:`Blogs`,maintainers:[`CookiePieWw`],categories:[`programming`],path:`/blog/:category?`,example:`/cockroachlabs/blog/engineering`,parameters:{category:`Blog category, e.g., engineering. Subscribe all recent articles if empty.`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`cockroachlabs.com/blog/:category`,`cockroachlabs.com/blog`],target:`/blog`}],handler:a};async function a(i){let a=i.req.param(`category`),o=`https://www.cockroachlabs.com`,s=`${o}/blog${a?`/${a}/`:`/`}`,c=await e(s),l=r(c),u=l(`[class="mb-3 truncate text-display-md font-semibold tracking-tight md:max-w-full md:text-white"]`),d=l(`a > p[class="mb-2 line-clamp-2 text-lg font-semibold leading-5"]`),f=u.add(d).map((e,t)=>{let n=l(t).text(),r=`${o}${l(t).parent(`a`).attr(`href`)}`;return{title:n,link:r}}),p=await Promise.all(f.toArray().map(i=>t.tryGet(i.link,async()=>{let t=await e(i.link),a=r(t),o=a(`article.blog-content`).html()||``,s=a(String.raw`div.mt-4.flex.flex-col.items-center.justify-center.gap-1.sm\:flex-row.sm\:gap-4`).find(`p`).first().text().match(/Last edited on (.+)/)?.[1],c;if(s)try{let e=new Date(s);Number.isNaN(e.getTime())||(c=n(e.toISOString().split(`T`)[0]))}catch{}return{title:i.title,link:i.link,description:o,pubDate:c}})));return{title:`Cockroach Labs Blog${a?` - ${a}`:``}`,link:s,item:p,description:`Cockroach Labs Blog`}}export{i as route};