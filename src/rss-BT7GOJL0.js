import{n as e,t}from"./esm-shims-CMsyBHYK.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CRUPiVpr.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-BlqYKpVp.js";import o from"node:path";import{load as s}from"cheerio";e();const c={path:`/:category?`,categories:[`new-media`],example:`/secretsanfrancisco/top-news`,parameters:{category:`category name, can be found in url`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`secretsanfrancisco.com/:category`],target:`/:category`}],name:`Category`,maintainers:[`EthanWng97`],handler:l};async function l(e){let c=`https://secretsanfrancisco.com`,l=`/wp-json/wp/v2/categories`,u=e.req.param(`category`)||``,d;u&&(d=await n.tryGet(`${c}${l}`,async()=>{let{data:e}=await a(`${c}${l}`,{searchParams:{slug:u}});if(!e||e.length===0)throw Error(`Category "${u}" not found`);return e[0]}));let f=d?.id,p=d?.name,m=d?.link,h=(await a(`${c}/wp-json/wp/v2/posts`,{searchParams:{per_page:e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):10,_embed:``,...f&&{categories:f}}})).data.filter(e=>e.language===`en`).map(e=>{let n=e._embedded?.[`wp:featuredmedia`]?.find(t=>t.id===e.featured_media),a=n?.source_url,c=n?.alt_text||n?.title?.rendered,l;return n?.caption?.rendered&&(l=s(n?.caption?.rendered)),{title:e.title.rendered,description:r(o.join(t,`templates/description-1c044b73.art`),{content:e.content.rendered,image:a,altText:c,caption:l?.text()||``}),link:e.link,pubDate:i(e.date_gmt),updated:i(e.modified_gmt),image:a,author:e._embedded.author[0].name}});return{title:p?`Secret San Francisco - ${p}`:`Secret San Francisco`,link:m||`${c}/${u}`,item:h}}export{c as route};