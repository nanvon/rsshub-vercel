import{n as e,t}from"./esm-shims-BKVRry6h.mjs";import{t as n}from"./ofetch-BRplXtiZ.mjs";import"./config-D7dgKYF5.mjs";import"./logger-CkUWGGaS.mjs";import{t as r}from"./parse-date-_GmTZfjS.mjs";import{t as i}from"./render-CSqLtqb8.mjs";import{t as a}from"./types-CaC5w-Pp.mjs";import o from"node:path";import{load as s}from"cheerio";import c from"markdown-it";e();const l=c({html:!0,linkify:!0}),u=async e=>{let a=Number.parseInt(e.req.query(`limit`)??`30`,10),c=`https://www.dgtle.com`,u=new URL(`feed`,c).href,d=new URL(`feed/getHotDynamic`,c).href,f=await n(d,{query:{last_id:0}}),p=s(await n(u)),m=p(`html`).attr(`lang`)??`zh-CN`,h=[];return h=f.data.dataList.slice(0,a).map(e=>{let n=e.content?l.render(e.content):``,a=p(n).text(),s=i(o.join(t,`templates/description-36fefaf3.art`),{images:e.imgs_url.map(e=>({src:e})),description:n}),u=e.created_at,d=e.url,f=[...new Set((e.tags_info?.map(e=>e.title)??[]).filter(Boolean))],h=[{name:e.user_name,url:new URL(`user?uid=${e.encode_uid}`,c).href,avatar:e.avatar_path}],g=`dgtle-${e.id}`,_=e.imgs_url?.[0],v=e.updated_at??u,y={title:a,description:s,pubDate:u?r(u,`X`):void 0,link:d?new URL(d,c).href:void 0,category:f,author:h,guid:g,id:g,content:{html:s,text:s},image:_,banner:_,updated:v?r(v,`X`):void 0,language:m},b=(()=>{let t={};for(let n of e.imgs_url){let e=n;if(!e)continue;let r=`image`,i=`${r}${Object.values(t).filter(e=>e.medium===r).length+1}`;t[i]={url:e,medium:r,title:``,description:``,thumbnail:e}}return t})();return y={...y,media:b},y}),{title:p(`title`).text(),description:p(`meta[name="description"]`).attr(`content`),link:u,item:h,allowEmpty:!0,author:p(`meta[name="keywords"]`).attr(`content`)?.split(/,/)[0]??void 0,language:m,id:u}},d={path:`/feed`,name:`兴趣`,url:`www.dgtle.com`,maintainers:[`nczitzk`],handler:u,example:`/dgtle/feed`,parameters:void 0,description:void 0,categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.dgtle.com/feed`],target:`/feed`}],view:a.Articles};export{u as handler,d as route};