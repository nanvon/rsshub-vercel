import{n as e,t}from"./esm-shims-mGm6WwCc.js";import"./config-DZMnNPig.js";import{t as n}from"./logger-asV68Lay.js";import"./proxy-CczVputb.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{n as a}from"./puppeteer-e0F06Yyi.js";import o from"node:path";import{load as s}from"cheerio";e();const c={name:`漏洞`,categories:[`programming`],path:`/zeroday/vulnerability/:status?`,example:`/hitcon/zeroday/vulnerability`,parameters:{status:`漏洞状态，见下表`},maintainers:[`KarasuShin`],radar:[{source:[`zeroday.hitcon.org/vulnerability/:status?`]}],features:{requirePuppeteer:!0},handler:u,description:`| 缺省   | all  | closed | disclosed | patching |
| ------ | ---- | ------ | --------- | -------- |
| 活動中 | 全部 | 關閉   | 公開      | 修補中   |`},l={all:`全部`,closed:`關閉`,disclosed:`公開`,patching:`修補中`};async function u(e){let c=`https://zeroday.hitcon.org/vulnerability`,u=e.req.param(`status`);u&&(c+=`/${u}`);let d=await a(),f=await d.newPage();await f.setRequestInterception(!0),f.on(`request`,e=>{e.resourceType()===`document`?e.continue():e.abort()}),n.http(`Requesting ${c}`),await f.goto(c,{waitUntil:`domcontentloaded`});let p=await f.evaluate(()=>document.documentElement.innerHTML);await d.close();let m=s(p),h=m(`.zdui-strip-list>li`).toArray().map(e=>{let n=m(e).find(`.title a`),a=m(e).find(`.vul-data`),s=a.find(`.code`).contents().filter(function(){return this.nodeType===3}).text(),c=a.find(`.risk span`).eq(1).text(),l=a.find(`.vender`).find(`.v-name-full`).text(),u=a.find(`.status`).text().replace(`Status:`,``).trim(),d=a.find(`.date`).text().replace(`Date:`,``).trim(),f=a.find(`.zdui-author-badge`).find(`a>span`).text(),p=r(o.join(t,`templates/zeroday-08cb6861.art`),{code:s,risk:c,vender:l,status:u,date:d,reporter:f});return{title:n.text(),link:n.attr(`href`),description:p,pubDate:i(d)}});return{title:u?l[u]??`ZeroDay`:`活動中`,link:c,item:h,image:`https://zeroday.hitcon.org/images/favicon/favicon.png`}}export{c as route};