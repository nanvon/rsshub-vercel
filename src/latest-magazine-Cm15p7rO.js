import{n as e,t}from"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CfXAR0UO.js";import"./helpers-Cqaav28H.js";import{t as n}from"./render-d6AVTUl2.js";import{t as r}from"./got-dCh-Ojgc.js";import i from"node:path";import{load as a}from"cheerio";e();const o={path:`/latest-magazine/:query?`,categories:[`reading`],example:`/magazinelib/latest-magazine/new+yorker`,parameters:{query:`query, search page querystring`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`Latest Magazine`,maintainers:[`EthanWng97`],handler:s,description:"For instance, when doing search at [https://magazinelib.com](https://magazinelib.com) and you get url `https://magazinelib.com/?s=new+yorker`, the query is `new+yorker`"};async function s(e){let o=e.req.param(`query`),s=await r({method:`get`,url:`https://magazinelib.com/wp-json/wp/v2/posts/`,searchParams:{search:o,per_page:30,_embed:1}}),c=o;c===void 0?c=``:(c=c.replaceAll(/[^\dA-Za-z]+/g,` `).toUpperCase(),c=` - ${c}`);let l=s.data.map(e=>{let r={date:e.date_gmt,link:e.link,featuredMediaLink:e._links[`wp:featuredmedia`][0].href,title:e.title.rendered},o=a(e.content.rendered)(`.vk-att`);o.find(`img[src="https://magazinelib.com/wp-includes/images/media/default.png"]`).remove(),r.content=o.html();let s=e._embedded[`wp:featuredmedia`][0].source_url;return r.description=r.content+n(i.join(t,`templates/magazine-description-5b741265.art`),{imgUrl:s}),r.categories=e._embedded[`wp:term`][0].map(e=>e.name),r});return{title:`MagazineLib - Latest Magazines${c}`,link:`{host}/?s=${o}`,description:`MagazineLib - Latest Magazines${c}`,item:l.map(e=>({title:e.title,link:e.link,category:e.categories,pubDate:new Date(e.pubDate).toUTCString(),description:e.description}))}}export{o as route};