import{n as e,t}from"./esm-shims-mGm6WwCc.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-BASlBuka.js";import"./helpers-Cqaav28H.js";import{t as n}from"./render-d6AVTUl2.js";import{t as r}from"./parse-date-CHEO0z5G.js";import{t as i}from"./got-CgQXMNWI.js";import{t as a}from"./types-Bn7An2Wc.js";import o from"node:path";import s from"dayjs";e();const c={path:`/freegames/:locale?/:country?`,categories:[`game`],view:a.Notifications,example:`/epicgames/freegames/en-US/US`,parameters:{locale:{description:`Locale`,default:`en-US`},country:{description:`Country`,default:`US`}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`store.epicgames.com/:locale/free-games`],target:`/freegames/:locale`}],name:`Free games`,maintainers:[`DIYgod`,`NeverBehave`,`Zyx-A`,`junfengP`,`nczitzk`,`KotaHv`],handler:l};async function l(e){let a=e.req.param(`locale`)??`en-US`,c=e.req.param(`country`)??`US`,l=`https://store.epicgames.com`,u=`${l}/${a}/free-games?lang=${a}`,d=`https://store-site-backend-static-ipv4.ak.epicgames.com/freeGamesPromotions?locale=${a}&country=${c}&allowCountries=${c}`,f=`https://store-content-ipv4.ak.epicgames.com/api/${a}/content`,p=await i({method:`get`,url:d}),m=s(),h=p.data.data.Catalog.searchStore.elements.filter(e=>e.promotions&&e.promotions.promotionalOffers&&e.promotions.promotionalOffers.length&&e.promotions.promotionalOffers[0].promotionalOffers[0].discountSetting.discountType===`PERCENTAGE`&&e.promotions.promotionalOffers[0].promotionalOffers[0].discountSetting.discountPercentage===0&&s(e.promotions.promotionalOffers[0].promotionalOffers[0].startDate)<=m&&s(e.promotions.promotionalOffers[0].promotionalOffers[0].endDate)>m).map(async e=>{let c=`${l}/${a}/p/`,u=`${f}/products/`,d=!1;e.categories.some(e=>e.path===`bundles`)&&(c=`${l}/${a}/bundles/`,d=!0,u=`${f}/bundles/`);let p=e.catalogNs.mappings&&e.catalogNs.mappings.length>0?e.catalogNs.mappings[0].pageSlug:e.offerMappings&&e.offerMappings.length>0?e.offerMappings[0].pageSlug:e.productSlug??e.urlSlug;e.offerType===`ADD_ON`&&(p=e.offerMappings[0].pageSlug),c+=p,u+=p;let m=e.description;d&&(m=(await i({method:`get`,url:u})).data.data.about.shortDescription);let h=e.keyImages[0].url;e.keyImages.some(e=>e.type===`DieselStoreFrontWide`?(h=e.url,!0):!1);let g=s(e.promotions.promotionalOffers[0].promotionalOffers[0].endDate).toISOString();return{title:e.title,author:e.seller.name,link:c,description:n(o.join(t,`templates/description-a3b89ca2.art`),{description:m,image:h,endDate:g}),pubDate:r(e.promotions.promotionalOffers[0].promotionalOffers[0].startDate)}});return{title:`Epic Games Store - Free Games`,link:u,item:await Promise.all(h)}}export{c as route};