import"./esm-shims-DtWyl6zt.js";import"./config-BpwDbAkH.js";import"./logger-B3QfaIfn.js";import"./dist-CKN2M7CD.js";import"./helpers-DzX-lcQO.js";import"./render-CxhTJIsl.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import"./ofetch-CYKAhM9L.js";import{got_default as t}from"./got-pWlL3EH4.js";import{baseUrl as n,fixImage as r,fixVideo as i}from"./utils-FLqPA10x.js";import{load as a}from"cheerio";const o={path:`/:type/:name`,name:`Unknown`,maintainers:[],handler:s};async function s(o){let{type:s,name:c,sort:l=`new`}=o.req.param(),u=l===`default`||s===`tag`?``:`/${l}`,{data:d}=await t(`${n}/ajax/${s}/${c}${u}`),f=d.data.stories.map(t=>{let n=a(t.html,null,!1),o=JSON.parse(n(`script[type="application/ld+json"]`).text()),s=n(`.story__main`);return r(s),s.find(`.player`).each((e,t)=>{t=n(t),i(t)}),{title:o.name,description:s.find(`.story__content-inner`).html(),pubDate:e(o.dateCreated),author:o.author.name,link:o.url}});return{title:d.data.title,link:`${n}/${s}/${c}`,language:`ru-RU`,item:f}}export{o as route};