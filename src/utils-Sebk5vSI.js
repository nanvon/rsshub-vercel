import{n as e,t}from"./esm-shims-BC3isTv8.js";import{t as n}from"./ofetch-CfXAR0UO.js";import{t as r}from"./cache-CpEhLexq.js";import{t as i}from"./render-d6AVTUl2.js";import a from"node:path";import{load as o}from"cheerio";e();const s=async e=>(await n(`https://api.aeonmedia.co/graphql`,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({query:`query getImageById($id: ID!) { image(id: $id) { id url alt caption width height } }`,variables:{id:e,site:`Aeon`},operationName:`getImageById`})})).data.image.url;function c(e){let n=e.type.toLowerCase(),r=``,s=``,c=``;switch(n){case`film`:r=i(a.join(t,`templates/video-eb6996af.art`),{article:e});break;case`guide`:{s=e.imageSquare?.url,c=e.authors.map(e=>e.bio).join(` `);let n=[`Need To Know`,`What To Do`,`Key Points`,`Learn More`,`Links & Books`],l=Object.keys(e).filter(e=>e.startsWith(`section`)&&e!==`section`).map(t=>{let r=o(e[t]);return r(`p.pullquote`).remove(),`<h2>${n.shift()}</h2>`+r.html()}).join(``);r=i(a.join(t,`templates/essay-18b14798.art`),{banner:s,authorsBio:c,content:l});break}case`idea`:{s=e.imageLandscape?.url,c=e.authors.map(e=>e.bio).join(` `);let n=o(e.body);n(`p.pullquote`).remove(),r=i(a.join(t,`templates/essay-18b14798.art`),{banner:s,authorsBio:c,content:n.html()});break}default:break}return r}const l=async e=>await Promise.all(e.map(e=>r.tryGet(e.link,async()=>{let t=(await n(e.json)).pageProps.article;e.pubDate=new Date(t.publishedAt).toUTCString();let r=o(c(t));await Promise.all(r(`dl > dt`).toArray().map(async e=>{let t=r(e).text(),n=await s(t);r(e).replaceWith(`<img src="${n}" alt="${t}">`)}));let i=``;return i=t.type===`film`?t.creditsShort:t.authors.map(e=>e.name).join(`, `),e.description=r.html(),e.author=i,e})));export{l as t};