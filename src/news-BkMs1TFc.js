import"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as e}from"./ofetch-CISb_5Uo.js";import{cache_default as t}from"./cache-Dfid4xgQ.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{timezone as r}from"./timezone-CMz5pnRe.js";import{load as i}from"cheerio";const a={path:`/news/:category?`,categories:[`university`],example:`/tsinghua/news`,parameters:{category:"分类，可在对应分类页 URL 中找到，留空为 `zxdt`"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`清华新闻`,radar:[{source:[`www.tsinghua.edu.cn/news/:category`],target:(e,t)=>`/tsinghua/news/${new URL(t).pathname.split(`/`).pop()?.replace(`.htm`,``)}`}],maintainers:[`TonyRL`],url:`www.tsinghua.edu.cn/news.htm`,handler:o};async function o(a){let{category:o=`zxdt`}=a.req.param(),s=`https://www.tsinghua.edu.cn`,c=`${s}/news/${o}.htm`,l=await e(c),u=i(l),d=[...u(`.left li a`).toArray().map(e=>{let t=u(e),r=t.find(`.sj`);return{title:t.find(`.bt`).text().trim(),link:new URL(t.attr(`href`),s).href?.replace(`http://`,`https://`),pubDate:n(`${r.find(`span`).text().trim()}.${r.find(`p`).text().trim()}`,`YYYY.MM.DD`)}}),...u(`.qhrw2_first`).length?[{title:u(`.qhrw2_first .bt`).text().trim(),link:u(`.qhrw2_first a`).attr(`href`)?.replace(`http://`,`https://`),pubDate:n(`${u(`.qhrw2_first .sj span`).text().trim()}.${u(`.qhrw2_first .sj p`).text().trim()}`,`YYYY.MM.DD`)}]:[]],f=await Promise.all(d.map(a=>t.tryGet(a.link,async()=>{if(!a.link?.startsWith(`https://www.tsinghua.edu.cn/info/`))return a;let t=await e(a.link),o=i(t);return a.description=o(`.v_news_content`).html(),a.pubDate=r(n(o(`.sj p`).text().trim(),`YYYY年MM月DD日 HH:mm:ss`),8),a})));return{title:u(`head title`).text(),link:c,item:f}}export{a as route};