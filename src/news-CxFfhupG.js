import{n as e,t}from"./esm-shims-mGm6WwCc.js";import{n}from"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-BASlBuka.js";import"./helpers-Cqaav28H.js";import{t as r}from"./cache-CpEhLexq.js";import{t as i}from"./render-d6AVTUl2.js";import{t as a}from"./parse-date-CHEO0z5G.js";import{t as o}from"./got-CgQXMNWI.js";import s from"node:path";import{load as c}from"cheerio";import l from"p-map";e();const u=n({browser:`chrome`,os:`android`,device:`mobile`}),d=e=>r.tryGet(e.link,async()=>{let n=(await o({url:e.link.replace(/(?<=^https:\/\/\w+\.wsj\.com)/,`/amp`),method:`get`,headers:{"User-Agent":u}})).data,r=c(n),l=r(`head > meta[name="description"]`).attr(`content`),d=r(`meta[itemprop="dateModified"]`).attr(`content`),f=r(`meta[itemprop="datePublished"]`).attr(`content`),p=r(`.author > a[rel="author"]`).text(),m=r(`meta[name="keywords"]`).attr(`content`).split(`,`).map(e=>e.trim()),h=r(`article`);e.subTitle=r(`h2.sub-head`).html(),h.find(`.media-object-podcast`).remove(),h.find(`.bylineWrap`).each((e,t)=>{r(t).find(`p`).each(function(){r(this).replaceWith(r(this).html())})}),h.find(`.bigTop-hero`).each((e,t)=>{r(r(`<figure><img src="${r(t).find(`amp-img`).attr(`src`)}" alt="${r(t).find(`amp-img`).attr(`alt`)}"><figcaption>${r(t).find(`.imageCaption`).text().trim()} <span>${r(t).find(`.imageCredit`).text().trim()}</span></figcaption></figure>`)).insertBefore(t),r(t).remove()}),h.find(`amp-img`).each((e,t)=>{r(r(`<img width="${t.attribs.width}" height="${t.attribs.height}" src="${t.attribs.src}" alt="${t.attribs.alt}">`)).insertBefore(t),r(t).remove()}),h.find(`amp-iframe`).each((e,t)=>{r(r(`<iframe width="${t.attribs.width}" height="${t.attribs.height}" src="${t.attribs.src}">`)).insertBefore(t),r(t).remove()});for(let e of[`amp-ad`,`.wsj-ad`,`h1`,`h2`,`.zonedModule`,`.snippet`,`.newsletter-inset`])h.find(e).each((e,t)=>{r(t).remove()});return h.find(`.paywall`).each((e,t)=>{r(t.childNodes).insertBefore(t),r(t).remove()}),e.article=h.html(),e.description=i(s.join(t,`templates/article-description-8e28f8db.art`),{item:e}),{title:e.title,pubDate:a(f),updated:a(d),author:p,link:e.link,summary:l,description:e.description,category:m,icon:`https://s.wsj.net/media/wsj_launcher-icon-4x.png`,logo:`https://vir.wsj.net/fp/assets/webpack4/img/wsj-logo-big-black.165e51cc.svg`}}),f={"en-us":`https://www.wsj.com`,"zh-cn":`https://cn.wsj.com/zh-hans`,"zh-tw":`https://cn.wsj.com/zh-hant`},p={path:`/:lang/:category?`,categories:[`traditional-media`],example:`/wsj/en-us/opinion`,parameters:{lang:"Language, `en-us`, `zh-cn`, `zh-tw`",category:`Category. See below`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`News`,maintainers:[`oppilate`],handler:m,description:`en_us

| World | U.S. | Politics | Economy | Business | Tech       | Markets | Opinion | Books & Arts | Real Estate | Life & Work | Sytle               | Sports |
| ----- | ---- | -------- | ------- | -------- | ---------- | ------- | ------- | ------------ | ----------- | ----------- | ------------------- | ------ |
| world | us   | politics | economy | business | technology | markets | opinion | books-arts   | realestate  | life-work   | style-entertainment | sports |

  zh-cn / zh-tw

| 国际  | 中国  | 金融市场 | 经济    | 商业     | 科技       | 派        | 专栏与观点 |
| ----- | ----- | -------- | ------- | -------- | ---------- | --------- | ---------- |
| world | china | markets  | economy | business | technology | life-arts | opinion    |

  Provide full article RSS for WSJ topics.`};async function m(e){let t=e.req.param(`lang`),n=e.req.param(`category`)||``,r=f[t],i=` - ${t.toUpperCase()}`,a=r;n.length>0&&(a=`${r}/news/${n}`,i=`${i} - ${n}`);let s=c((await o({method:`get`,url:a})).data)(`script:contains("window.__STATE__")`).text(),u=JSON.parse(s.match(/{.*}/)[0]).data,p=await l(Object.entries(u).filter(([e,t])=>e.startsWith(`article`)?t.data.data.url.includes(`wsj.com/articles/`):!1).map(([e])=>e).map(e=>({title:u[e].data.data.headline,link:u[e].data.data.url,test:e})),e=>d(e),{concurrency:10});return{title:`WSJ${i}`,link:a,description:`WSJ${i}`,item:p}}export{p as route};