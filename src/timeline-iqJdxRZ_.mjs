import{n as e,t}from"./esm-shims-C3MSy80G.mjs";import"./config-PItPnVIx.mjs";import"./logger-BoKmWr7Z.mjs";import"./ofetch-Byd8Ct7M.mjs";import"./helpers-vRt84cId.mjs";import{t as n}from"./cache-KwJARS5Z.mjs";import{t as r}from"./render-ZYpwNl2L.mjs";import{t as i}from"./parse-date-9Tu6hSFW.mjs";import{t as a}from"./got-BYElsd7I.mjs";import{t as o}from"./types-zV-JXsJH.mjs";import s from"node:path";import{load as c}from"cheerio";e();const l={path:`/timeline/:category?`,categories:[`finance`],view:o.Articles,example:`/jinse/timeline`,parameters:{category:{description:`分类`,options:[{value:`头条`,label:`头条`},{value:`独家`,label:`独家`},{value:`铭文`,label:`铭文`},{value:`产业`,label:`产业`},{value:`项目`,label:`项目`},{value:`政策`,label:`政策`},{value:`AI`,label:`AI`},{value:`Web 3.0`,label:`Web 3.0`},{value:`以太坊 2.0`,label:`以太坊 2.0`},{value:`DeFi`,label:`DeFi`},{value:`Layer2`,label:`Layer2`},{value:`NFT`,label:`NFT`},{value:`DAO`,label:`DAO`},{value:`百科`,label:`百科`}],default:`头条`}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`首页`,maintainers:[`nczitzk`],handler:u,description:`| 头条   | 独家 | 铭文    | 产业       | 项目 |
| ------ | ---- | ------- | ---------- | ---- |
| 政策   | AI   | Web 3.0 | 以太坊 2.0 | DeFi |
| Layer2 | NFT  | DAO     | 百科       |      |`};async function u(e){let{category:o=`头条`}=e.req.param(),l=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):50,u=`https://www.jinse.cn`,d=new URL(`noah/v3/timelines`,`https://api.jinse.cn`).href,f=u,{data:p}=await a(d,{searchParams:{catelogue_key:o===`头条`?`www`:o,limit:l,information_id:0,flag:`up`}}),m=p.data.list.slice(0,l).map(e=>(e=e.object_1??e.object_2,{title:e.title,link:e.jump_url,description:r(s.join(t,`templates/description-d03b585b.art`),{images:e.cover?[{src:e.cover.replace(/_[^\W_]+(\.\w+)$/,`_true$1`),alt:e.title}]:void 0,intro:e.summary,description:e.content}),author:e.author.nickname,guid:`jinse${/\/lives\//.test(e.jump_url)?`-lives`:``}-${e.id}`,pubDate:i(e.published_at,`X`),upvotes:e.up_counts??0,downvotes:e.down_counts??0,comments:e.comment_count??0}));m=await Promise.all(m.map(e=>n.tryGet(e.link,async()=>{if(/\/lives\//.test(e.link))return e;let{data:n}=await a(e.link),i=c(n);return e.description+=r(s.join(t,`templates/description-d03b585b.art`),{description:i(`section.js-article-content`).html()||i(`div.js-article`).html()}),e.category=i(`section.js-article-tag_state_1 a span`).toArray().map(e=>i(e).text()),e})));let{data:h}=await a(f),g=c(h),_=g(`meta[name="author"]`).prop(`content`),v=g(`a.js-logoBox img`).prop(`src`),y=new URL(g(`link[rel="favicon"]`).prop(`href`),u).href;return{item:m,title:`${_} - ${o}`,link:f,description:g(`meta[name="description"]`).prop(`content`),language:g(`html`).prop(`lang`),image:v,icon:y,logo:y,subtitle:g(`meta[name="keywords"]`).prop(`content`),author:_,allowEmpty:!0}}export{l as route};