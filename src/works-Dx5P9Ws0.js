import"./esm-shims-Dqvxr0BZ.js";import"./config-1ATZGjxb.js";import"./logger-B19BYg4C.js";import{ofetch_default as e}from"./ofetch-B4O0sZDE.js";import{cache_default as t}from"./cache-CjzVN0X7.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{load as r}from"cheerio";const i={name:`投稿`,categories:[`reading`],path:`/works/:id`,example:`/kakuyomu/works/1177354054894027232`,parameters:{id:`投稿 ID`},maintainers:[`KarasuShin`],handler:a,features:{supportRadar:!0},radar:[{source:[`kakuyomu.jp/works/:id`],target:`/works/:id`}]};async function a(i){let a=i.req.param(`id`),o=`https://kakuyomu.jp/works/${a}`,s=Number.parseInt(i.req.query(`limit`)||`10`),c=r(await e(o)),l=JSON.parse(c(`#__NEXT_DATA__`).text()),{props:{pageProps:{__APOLLO_STATE__:u}}}=l,{[`Work:${a}`]:{title:d,catchphrase:f}}=u,p=Object.values(u),m=p.filter(e=>e.__typename===`Episode`),h=await Promise.all(m.toSorted((e,t)=>t.publishedAt.localeCompare(e.publishedAt)).slice(0,s).map(i=>{let o=`https://kakuyomu.jp/works/${a}/episodes/${i.id}`;return t.tryGet(o,async()=>{let t=r(await e(o)),a=t(`.widget-episodeBody`).html();return{title:i.title,link:o,description:a,pubDate:n(i.publishedAt),guid:i.id}})}));return{title:d,link:o,description:f,item:h}}export{i as route};