import{n as e,t}from"./esm-shims-BKVRry6h.mjs";import"./config-uQhBoCds.mjs";import"./logger-DQf7gybc.mjs";import"./ofetch-7N8fmlQ6.mjs";import"./helpers-C6Jountz.mjs";import{t as n}from"./cache-BXZZTZVV.mjs";import{t as r}from"./render-_fW2cbJz.mjs";import{t as i}from"./parse-date-C2HciIa2.mjs";import{t as a}from"./got-DcbI0XpN.mjs";import o from"node:path";e();const s={path:`/live/:id`,categories:[`traditional-media`],example:`/pts/live/62e8e4bbb4de2cbd74468b2b`,parameters:{id:`報導 id，可在对应整理報導页 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`news.pts.org.tw/live/:id`,`news.pts.org.tw/`]}],name:`整理報導`,maintainers:[],handler:c};async function c(e){let s=e.req.param(`id`),c=`https://news.pts.org.tw`,l=`${c}/live/${s}`,u=await a({method:`get`,url:`${c}/live/api/liveblog/${s}`}),d=u.data.data.blogArticleList.slice(0,e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):30).map(e=>({link:`${c}/live/api/liveblog/article?articleId=${e}&model=main`}));return d=await Promise.all(d.map(e=>n.tryGet(e.link,async()=>{let n=(await a({method:`get`,url:e.link})).data.data;return e.title=n.title,e.pubDate=i(n.updatedDate),e.description=r(o.join(t,`templates/live-151f80f9.art`),{images:n.content.filter(e=>e.type===`img`).map(e=>`https://dkjm35kkdt2ag.cloudfront.net/${e.imgFileUrl}`),texts:n.content.filter(e=>e.type===`text`).map(e=>e.content)}),e}))),{title:`公視新聞網 PNN - ${u.data.data.title.replace(/【不斷更新】/,``)}`,link:l,item:d}}export{s as route};