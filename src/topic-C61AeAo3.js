import{__dirname as e,init_esm_shims as t}from"./esm-shims-rNwigI-Q.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-CeMUzp5K.js";import"./helpers-qpI1t-yV.js";import{cache_default as n}from"./cache-Dfid4xgQ.js";import{art as r}from"./render-DftO2d-b.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import{got_default as a}from"./got-Di2lBekK.js";import o from"node:path";import{load as s}from"cheerio";t();const c={path:`/:community/:category?`,categories:[`bbs`],example:`/learnku/laravel/qa`,parameters:{community:`社区 标识，可在 <https://learnku.com/communities> 找到`,category:"分类，如果不传 `category` 则获取全部分类"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`learnku.com/:community`],target:`/:community`}],name:`社区`,maintainers:[`kayw-geek`],handler:l,description:`| 招聘 | 翻译         | 问答 | 链接  |
| ---- | ------------ | ---- | ----- |
| jobs | translations | qa   | links |`};async function l(t){let c=t.req.param(`community`),l=t.req.param(`category`)||``,u=`https://learnku.com/${c}`;l!==``&&(u=`https://learnku.com/${c}/c/${l}`);let d=(await a({method:`get`,url:u})).data,f=s(d),p=f(`.simple-topic`).toArray(),m=await Promise.all(p.map(async t=>{let c=s(t),l=c(`.category-name span`).text().trim();if([`置顶`,`广告`].includes(l))return``;c(`.topic-title i`).remove();let u=c(`.topic-title-wrap`).attr(`href`),d=c(`.topic-title`).text().trim(),f=await n.tryGet(u,async()=>s((await a.get(u)).data)),p=f(`.article-content .content-body`).html(),m=f(`#all-comments`).html();return{title:d,description:r(o.join(e,`templates/topic-17346cca.art`),{article:p,comment:m}),category:l,link:u,pubDate:i(c(`.timeago`).attr(`title`),`YYYY/MM/DD`)}})),h=f(`.sidebar .community-details .header span`).text();f(`.sidebar .community-details .main div div a`).remove();let g=f(`.sidebar .community-details .main div div`).text();return{title:`LearnKu - ${h} - ${new Map([[`translations`,{name:`翻译`}],[`jobs`,{name:`招聘`}],[`qa`,{name:`问答`}],[`links`,{name:`链接`}],[``,{name:`最新`}]]).get(l).name}`,link:u,description:g,item:m.filter(e=>e!==``)}}export{c as route};