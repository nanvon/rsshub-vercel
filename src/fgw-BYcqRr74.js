import{n as e,t}from"./esm-shims-mGm6WwCc.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-BASlBuka.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-CgQXMNWI.js";import{t as o}from"./timezone-BPfwRbwD.js";import s from"node:path";import{load as c}from"cheerio";e();const l=async e=>{let{category:l=`fgw_zxxxgk`}=e.req.param(),u=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):20,d=`https://fgw.sh.gov.cn`,f=new URL(`${l}/index.html`,d).href,{data:p}=await a(f),m=c(p),h=m(`html`).prop(`lang`),g=m(`ul.nowrapli li`).slice(0,u).toArray().map(e=>(e=m(e),{title:e.find(`a`).prop(`title`),pubDate:i(e.find(`span.time`).text()),link:new URL(e.find(`a`).prop(`href`),d).href,language:h}));g=await Promise.all(g.map(e=>n.tryGet(e.link,async()=>{if(!e.link.endsWith(`.html`))return e.enclosure_url=e.link,e.enclosure_type=e.link?`application/${e.link.split(/\./).pop()}`:void 0,e.enclosure_title=e.title,e;let{data:n}=await a(e.link),l=c(n),u=l(`meta[name="ArticleTitle"]`).prop(`content`),f=l(`div.pdf-content img`).first().prop(`src`),p=r(s.join(t,`templates/description-16be3a2a.art`),{images:f?[{src:f,alt:u}]:void 0,description:l(`div#ivs_content`).html()});e.title=u,e.description=p,e.pubDate=o(i(l(`meta[name="PubDate"]`).prop(`content`)),8),e.category=[...new Set([l(`meta[name="ColumnName"]`).prop(`content`),l(`meta[name="ColumnKeywords"]`).prop(`content`)])].filter(Boolean),e.author=l(`meta[name="ContentSource"]`).prop(`content`),e.content={html:p,text:l(`div#ivs_content`).text()},e.image=f,e.banner=f,e.language=h;let m=l(`div.pdf-content a, div.xgfj a`).first().prop(`href`);return e.enclosure_url=m?new URL(m,d).href:void 0,e.enclosure_type=m?`application/${m.split(/\./).pop()}`:void 0,e.enclosure_title=u,e})));let _=m(`meta[name="SiteName"]`).prop(`content`),v=m(`span.logo-icon img`).prop(`src`);return{title:`${_} - ${m(`meta[name="ColumnName"]`).prop(`content`)}`,description:m(`meta[name="ColumnDescription"]`).prop(`content`),link:f,item:g,allowEmpty:!0,image:v,author:_,language:h}},u={path:[`/sh/fgw/:category{.+}?`,`/shanghai/fgw/:category{.+}?`],name:`上海市发展和改革委员会`,url:`fgw.sh.gov.cn`,maintainers:[`nczitzk`],handler:l,example:`/gov/sh/fgw/fgw_zxxxgk`,parameters:{category:"分类，默认为 `fgw_zxxxgk`，即最新信息公开，可在对应分类页 URL 中找到"},description:"::: tip\n  若订阅 [最新信息公开](https://fgw.sh.gov.cn/fgw_zxxxgk/index.html)，网址为 `https://fgw.sh.gov.cn/fgw_zxxxgk/index.html`。截取 `https://fgw.sh.gov.cn/` 到末尾 `/index.html` 的部分 `fgw_zxxxgk` 作为参数填入，此时路由为 [`/gov/sh/fgw/fgw_zxxxgk`](https://rsshub.app/gov/sh/fgw/fgw_zxxxgk)。\n:::\n\n| 最新信息公开 | 要闻动态   |\n| ------------ | ---------- |\n| fgw_zxxxgk   | fgw_fzggdt |\n  ",categories:[`government`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`fgw.sh.gov.cn/:category`],target:e=>{let t=e.category.replace(/\/index\.html/,``);return`/gov/sh/fgw${t?`/${t}`:``}`}},{title:`最新信息公开`,source:[`fgw.sh.gov.cn/fgw_zxxxgk/index.html`],target:`/sh/fgw/fgw_zxxxgk`},{title:`要闻动态`,source:[`fgw.sh.gov.cn/fgw_fzggdt/index.html`],target:`/sh/fgw/fgw_fzggdt`}]};export{l as handler,u as route};