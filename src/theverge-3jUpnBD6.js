import{n as e,t}from"./esm-shims-mGm6WwCc.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t as n}from"./ofetch-BASlBuka.js";import{t as r}from"./cache-CpEhLexq.js";import{t as i}from"./render-d6AVTUl2.js";import{t as a}from"./rss-parser-CbA1uKIl.js";import o from"node:path";import{load as s}from"cheerio";e();const c=new Set([`NewsletterBlockType`,`RelatedPostsBlockType`,`ProductsTableBlockType`,`TableOfContentsBlockType`]),l=e=>!c.has(e.__typename.trim()),u={path:`/:hub?`,categories:[`new-media`],example:`/theverge`,parameters:{hub:`Hub, see below, All Posts by default`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`theverge.com/:hub`,`theverge.com/`]}],name:`Category`,maintainers:[`HenryQW`,`vbali`],handler:f,description:`| Hub         | Hub name            |
| ----------- | ------------------- |
|             | All Posts           |
| android     | Android             |
| apple       | Apple               |
| apps        | Apps & Software     |
| blackberry  | BlackBerry          |
| culture     | Culture             |
| gaming      | Gaming              |
| hd          | HD & Home           |
| microsoft   | Microsoft           |
| photography | Photography & Video |
| policy      | Policy & Law        |
| web         | Web & Social        |

  Provides a better reading experience (full text articles) over the official one.`},d=e=>{if(!l(e))return``;switch(e.__typename){case`CoreEmbedBlockType`:return e.embedHtml;case`CoreGalleryBlockType`:return e.images.map(e=>`<figure><img src="${e.image.thumbnails.horizontal.url.split(`?`)[0]}" alt="${e.alt}" /><figcaption>${e.caption.html}</figcaption></figure>`).join(``);case`CoreHeadingBlockType`:return`<h${e.level}>${e.contents.html}</h${e.level}>`;case`CoreHTMLBlockType`:return e.markup;case`CoreImageBlockType`:return`<figure><img src="${e.thumbnail.url.split(`?`)[0]}" alt="${e.alt}" /><figcaption>${e.caption.html}</figcaption></figure>`;case`CoreListBlockType`:return`${e.ordered?`<ol>`:`<ul>`}${e.items.map(e=>`<li>${e.contents.html}</li>`).join(``)}${e.ordered?`</ol>`:`</ul>`}`;case`CoreParagraphBlockType`:return e.tempContents.map(e=>e.html).join(``);case`CorePullquoteBlockType`:return`<blockquote>${e.contents.html}</blockquote>`;case`CoreQuoteBlockType`:return`<blockquote>${e.children.map(e=>d(e)).join(``)}</blockquote>`;case`CoreSeparatorBlockType`:return`<hr>`;case`HighlightBlockType`:return e.children.map(e=>d(e)).join(``);case`ImageCompareBlockType`:return`<figure><img src="${e.leftImage.thumbnails.horizontal.url.split(`?`)[0]}" alt="${e.leftImage.alt}" /><img src="${e.rightImage.thumbnails.horizontal.url.split(`?`)[0]}" alt="${e.rightImage.alt}" /><figcaption>${e.caption.html}</figcaption></figure>`;case`ImageSliderBlockType`:return e.images.map(e=>`<figure><img src="${e.image.originalUrl.split(`?`)[0]}" alt="${e.alt}" /><figcaption>${e.caption.html}</figcaption></figure>`).join(``);case`MethodologyAccordionBlockType`:return`<h2>${e.heading.html}</h2>${e.sections.map(e=>`<h3>${e.heading.html}</h3>${e.content.html}`).join(``)}`;case`ProductBlockType`:{let t=e.product;return`<div><figure><img src="${t.image.thumbnails.horizontal.url.split(`?`)[0]}" alt="${t.image.alt}" /><figcaption>${t.image.alt}</figcaption></figure><br><a href="${t.bestRetailLink.url}">${t.title} $${t.bestRetailLink.price}</a><br>${t.description.html}${t.pros.html?`<br>The Good${t.pros.html}The Bad${t.cons.html}`:``}</div>`}case`TableBlockType`:return`<table><tr>${e.header.map(e=>`<th>${e}</th>`).join(``)}</tr>${e.rows.map(e=>`<tr>${e.map(e=>`<td>${e}</td>`).join(``)}</tr>`).join(``)}</table>`;default:throw Error(`Unsupported block type: ${e.__typename}`)}};async function f(e){let c=e.req.param(`hub`)?`https://www.theverge.com/rss/${e.req.param(`hub`)}/index.xml`:`https://www.theverge.com/rss/index.xml`,l=await a.parseURL(c),u=await Promise.all(l.items.map(e=>r.tryGet(e.link,async()=>{let r=s(await n(e.link)),a=JSON.parse(r(`script#__NEXT_DATA__`).text()).props.pageProps.hydration.responses.find(e=>e.operationName===`PostLayoutQuery`||e.operationName===`StreamLayoutQuery`).data.node,c=i(o.join(t,`templates/header-f05d88a8.art`),{featuredImage:a.featuredImage,ledeMediaData:a.ledeMediaData});return c+=a.blocks.map(e=>d(e)).join(`<br><br>`),a.__typename===`StreamResourceType`&&(c+=a.posts.edges.map(({node:e})=>{let n=`<h2><a href="${e.permalink}">${e.promo.headline||e.title}</a></h2>`+i(o.join(t,`templates/header-f05d88a8.art`),{ledeMediaData:e.ledeMediaData});switch(e.__typename){case`PostResourceType`:n+=e.excerpt.map(e=>e.contents.html).join(`<br>`);break;case`QuickPostResourceType`:n+=e.blocks.map(e=>d(e)).join(`<br>`);break;default:break}return n}).join(`<br>`)),e.description=c,e.category=a.categories,e})));return{title:l.title,link:l.link,description:l.description,item:u}}export{u as route};