import{n as e,t}from"./esm-shims-CMsyBHYK.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CRUPiVpr.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-BlqYKpVp.js";import o from"node:path";import{load as s}from"cheerio";e();const c=async e=>{let{column:c}=e.req.param(),l=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):20,u=`https://geekpark.net`,d=`https://mainssl.geekpark.net`,f=new URL(c?`column/${c}`:``,u).href,p=new URL(c?`api/v1/columns/${c}`:`api/v2`,d).href,{data:m}=await a(p),h=(m.homepage_posts??m.column.posts).slice(0,l).map(e=>{e=e.post??e;let n=e.title,a=e.cover_url,s=r(o.join(t,`templates/description-881baa33.art`),{image:a?[{src:a,alt:n}]:void 0,intro:e.abstract}),c=`geekpark-${e.id}`;return{title:n,description:s,pubDate:i(e.published_timestamp,`X`),link:new URL(`api/v1/posts/${e.id}`,d).href,category:[...new Set([...e.tags,e.column?.title])].filter(Boolean),author:e.authors.map(e=>e.realname??e.nickname).join(`/`),guid:c,id:c,content:{html:s,text:e.abstract},image:a,banner:a}});h=await Promise.all(h.map(e=>n.tryGet(e.link,async()=>{let{data:n}=await a(e.link),s=n.post,c=s.title,l=s.cover_url,d=r(o.join(t,`templates/description-881baa33.art`),{image:l?[{src:l,alt:c}]:void 0,intro:s.abstract,description:s.content}),f=`geekpark-${s.id}`;return e.title=c,e.description=d,e.pubDate=i(s.published_timestamp,`X`),e.link=new URL(`news/${s.id}`,u).href,e.category=[...new Set([...s.tags,s.column?.title])].filter(Boolean),e.author=s.authors.map(e=>e.realname??e.nickname).join(`/`),e.guid=f,e.id=f,e.content={html:d,text:s.content},e.image=l,e.banner=l,e.updated=i(s.updated_at),e})));let g={title:``,description:``,link:f,item:h,allowEmpty:!0,image:``,author:``};if(c)g.title=`${m.column.title} | 极客公园`,g.description=m.column.description,g.image=m.column.banner_url;else{let{data:e}=await a(f),t=s(e);g.title=t(`title`).text(),g.description=t(`meta[property="og:description"]`).prop(`content`),g.image=`https:${t(`meta[name="og:image"]`).prop(`content`)}`,g.author=t(`meta[property="og:site_name"]`).prop(`content`)}return g},l={path:`/:column?`,name:`栏目`,url:`geekpark.net`,maintainers:[`nczitzk`],handler:c,example:`/geekpark`,parameters:{column:`栏目 id，默认为空，即首页资讯，可在对应栏目页 URL 中找到`},description:`::: tip
  若订阅 [综合报道](https://www.geekpark.net/column/179)，网址为 \`https://www.geekpark.net/column/179\`。截取 \`https://www.geekpark.net/column/\` 到末尾的部分 \`179\` 作为参数填入，此时路由为 [\`/geekpark/179\`](https://rsshub.app/geekpark/179)。
:::

| 栏目                                                         | ID                                     |
| ------------------------------------------------------------ | -------------------------------------- |
| [综合报道](https://www.geekpark.net/column/179)              | [179](https://rsshub.app/geekpark/179) |
| [AI新浪潮观察](https://www.geekpark.net/column/304)          | [304](https://rsshub.app/geekpark/304) |
| [新造车观察](https://www.geekpark.net/column/305)            | [305](https://rsshub.app/geekpark/305) |
| [财报解读](https://www.geekpark.net/column/271)              | [271](https://rsshub.app/geekpark/271) |
| [底稿对话CEO系列](https://www.geekpark.net/column/308)       | [308](https://rsshub.app/geekpark/308) |
| [Geek Insight 特稿系列](https://www.geekpark.net/column/306) | [306](https://rsshub.app/geekpark/306) |
| [心科技](https://www.geekpark.net/column/307)                | [307](https://rsshub.app/geekpark/307) |
| [行业资讯](https://www.geekpark.net/column/2)                | [2](https://rsshub.app/geekpark/2)     |
  `,categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`geekpark.net`],target:`/`},{source:[`geekpark.net/column/:column?`],target:e=>{let t=e.column;return t?`/${t}`:``}},{title:`综合报道`,source:[`www.geekpark.net/column/179`],target:`/179`},{title:`AI新浪潮观察`,source:[`www.geekpark.net/column/304`],target:`/304`},{title:`新造车观察`,source:[`www.geekpark.net/column/305`],target:`/305`},{title:`财报解读`,source:[`www.geekpark.net/column/271`],target:`/271`},{title:`底稿对话CEO系列`,source:[`www.geekpark.net/column/308`],target:`/308`},{title:`Geek Insight 特稿系列`,source:[`www.geekpark.net/column/306`],target:`/306`},{title:`心科技`,source:[`www.geekpark.net/column/307`],target:`/307`},{title:`行业资讯`,source:[`www.geekpark.net/column/2`],target:`/2`}]};export{c as handler,l as route};