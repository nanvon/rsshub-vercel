import{n as e,t}from"./esm-shims-CMsyBHYK.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CRUPiVpr.js";import"./helpers-Cqaav28H.js";import{t as n}from"./render-d6AVTUl2.js";import{t as r}from"./parse-date-CHEO0z5G.js";import{t as i}from"./got-BlqYKpVp.js";import a from"node:path";import{load as o}from"cheerio";e();const s={path:`/:category?`,radar:[{source:[`xyzrank.com/`],target:``}],name:`Unknown`,maintainers:[],handler:c,url:`xyzrank.com/`};async function c(e){let s=e.req.param(`category`)??``,c=`https://xyzrank.com`,l=`${c}/#/${s}`,u=await i({method:`get`,url:c}),d=o(u.data);u=await i({method:`get`,url:u.data.match(/<script type="module" crossorigin src="(.*?)"><\/script>/)[1]});let f=u.data.match(/pI="(.*?)",gI="(.*?)",mI="(.*?)",_I="(.*?)";var/),p={"":{url:f[3],title:`热门节目`,id:`hot-episodes`,type:`episodes`},"hot-podcasts":{url:f[1],title:`热门播客`,id:`full`,type:`podcasts`},"hot-episodes-new":{url:f[4],title:`新锐节目`,id:`hot-episodes-new`,type:`episodes`},"new-podcasts":{url:f[2],title:`新锐播客`,id:`new-podcasts`,type:`podcasts`}};u=await i({method:`get`,url:p[s].url});let m=p[s].type,h=u.data.data[m].slice(0,e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):250).map((e,i)=>({title:`#${i+1} ${e.title??e.name}`,category:[e.primaryGenreName],author:e.authorsText,link:`${e.link??e.links[0].url}${e.trackCount?`#${e.trackCount}`:``}`,pubDate:r(e.postTime??e.lastReleaseDate),description:n(a.join(t,`templates/description-65025fc9.art`),{logo:e.logoURL,items:m===`podcasts`?{"#":i+1,播客电台:e.name,主持:e.authorsText,分类:e.primaryGenreName,更新频率:`${(e.avgUpdateFreq/24).toFixed(1)}天`,最近更新:`${e.lastReleaseDateDayCount.toFixed(1)}天前`,总集数:e.trackCount,平均时长:`${e.avgDuration}′`,平均播放量:e.avgPlayCount,平均评论量:e.avgCommentCount,千播互动量:(e.avgInteractIndicator*1e3).toFixed(0),平均打开率:`${(e.avgOpenRate*100).toFixed(1)}%`,小宇宙:e.links[0].url,"Apple Podcasts":e.links[1].url,官方网站:e.links[2].url,"RSS 订阅":e.links[3].url}:{"#":i+1,节目标题:e.title,播客电台:e.podcastName,播放量:e.playCount,评论量:e.commentCount,互动率:`${(e.commentCount/e.playCount*100).toFixed(1)}%`,打开率:`${(e.openRate*100).toFixed(1)}%`,时长:`${e.duration}′`,发布时间:e.postTime,分类:e.primaryGenreName,链接:e.link}})}));return{title:`${d(`title`).text()} - ${p[s].title}`,link:l,item:h,description:d(`meta[property="og:description"]`).attr(`content`)}}export{s as route};