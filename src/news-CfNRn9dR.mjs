import{n as e,t}from"./esm-shims-D5mxTuu_.mjs";import"./config-CDM38Tpk.mjs";import"./logger-B0B1yUZ6.mjs";import{t as n}from"./ofetch-FkpIOIxH.mjs";import{t as r}from"./cache-C6z2tE2n.mjs";import{t as i}from"./render-D2i47mnC.mjs";import a from"node:path";import*as o from"cheerio";e();const s=e=>i(a.join(t,`templates/media-554156ec.art`),{video:{cover:e.posterImages?.full?.href||e.posterImages?.default?.href,src:e.links?.source.mezzanine?.href||e.links?.source.HD?.href||e.links?.source.full?.href||e.links?.source.href,title:e.title,description:e.description},image:{src:e.url,alt:e.alt,caption:e.caption,credit:e.credit}}),c=/inline\d+|alsosee/,l=/(photo|video)(\d+)/,u={path:`/news/:sport`,name:`News`,maintainers:[`weijianduan0302`],example:`/espn/news/nba`,categories:[`traditional-media`],parameters:{sport:`sport category, can be nba, nfl, mlb, nhl etc.`},description:`Get the news feed of the sport you love on ESPN.
| Sport                |  sport  |  Sport         |  sport  |
|----------------------|---------|----------------|---------|
| ðŸ€ NBA                | nba     | ðŸŽ¾ Tennis       | tennis  |
| ðŸ€ WNBA               | wnba    | â›³ï¸ Golf         | golf    |
| ðŸˆ NFL                | nfl     | ðŸ Cricket      | cricket |
| âš¾ï¸ MLB                | mlb     | âš½ï¸ Soccer       | soccer  |
| ðŸ’ NHL                | nhl     | ðŸŽï¸ F1           | f1      |
| â›¹ï¸ College Basketball | ncb      | ðŸ¥Š MMA          | mma     |
| ðŸŸï¸ï¸ College Football   | ncf     | ðŸˆ UFL          | ufl     |
| ðŸ‰ Rugby              | rugby   | ðŸƒ Poker        | poker   |`,radar:[{source:[`espn.com/:sport*`],target:`/news/:sport`}],handler:async e=>{let{sport:t=`nba`}=e.req.param(),i=await n(`https://onefeed.fan.api.espn.com/apis/v3/cached/contentEngine/oneFeed/leagues/${t}?offset=0`,{headers:{accept:`application/json`}}),a=new Set([`HeadlineNews`,`Story`,`Media`,`Shortstop`]),u=i.feed.filter(e=>a.has(e.data.now[0].type)).map(e=>{let t=e.data.now[0],n=t.type;return{title:t.headline,link:t.links.web.href,author:t.byline,pubDate:e.date,description:n===`Media`?s(t.video[0]):n===`Shortstop`?t.headline:``}}),d=await Promise.all(u.map(e=>r.tryGet(e.link,async()=>{if(e.description===``){let t=await n(`${e.link}?xhr=1`,{headers:{accept:`application/json`}}),r=o.load(t.content.story,null,!1);r(`*`).each((e,n)=>{if(c.test(n.name)&&r(n).remove(),l.test(n.name)){let e=n.name.match(l)[1]===`photo`?`images`:`video`,i=Number.parseInt(n.name.match(l)[2])-1,a=t.content[e][i];a?r(n).replaceWith(s(a)):r(n).remove()}}),e.description=r.html()}return e})));return{title:`ESPN ${t.toUpperCase()} News`,link:`https://www.espn.com/espn/rss/${t}/news`,item:d}}};export{u as route};