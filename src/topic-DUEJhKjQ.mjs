import{n as e,t}from"./esm-shims-D4LgnpSl.mjs";import"./config-L8Ls2W7q.mjs";import"./logger-C50fTRi5.mjs";import"./ofetch-CvLG4YCQ.mjs";import"./helpers-mo8InLYm.mjs";import{t as n}from"./cache-ZTWfXd2T.mjs";import{t as r}from"./render-CBhnapAf.mjs";import{t as i}from"./parse-date-bKmkZ9gg.mjs";import{t as a}from"./got-AYh7EWi-.mjs";import o from"node:path";import{load as s}from"cheerio";e();const c={path:`/:community/:category?`,categories:[`bbs`],example:`/learnku/laravel/qa`,parameters:{community:`社区 标识，可在 <https://learnku.com/communities> 找到`,category:"分类，如果不传 `category` 则获取全部分类"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`learnku.com/:community`],target:`/:community`}],name:`社区`,maintainers:[`kayw-geek`],handler:l,description:`| 招聘 | 翻译         | 问答 | 链接  |
| ---- | ------------ | ---- | ----- |
| jobs | translations | qa   | links |`};async function l(e){let c=e.req.param(`community`),l=e.req.param(`category`)||``,u=`https://learnku.com/${c}`;l!==``&&(u=`https://learnku.com/${c}/c/${l}`);let d=(await a({method:`get`,url:u})).data,f=s(d),p=f(`.simple-topic`).toArray(),m=await Promise.all(p.map(async e=>{let c=s(e),l=c(`.category-name span`).text().trim();if([`置顶`,`广告`].includes(l))return``;c(`.topic-title i`).remove();let u=c(`.topic-title-wrap`).attr(`href`),d=c(`.topic-title`).text().trim(),f=await n.tryGet(u,async()=>s((await a.get(u)).data)),p=f(`.article-content .content-body`).html(),m=f(`#all-comments`).html();return{title:d,description:r(o.join(t,`templates/topic-17346cca.art`),{article:p,comment:m}),category:l,link:u,pubDate:i(c(`.timeago`).attr(`title`),`YYYY/MM/DD`)}})),h=f(`.sidebar .community-details .header span`).text();f(`.sidebar .community-details .main div div a`).remove();let g=f(`.sidebar .community-details .main div div`).text();return{title:`LearnKu - ${h} - ${new Map([[`translations`,{name:`翻译`}],[`jobs`,{name:`招聘`}],[`qa`,{name:`问答`}],[`links`,{name:`链接`}],[``,{name:`最新`}]]).get(l).name}`,link:u,description:g,item:m.filter(e=>e!==``)}}export{c as route};