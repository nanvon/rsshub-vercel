import{n as e,t}from"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t as n}from"./ofetch-CfXAR0UO.js";import{t as r}from"./cache-CpEhLexq.js";import{t as i}from"./render-d6AVTUl2.js";import{t as a}from"./parse-date-CHEO0z5G.js";import{t as o}from"./timezone-BPfwRbwD.js";import{t as s}from"./types-Bn7An2Wc.js";import c from"node:path";import{load as l}from"cheerio";e();const u=async e=>{let{id:s=`0`}=e.req.param(),u=Number.parseInt(e.req.query(`limit`)??`30`,10),d=`https://www.dgtle.com`,f=new URL(`news`,d).href,p=new URL(`news/getNewsIndexList/${s}`,d).href,m=l(await n(f)),h=m(`html`).attr(`lang`)??`zh-CN`,g=await n(p),_=[];return _=g.data.dataList.slice(0,u).map(e=>{let n=e.title||e.content,r=e.cover,s=i(c.join(t,`templates/description-16be3a2a.art`),{images:r?[{src:r,alt:n}]:void 0,description:e.content}),l=e.created_at,u=`${e.live_status===void 0?`news`:`live`}-${e.id}-1.html`,f=[e.column],p=[{name:e.user?.username,url:new URL(`user?uid=${e.user_id}`,d).href,avatar:e.user?.avatar_path}],m=`dgtle-${e.id}`,g=l;return{title:n,description:s,pubDate:l?o(a(l,`X`),8):void 0,link:new URL(u,d).href,category:f,author:p,guid:m,id:m,content:{html:s,text:s},image:r,banner:r,updated:g?o(a(g,`X`),8):void 0,language:h,live_status:e.live_status}}),_=await Promise.all(_.map(e=>e.live_status!==void 0||!e.link?(delete e.live_status,e):(delete e.live_status,r.tryGet(e.link,async()=>{let r=l(await n(e.link));r(`div.logo`).remove(),r(`p.tip`).remove(),r(`p.dgtle`).remove();let a={description:i(c.join(t,`templates/description-16be3a2a.art`),{description:r(`div.whale_news_detail-daily-content, div#articleContent`).html()}),language:h};return{...e,...a}})))),{title:`${m(`title`).text().trim().split(/\s/)[0]} - ${m(`div.whale_news_index-content-tab li[data_id="${s}"]`).text()}`,description:m(`meta[name="description"]`).attr(`content`),link:f,item:_,allowEmpty:!0,author:m(`meta[name="keywords"]`).attr(`content`)?.split(/,/)[0]??void 0,language:h,id:f}},d={path:`/news/:id?`,name:`鲸闻`,url:`www.dgtle.com`,maintainers:[`nczitzk`],handler:u,example:`/dgtle/news/0`,parameters:{category:{description:"分类，默认为 `0`，即最新，可在下表中找到",options:[{label:`最新`,value:`0`},{label:`直播`,value:`395`},{label:`资讯`,value:`396`},{label:`每日一言`,value:`388`}]}},description:`:::tip
订阅 [最新](https://www.dgtle.com/news)，其对应分类 ID 为 \`0\`，此时路由为 [\`/dgtle/news/0\`](https://rsshub.app/dgtle/news/0)。
:::

| 最新 | 直播 | 资讯 | 每日一言 |
| ---- | ---- | ---- | -------- |
| 0    | 395  | 396  | 388      |
`,categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.dgtle.com/news`],target:`/news`},{title:`最新`,source:[`www.dgtle.com/news`],target:`/news/0`},{title:`直播`,source:[`www.dgtle.com/news`],target:`/news/395`},{title:`资讯`,source:[`www.dgtle.com/news`],target:`/news/396`},{title:`每日一言`,source:[`www.dgtle.com/news`],target:`/news/388`}],view:s.Articles};export{u as handler,d as route};