import"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as e}from"./ofetch-CbgiXYAi.js";import{cache_default as t}from"./cache-Dfid4xgQ.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{timezone as r}from"./timezone-CMz5pnRe.js";import{ViewType as i}from"./types-Bi82qguM.js";import{load as a}from"cheerio";const o=async i=>{let o=Number.parseInt(i.req.query(`limit`)??`30`,10),s=`https://www.stcn.com`,c=new URL(`article/list/kx.html`,s).href,l=new URL(`article/list.html`,s).href,u=await e(c),d=await e(l,{headers:{"x-requested-with":`XMLHttpRequest`},query:{type:`kx`}}),f=a(u),p=f(`html`).attr(`lang`)??`zh-CN`,m=[];return m=d.data.slice(0,o).map(e=>{let t=e.title,r=e.content,i=e.time,a=e.url,o=e.tags?e.tags.map(e=>e.name):[],c=e.source,l=e.share?.image,u=i;return{title:t,description:r,pubDate:i?n(i,`X`):void 0,link:a?new URL(a,s).href:void 0,category:o,author:c,content:{html:r,text:e.content??r},image:l,banner:l,updated:u?n(u,`X`):void 0,language:p}}),m=(await Promise.all(m.map(i=>i.link?t.tryGet(i.link,async()=>{let t=await e(i.link),o=a(t),s=o(`div.detail-title`).text(),c=o(`div.detail-content`).html()??``,l=o(`div.detail-info span`).last().text().trim(),u=[...new Set([...i.category,...o(`meta[name="keywords"]`).attr(`content`)?.split(/,/)??[]])],d=o(`div.detail-info span`).first().text().split(/：/).pop(),f=l,m={title:s,description:c,pubDate:l?r(n(l),8):i.pubDate,category:u,author:d,content:{html:c,text:c},updated:f?r(n(f),8):i.updated,language:p};return{...i,...m}}):i))).filter(e=>!0),{title:f(`title`).text(),description:f(`meta[name="description"]`).attr(`content`),link:c,item:m,allowEmpty:!0,image:f(`img.stcn-logo`).attr(`src`),author:f(`meta[name="keywords"]`).attr(`content`)?.split(/,/)[0],language:p,id:c}},s={path:`/article/list/kx`,name:`快讯`,url:`www.stcn.com`,maintainers:[`nczitzk`],handler:o,example:`/stcn/article/list/kx`,parameters:void 0,description:void 0,categories:[`finance`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.stcn.com/article/list/kx.html`],target:`/article/list/kx`}],view:i.Articles};export{o as handler,s as route};