import{n as e,t}from"./esm-shims-CMsyBHYK.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CRUPiVpr.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-BlqYKpVp.js";import{t as o}from"./timezone-BPfwRbwD.js";import s from"node:path";import{load as c}from"cheerio";e();const l={绵竹市:{rootUrl:`https://www.mz.gov.cn`,infoType:{fdzdnr:{basicUrl:`https://www.mz.gov.cn/info/iList.jsp?node_id=GKmzs&cat_id=15971&cur_page=1`,name:`法定主动内容`},gsgg:{basicUrl:`https://www.mz.gov.cn/info/iList.jsp?node_id=GKmzs&cat_id=24186&cur_page=1`,name:`公示公告`}}}},u=async(e,t)=>{let n=c((await a(t)).data);return n(`.list_div li`).toArray().map(t=>({title:n(`a`,t).attr(`title`),url:`${e}${n(`a`,t).attr(`href`)}`}))},d=(e,t)=>n.tryGet(t.url,async()=>{let n=await a(t.url);try{let r=c(n.data),a=r(`#attribute > span.gk.fj > file`).toArray().map(t=>({name:r(t).text(),url:`${e}/${r(t).attr(`href`)}`})),s=r(`#attribute > span:nth-child(3)`).text().split(`：`)[1].trim();return{title:r(`h1`).text().trim(),id:r(`#attribute > span:nth-child(1)`).text().split(`：`)[1].trim(),infoNum:r(`#attribute > span:nth-child(2)`).text().split(`：`)[1].trim(),pubDate:i(o(s,8)),date:s,keyWord:r(`#attribute > span:nth-child(6)`).text().split(`：`)[1].trim(),source:r(`#attribute > span:nth-child(5)`).text().split(`：`)[1].trim(),content:r(`body > section > article`).html(),file:a,link:t.url,_isCompleteInfo:!0}}catch{return{title:t.title,link:t.url,_isCompleteInfo:!1}}}),f={path:`/sichuan/deyang/govpublicinfo/:countyName/:infoType?`,categories:[`government`],example:`/gov/sichuan/deyang/govpublicinfo/绵竹市`,parameters:{countyName:"区县名（**其他区县整改中，暂时只支持`绵竹市`**）。德阳市、绵竹市、广汉市、什邡市、中江县、罗江区、旌阳区、高新区",infoType:`信息类型。默认值:fdzdnr-“法定主动内容”`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`政府公开信息`,maintainers:[`zytomorrow`],handler:p,description:`| 法定主动内容 | 公示公告 |
| :----------: | :------: |
|    fdzdnr    |   gsgg   |`};async function p(e){let n=e.req.param(`countyName`),i=e.req.param(`infoType`)||`fdzdnr`,a=l[n].infoType[i].basicUrl,o=l[n].rootUrl,c=await u(o,a),f=await Promise.all(c.map(e=>d(o,e)));return{title:`政府公开信息-${n}-${l[n].infoType[i].name}`,link:a,item:f.map(e=>({title:e.title,description:r(s.join(t,`templates/govPublicInfo-dc755dd7.art`),{item:e}),link:e.link,pubDate:e.pubDate}))}}export{f as route};