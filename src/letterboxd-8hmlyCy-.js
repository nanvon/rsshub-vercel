import"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as e}from"./ofetch-DqHh1IN2.js";import{cache_default as t}from"./cache-Dfid4xgQ.js";import{load as n}from"cheerio";const r=`https://${{name:`Letterboxd`,url:`letterboxd.com`,categories:[`social-media`],lang:`en`}.url}`,i={path:`/:username/watchlist`,categories:[`social-media`],example:`/letterboxd/matthew/watchlist`,parameters:{username:`Letterboxd username`},radar:[{source:[`letterboxd.com/:username/watchlist/`]}],name:`User Watchlist`,maintainers:[`johan456789`],handler:a,url:`letterboxd.com`};async function a(i){let{username:a}=i.req.param(),o=`${r}/${a}/watchlist/`,s=await e(o),c=n(s),l=c(`div.react-component[data-component-class*="LazyPoster"]`).toArray(),u=await Promise.all(l.map(async n=>{let i=c(n),a=i.attr(`data-item-link`)||i.attr(`data-target-link`)||``,o=a?new URL(a,r).href:void 0,s=i.attr(`data-item-full-display-name`)||i.attr(`data-item-name`)||``,l;if(o){let n=`${o}poster/std/125/`,r=`letterboxd:poster:${n}`,i=await t.tryGet(r,()=>e(n,{responseType:`json`}));l=i.url2x||i.url}return{title:s,link:o,image:l}}));return{title:c(`title`).text().trim().replaceAll(`‎`,``)||`${a}'s Watchlist • Letterboxd`,link:o,item:u,allowEmpty:!0}}export{i as route};