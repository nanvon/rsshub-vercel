import{__dirname as e,init_esm_shims as t}from"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as n}from"./ofetch-rK3Yp7nj.js";import{cache_default as r}from"./cache-Dfid4xgQ.js";import{art as i}from"./render-DftO2d-b.js";import{parseDate as a}from"./parse-date-DHsdom8D.js";import{ViewType as o}from"./types-Bi82qguM.js";import s from"node:path";import{load as c}from"cheerio";t();const l=async t=>{let o=Number.parseInt(t.req.query(`limit`)??`30`,10),l=`https://mathpix.com`,u=new URL(`blog`,l).href,d=c(await n(u)),f=d(`html`).attr(`lang`)??`en`,p={};d(`div.navbar-menu a.blog-category`).each((e,t)=>{let n=d(t),r=n.attr(`data-category`),i=n.text()?.trim();r&&i&&(p[r]=i)});let m=[];return m=d(`li.articles__item`).slice(0,o).toArray().map(t=>{let n=d(t),r=n.find(`a.articles__title`).text(),o=n.find(`div.articles__image img`).attr(`srcset`)?new URL(n.find(`div.articles__image img`).attr(`srcset`),l).href:void 0,c=i(s.join(e,`templates/description-881baa33.art`),{images:o?[{src:o,alt:r}]:void 0,intro:n.find(`div.articles__text`).text()}),u=n.find(`time.articles__date`).attr(`datetime`),m=n.find(`a.articles__title`).attr(`href`),h=(n.attr(`data-category`)?.split(/,\s/).map(e=>e.trim())??[]).map(e=>p[e]).filter(Boolean),g=u;return{title:r,description:c,pubDate:u?a(u):void 0,link:m?new URL(m,l).href:void 0,category:h,content:{html:c,text:c},image:o,banner:o,updated:g?a(g):void 0,language:f}}),m=await Promise.all(m.map(e=>e.link?r.tryGet(e.link,async()=>{let t=c(await n(e.link)),r=t(`h1.article__title`).text(),i=t(`div#setText`).html(),a={title:r,description:i,content:{html:i,text:i},language:f};return{...e,...a}}):e)),{title:d(`title`).text(),description:d(`meta[property="og:description"]`).attr(`content`),link:u,item:m,allowEmpty:!0,image:d(`meta[property="og:image"]`).attr(`content`),language:f,id:d(`meta[property="og:url"]`).attr(`content`)}},u={path:`/blog`,name:`Blog`,url:`mathpix.com`,maintainers:[`nczitzk`],handler:l,example:`/mathpix/blog`,parameters:void 0,description:void 0,categories:[`blog`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`mathpix.com/blog`],target:`/blog`}],view:o.Articles};export{l as handler,u as route};