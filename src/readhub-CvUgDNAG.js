import{__dirname as e,init_esm_shims as t}from"./esm-shims-rNwigI-Q.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-CeMUzp5K.js";import"./helpers-qpI1t-yV.js";import{cache_default as n}from"./cache-Dfid4xgQ.js";import{art as r}from"./render-DftO2d-b.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import{got_default as a}from"./got-Di2lBekK.js";import{apiTopicUrl as o,processItems as s,rootUrl as c}from"./util-CUvsXcdu.js";import l from"node:path";import{load as u}from"cheerio";t();const d={path:`/:category?`,categories:[`new-media`],example:`/readhub`,parameters:{category:`分类，见下表，默认为热门话题`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`分类`,maintainers:[`WhiteWorld`,`nczitzk`,`Fatpandac`],handler:f,description:`| 热门话题 | 科技动态 | 医疗产业 | 财经快讯           |
| -------- | -------- | -------- | ------------------ |
|          | news     | medical  | financial_express |`};async function f(t){let{category:d=``}=t.req.param(),f=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):30,p=new URL(d??``,c).href,{data:m}=await a(p),{data:h}=await a(o,{searchParams:{type:m.match(/\[\\"type\\",\\"(\d+)\\",\\"d\\"]/)?.[1]??`1`,page:1,size:f}}),g=h.data.items.slice(0,f).map(t=>({title:t.title,link:t.url??new URL(`topic/${t.uid}`,c).href,description:r(l.join(e,`templates/description-71daa88b.art`),{description:t.summary,news:t.newsAggList,timeline:t.timeline}),author:t.siteNameDisplay,category:[...t.entityList.map(e=>e.name)??[],...t.tagList.map(e=>e.name)??[]],guid:t.uid,pubDate:i(t.publishDate)}));g=await s(g,n.tryGet);let _=u(m),v=_(`meta[property="og:site_name"]`).prop(`content`),y=_(`a[data-path="/${d}"]`).text(),b=_(`link[rel="preload"][as="image"]`).prop(`href`),x=_(`meta[property="og:image"]`).prop(`content`);return{item:g,title:`${v} - ${y}`,link:p,description:_(`meta[property="og:description"]`).prop(`content`),language:`zh`,image:b,icon:x,logo:x,subtitle:y,author:v,allowEmpty:!0}}export{d as route};