import{__dirname as e,init_esm_shims as t}from"./esm-shims-B6VgfGYP.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-CHIwZNTj.js";import"./helpers-gUVC02jt.js";import{cache_default as n}from"./cache-Dfid4xgQ.js";import{art as r}from"./render-CSnicFA3.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import{got_default as a}from"./got-BXZNsAGk.js";import{timezone as o}from"./timezone-CMz5pnRe.js";import s from"node:path";import{load as c}from"cheerio";import l from"markdown-it";t();const u=l({html:!0,linkify:!0}),d=(e,t)=>t(e,async()=>{let t=await a({method:`get`,url:e}),n={},r=[],i=t.data;if(i?.result?.boards)for(let e of i.result.boards){let t=e.name;if(n[t]===void 0&&(n[t]=[]),e.schematic?.documents)for(let r of e.schematic.documents)r.thumb&&n[t].push(r.thumb);e.pcb_info?.thumb&&n[t].push(e.pcb_info.thumb),e.pcb_info?.boms?.boms&&r.push(...JSON.parse(e.pcb_info.boms.boms))}return{images:n,boms:r}}),f={path:`/:sortType?`,categories:[`other`],example:`/oshwhub`,parameters:{sortType:`sortType`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`OpenSource Square`,maintainers:[`tylinux`],handler:p};async function p(t){let l=`https://oshwhub.com`,f=t.req.param(`sortType`)??`updatedTime`,p=`${l}/explore?projectSort=${f}`,m=(await a({method:`get`,url:p})).data,h=c(m),g=h(`title`).text(),_=h(`a[class="project-link"]`),v=await Promise.all(_.map((t,f)=>{let p=`${l}${f.attribs.href}`;return n.tryGet(p,async()=>{let t=(await a({method:`get`,url:p})).data,f=c(t),m=f(`div[class="projects-left-top"]`),h=f(m).find(`span[class="title"]`).text(),g=f(m).find(`div[class="member-items"] > ul > li > a > span`).first().text().trim(),_=f(m).find(`div[class="establish-time"] > span`).text(),v=o(i(_.trim().split(`
`)[1].trim(),`YYYY/MM/DD HH:mm:ss`),0),y=f(m).find(`div[class="img-cover"] > img`).attr(`src`)?.trim(),b=f(m).find(`p[class="introduction"]`).text().trim(),x=f(m).find(`div[class*="html-content"]`).attr(`data-markdown`),S=f(`div[class="projects-detail"]`).attr()[`data-uuid`],{images:C,boms:w}=await d(`${l}/api/project/${S}/pro_images`,n.tryGet),T=r(s.join(e,`templates/description-ee8ccf17.art`),{title:h,author:g,publishTime:_,coverImg:y,introduction:b,content:u.render(x)||`No Content`,images:C,boms:w});return{title:h,description:T,pubDate:v,link:p,author:g}})}));return{title:g,link:p,description:g,item:v}}export{f as route};