import{__dirname as e,init_esm_shims as t}from"./esm-shims-BGJi2y--.js";import{config as n}from"./config-CVBRPN4O.js";import{ofetch_default as r}from"./ofetch-rK3Yp7nj.js";import{cache_default as i}from"./cache-Dfid4xgQ.js";import{art as a}from"./render-DftO2d-b.js";import{parseDate as o}from"./parse-date-DHsdom8D.js";import s from"node:path";import{load as c}from"cheerio";t();const l=()=>i.tryGet(`aeon:buildId`,async()=>{let e=c(await r(`https://aeon.co`));return JSON.parse(e(`script#__NEXT_DATA__`).text()).buildId},n.cache.routeExpire,!1),u=async t=>await Promise.all(t.map(t=>i.tryGet(t.link,async()=>{let n=(await r(`https://aeon.co/_next/data/${await l()}/${t.type}s/${t.slug}.json?id=${t.slug}`)).pageProps.article,i=n.type.toLowerCase();if(t.pubDate=o(n.publishedAt),i===`video`)t.description=a(s.join(e,`templates/video-f69decfd.art`),{article:n});else{if(n.audio?.id){let e=await r(`https://api.aeonmedia.co/graphql`,{method:`POST`,body:{query:`query getAudio($audioId: ID!) {
                                    audio(id: $audioId) {
                                        id
                                        streamUrl
                                    }
                                }`,variables:{audioId:n.audio.id},operationName:`getAudio`}});delete t.image,t.enclosure_url=e.data.audio.streamUrl,t.enclosure_type=`audio/mpeg`}let i=c(n.body,null,!1),o=n.image;i(`p.pullquote`).remove();let l=n.authors.map(e=>`<p>`+e.name+e.authorBio.replaceAll(/^<p>/g,` `)).join(``);t.description=a(s.join(e,`templates/essay-deb2bd55.art`),{banner:o,authorsBio:l,content:i.html()})}return t})));export{l as getBuildId,u as getData};