import{n as e,t}from"./esm-shims-BKVRry6h.mjs";import{t as n}from"./ofetch-BRplXtiZ.mjs";import"./config-D7dgKYF5.mjs";import"./logger-CkUWGGaS.mjs";import{t as r}from"./cache-Bv3_kFbE.mjs";import{t as i}from"./parse-date-_GmTZfjS.mjs";import{t as a}from"./render-CSqLtqb8.mjs";import{t as o}from"./types-CaC5w-Pp.mjs";import s from"node:path";import{load as c}from"cheerio";e();const l=async e=>{let{category:o=`produce/fresh-fruits/apples`}=e.req.param(),l=Number.parseInt(e.req.query(`limit`)??`10`,10),u=`https://www.producereport.com`,d=new URL(o,u).href,f=c(await n(d)),p=f(`html`).attr(`lang`)??`en`,m=[];return m=f(`table.views-table tbody tr`).slice(0,l).toArray().map(e=>{let n=f(e),r=n.find(`a`).first(),o=r.text(),c=n.find(`td.views-field-field-image a img`).attr(`src`)?.replace(/styles\/thumbnail\/public/,``)?.split(/\?/)?.[0],l=a(s.join(t,`templates/description-881baa33.art`),{images:c?[{src:c,alt:o}]:void 0,intro:r.parent().contents().last().text().trim()}),d=n.find(`td.views-field-created`).contents().first().text()?.trim(),m=r.attr(`href`),h=d;return{title:o,description:l,pubDate:d?i(d):void 0,link:m?new URL(m,u).href:void 0,content:{html:l,text:l},image:c,banner:c,updated:h?i(h):void 0,language:p}}),m=await Promise.all(m.map(e=>e.link?r.tryGet(e.link,async()=>{let r=c(await n(e.link)),o=r(`meta[property="og:title"]`).attr(`content`)??e.title,l=r(`meta[property="og:image"]`).attr(`content`),d=a(s.join(t,`templates/description-881baa33.art`),{images:l?[{src:l,alt:o}]:void 0,description:r(`div[property="content:encoded"]`).html()}),f=r(`div.pane-node-created`).text()?.trim(),m=r(`div.pane-node-field-topics a`).toArray(),h=[...new Set(m.map(e=>r(e).text()).filter(Boolean))],g=r(`div.pane-node-author a.username`).toArray().map(e=>{let t=r(e);return{name:t.text(),url:t.attr(`href`)?new URL(t.attr(`href`),u).href:void 0,avatar:void 0}}),_=f,v={title:o,description:d,pubDate:f?i(f):e.pubDate,category:h,author:g,content:{html:d,text:d},image:l,banner:l,updated:_?i(_):e.updated,language:p};return{...e,...v}}):e)),{title:f(`title`).text(),description:f(`meta[property="og:title"]`).attr(`content`),link:d,item:m,allowEmpty:!0,image:f(`meta[property="og:image"]`).attr(`content`),author:f(`meta[property="og:site_name"]`).attr(`content`),language:p,id:f(`meta[property="og:url"]`).attr(`content`)}},u={path:`/:category{.+}?`,name:`Category`,url:`www.producereport.com`,maintainers:[`nczitzk`],handler:l,example:`/producereport/produce/fresh-fruits/apples`,parameters:{category:{description:"Category, `Fresh Fruits - Apple` by default"}},description:":::tip\nTo subscribe to [Apples](https://www.producereport.com/produce/fresh-fruits/apples), where the source URL is `https://www.producereport.com/produce/fresh-fruits/apples`, extract the certain parts from this URL to be used as parameters, resulting in the route as [`/producereport/produce/fresh-fruits/apples`](https://rsshub.app/producereport/produce/fresh-fruits/apples).\n:::\n",categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.producereport.com/:category`],target:`/:category`}],view:o.Articles};export{l as handler,u as route};