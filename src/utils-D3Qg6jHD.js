import{cache_default as e}from"./cache-Dfid4xgQ.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{md5 as n}from"./md5-15Cn4YyR.js";import{got_default as r}from"./got-DPq_2TLS.js";import{load as i}from"cheerio";const a={0:`基本动态`,8:`酷图`,9:`评论`,10:`提问`,11:`回答`,12:`图文`,15:`二手`,17:`观点`,20:`交易动态`},o=()=>{let e=[10,6,6,6,14];return e=e.map(e=>Math.random().toString(36).substring(2,e)),e.join(`-`)},s=()=>{let e=o(),t=Math.round(Date.now()/1e3),r=`0x`+t.toString(16),i=`token://com.coolapk.market/c67ef5943784d09750dcfbb31020f0ab?`+n(t.toString())+`$`+e+`&com.coolapk.market`;return n(Buffer.from(i).toString(`base64`))+e+r},c=()=>({"X-Requested-With":`XMLHttpRequest`,"X-App-Id":`com.coolapk.market`,"X-App-Token":s(),"X-Sdk-Int":`29`,"X-Sdk-Locale":`zh-CN`,"X-App-Version":`11.0`,"X-Api-Version":`11`,"X-App-Code":`2101202`,"User-Agent":`Dalvik/2.1.0 (Linux; U; Android 10; Redmi K30 5G MIUI/V12.0.3.0.QGICMXM) (#Build; Redmi; Redmi K30 5G; QKQ1.191222.002 test-keys; 10) +CoolMarket/11.0-2101202`}),l=e=>e.map(e=>e.type===`text`?e.message.split(`
`).filter(e=>e!==``).map(e=>`<p>${e}</p>`).join(``):e.type===`image`?`<div class="img-container" style="text-align: center;">
                <img src="${e.url}">
                <p class="image-caption" style="text-align: center;">${e.description}</p></div>`:`Unkown type`);var u={get_app_token:s,base_url:`https://api.coolapk.com`,getHeaders:c,parseDynamic:async n=>{let a=t(n.dateline,`X`);if(n.entityType===`sponsorCard`||!n.url)return;let o=`https://api2.coolapk.com/v6${n.url.replace(`/feed/`,`/feed/detail?id=`)}`,s,u,d=Number.parseInt(n.type);switch(d){case 0:case 5:case 7:case 8:case 9:case 10:case 11:case 13:case 15:case 17:case 20:if(n.issummary)s=await e.tryGet(o,async()=>{let e=`<p>`+(await r(o,{headers:c()})).data.data?.message.split(`
`).join(`<br>`)+`</p>`,t=n.picArr.filter(Boolean).map(e=>`<img src="${e}">`);return e+t.join(``)});else{let e=n.picArr.filter(Boolean).map(e=>`<img src="${e}">`);s=`<p>`+n.message+`</p>`+e.join(``)}if(u=i(`<div class="title-filter">`+s+`</div>`)(`.title-filter`).text().trim(),d===17){let e=n.extra_key.split(`,`);s+=`<p>`+n.vote.message_title+` 已选${e.length}项</p>`;for(let t of n.vote.options)e.includes(String(t.id))&&(s+=`<p>${t.title}√</p>`)}else (d===10||d===11)&&(u=`${n.message_title} 更多:`+u);break;case 12:u=n.title,s=await e.tryGet(o,async()=>{let e=await r(o,{headers:c()}),t=JSON.parse(e.data.data.message_raw_output),n=l(t);return`<img src="${e.data.data.pic}"><hr>`+n.join(``)});break;default:break}return{title:u,description:s,pubDate:a,link:`https://www.coolapk.com${n.url}`,author:n.username}},dynamicTpye:a};export{u as utils_default};