import{ofetch_default as e}from"./ofetch-am9EnuPq.js";import{cache_default as t}from"./cache-Dfid4xgQ.js";import{load as n}from"cheerio";const r=`https://www.capitalmind.in`;async function i(i){let a=`${r}/${i}/page/1`,o=await e(a),s=n(o),c=s(`.article-wrapper a.article-card-wrapper`).toArray().map(async i=>{let a=s(i),o=r+a.attr(`href`);return await t.tryGet(o,async()=>{let t=a.find(`h3`).text().trim(),i=a.find(String.raw`div.text-[16px]`).text().trim(),s=a.find(`img`).attr(`src`),c=s?.startsWith(`/_next/image`)?s.split(`url=`)[1].split(`&`)[0]:s,l=c?decodeURIComponent(c):``,u=await e(o),d=n(u),f=d(`article`).clone(),p=f.find(`footer div`).toArray().map(e=>{let t=d(e);return t.find(`.sr-only`).remove(),t.text().trim()}).filter(Boolean),m=``,h=f.find(`header`).find(`time`);h.length&&(m=h.attr(`datetime`)||h.text().trim());let g=f.find(`section[aria-label="Post content"]`).clone();g.find(`footer`).remove();let _={},v=g.find(`iframe[src*="libsyn.com/embed/episode/id/"]`);if(v.length){let t=v.attr(`src`);if(t){let n=t.match(/\/id\/(\d+)\//);if(n&&n[1]){let t=n[1];try{let n=await e(`https://html5-player.libsyn.com/api/episode/id/${t}`);n&&n._item&&n._item._primary_content&&(_={mediaUrl:n._item._primary_content._download_url,image:`https://assets.libsyn.com/item/${t}`,itunes_duration:n._item._primary_content.duration})}catch{logger.info(`Failed to fetch podcast data for episode ID ${t}`)}}}}return g.find(`figure img`).each((e,t)=>{let n=d(t),i=n.attr(`src`);if(n.removeAttr(`srcset`),i&&i.startsWith(`/_next/image`)){let e=i.match(/url=([^&]+)/);if(e&&e[1]){let t=decodeURIComponent(e[1]);n.attr(`src`,t)}else i.startsWith(`/`)&&n.attr(`src`,r+i)}}),{title:t,link:o,author:i,description:g.html()||`<p><img src="${l}" alt="${t}"></p><p>Author: ${i}</p>`,guid:o,itunes_item_image:_?.image||l,category:p,pubDate:m,enclosure_url:_?.mediaUrl||null,itunes_duration:_?.itunes_duration||null,enclosure_type:_?.mediaUrl?`audio/mpeg`:null}})});return Promise.all(c)}export{r as baseUrl,i as fetchArticles};