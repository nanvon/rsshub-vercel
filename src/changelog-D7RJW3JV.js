import{ofetch_default as e}from"./ofetch-B4O0sZDE.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{X_UA as n,appDetail as r,getRootUrl as i}from"./utils-Bjv03Mss.js";async function a(a){let o=a.req.path.replace(`/taptap`,``),s=o.startsWith(`/intl/`),c=a.req.param(`id`),l=a.req.param(`lang`)??(s?`en_US`:`zh_CN`),u=`${i(s)}/app/${c}`,d=await r(c,l,s),f=d.app.icon.original_url,p=d.app.title,m=`${p}${d.app.developers?` by`+d.app.developers.map(e=>e.name).join(` & `):``}`,h=await e(`${i(s)}/webapiv2/apk/v1/list-by-app?app_id=${c}&from=0&limit=10&${n(l)}`,{headers:{Referer:u}}),g=h.data.list;return{title:`TapTap 更新记录 ${p}`,description:m,link:u,image:f,item:g.map(e=>({title:`${p} / ${e.version_label}`,description:e.whatsnew.text,pubDate:t(e.update_date,`X`),link:u,guid:e.version_label}))}}export{a as handler};