import{n as e,t}from"./esm-shims-mGm6WwCc.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-BASlBuka.js";import"./helpers-Cqaav28H.js";import{t as n}from"./render-d6AVTUl2.js";import{t as r}from"./parse-date-CHEO0z5G.js";import{t as i}from"./got-CgQXMNWI.js";import{t as a}from"./timezone-BPfwRbwD.js";import o from"node:path";import{load as s}from"cheerio";import c from"markdown-it";e();const l=c({html:!0}),u={1:0,2:2,3:1},d={path:[`/exclusive/:locale?`,`/news/:locale?`,`/:locale?`,`/:type/:id/:locale?`],categories:[`new-media`],example:`/farmatters/exclusive`,parameters:{locale:"Locale, `zh-CN` or `en-US`, `zh-CN` by default"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`farmatters.com/exclusive`],target:`/exclusive`}],name:`Exclusive`,maintainers:[`nczitzk`],handler:f,url:`farmatters.com/news`};async function f(e){let{type:c,id:d,locale:f=`zh-CN`}=e.req.param(),p=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):50,m={locale:f,page:0,pagesize:p};c===`wiki`&&d?m.subCatalogId=d:c&&d&&(m[c]=d);let h=`https://farmatters.com`,g=new URL(`api/v1/doc/list`,h).href,_=new URL(`${f===`zh-CN`?``:`en/`}${c?c===`wiki`?`wiki`:`tag/${d}`:`news`}`,h).href,{data:v}=await i(g,{searchParams:m,https:{rejectUnauthorized:!1}}),y=v.data.list.slice(0,p).map(e=>({title:e.title,link:new URL(`doc/${e.id}`,h).href,description:n(o.join(t,`templates/description-dcf20f08.art`),{image:e.headImageUrl?{src:e.headImageUrl,alt:e.title}:void 0,description:l.render(e.content??e.summary)}),author:e.author,category:[e.catalogName,e.subCatalogName??void 0,...e.tags?.map(e=>e.tagName)??[]].filter(Boolean),guid:`farmatters-${e.id}`,pubDate:a(r(e.createdAt),8)})),{data:b}=await i(_,{https:{rejectUnauthorized:!1}}),x=s(b),S=`${x(`h4`).first().text()}${c===`wiki`?` - ${x(`div.css-6f6728 div.MuiBox-root`).eq(u[d]).text()}`:``}`,C=new URL(`favicon.ico`,h).href;return{item:y,title:`${x(`title`).text().split(/-/)[0].trim()} - ${S}`,link:_,description:x(`meta[name="description"]`).prop(`content`),language:x(`html`).prop(`lang`),image:new URL(x(`img`).first().prop(`src`),h).href,icon:C,logo:C,subtitle:S,allowEmpty:!0}}export{d as route};