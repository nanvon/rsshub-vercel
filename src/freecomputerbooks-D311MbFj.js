import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-1ATZGjxb.js";import"./logger-B19BYg4C.js";import"./ofetch-B4O0sZDE.js";import"./helpers-LVq640iW.js";import{cache_default as n}from"./cache-CjzVN0X7.js";import{art as r}from"./render-DE4LRFBD.js";import{got_default as i}from"./got-CW2W8CRN.js";import a from"node:path";import{load as o}from"cheerio";t();const s=`https://freecomputerbooks.com/`;async function c(e){return o((await i(e)).data)}const l={path:`/:category?`,name:`Book List`,url:new URL(s).host,maintainers:[`cubroe`],handler:u,example:`/freecomputerbooks/compscAlgorithmBooks`,parameters:{category:"A category id., which should be the HTML file name (but **without** the `.html` suffix) in the URL path of a book list page."},categories:[`reading`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`freecomputerbooks.com/`,`freecomputerbooks.com/index.html`],target:``}]};async function u(e){let t=e.req.param(`category`)?.trim(),r=t?new URL(`${t}.html`,s).href:s,i=await c(r),a=i(`.maintitlebar`).text();return{title:`Free Computer Books - `+a,link:r,description:i(`title`).text(),item:await Promise.all(i(`ul[id^=newBooks] > li`).toArray().map(e=>d(i(e),a,n)))}}function d(e,t,n){let r=o(``),i=e.find(`a:first`),a=e.find(`p:contains("Post under")`),c={title:i.text(),link:new URL(i.attr(`href`),s).href,category:a.length?a.find(`a`).toArray().map(e=>r(e).text()):t};return n.tryGet(c.link,()=>f(c))}async function f(t){let n=await c(t.link);n.root().find(`*`).contents().filter((e,t)=>t.type===`comment`).remove();let i=n(`#bookdesc img[title]`).attr(`src`),o=n(`#booktitle ul`).removeAttr(`style`),s=n(`#bookdesccontent`).removeAttr(`id`);return o.find(`li:contains(Share This)`).remove(),s.find(`img[src$="/hot.gif"]`).remove(),s.find(`:contains(Similar Books)`).nextAll().addBack().remove(),t.description=r(a.join(e,`templates/desc-dc50e91a.art`),{imageURL:i,metadata:o,content:s}),t}export{l as route};