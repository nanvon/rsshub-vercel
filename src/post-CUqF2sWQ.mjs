import{n as e,t}from"./esm-shims-D5mxTuu_.mjs";import"./config-CDM38Tpk.mjs";import"./logger-B0B1yUZ6.mjs";import"./ofetch-FkpIOIxH.mjs";import"./helpers-CMl_ndRq.mjs";import{t as n}from"./cache-C6z2tE2n.mjs";import{t as r}from"./render-D2i47mnC.mjs";import{t as i}from"./parse-date-Cv8vEJfE.mjs";import{t as a}from"./got-CxBlPaz_.mjs";import{n as o,t as s}from"./utils-C8OP1arQ.mjs";import c from"node:path";import l from"dayjs";e();const u={path:`/posts/:author`,categories:[`new-media`],example:`/zhiy/posts/long`,parameters:{author:`作者 ID，可在URL中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`zhiy.cc/:author`]}],name:`笔记`,maintainers:[`TonyRL`],handler:d};async function d(e){r.defaults.imports={dayjs:l,...r.defaults.imports};let u=e.req.param(`author`),{author_id:d,author_name:f,author_signature:p,author_avatar_url:m}=await o(u),{data:{result:h}}=await a(`${s}/api/app/share/garden/users/${d}/posts`,{searchParams:{page:1,limit:e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):100}}),g=h.map(e=>({title:e.title,pubDate:i(e.create_time,`X`),link:`${s}/b${e.share_md5}`,guid:`${s}/b${e.share_md5}:${e.link_amount}:${e.note_amount}`,postId:e.id,shareMD5:e.share_md5})),_=await Promise.all(g.map(e=>n.tryGet(e.link,async()=>{let{data:n}=await a(`${s}/api/app/share/posts/${e.shareMD5}`),{data:{result:i}}=await a(`${s}/api/app/share/posts/${e.postId}/notes`,{searchParams:{page:1,limit:100}});return e.description=r(c.join(t,`templates/post-2ebad52a.art`),{postMeta:n,postDate:l(n.create_time,`X`).format(`YYYY-MM-DD HH:mm:ss`),posts:i}),e})));return{title:f,link:`${s}/${u}`,description:p,image:m,item:_}}export{u as route};