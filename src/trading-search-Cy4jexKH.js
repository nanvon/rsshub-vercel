import"./esm-shims-rNwigI-Q.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as e}from"./ofetch-CeMUzp5K.js";import"./cache-Dfid4xgQ.js";import"./render-DftO2d-b.js";import"./parse-date-DHsdom8D.js";import{baseUrl as t,parseTradeItem as n}from"./utils-BY_FCsO4.js";import{load as r}from"cheerio";const i={path:`/trading/search/:keyword/:mainCat?`,categories:[`new-media`],example:`/dcfever/trading/search/Sony`,parameters:{keyword:`關鍵字`,mainCat:`主要分類 ID，見上表`},name:`二手市集 - 物品搜尋`,maintainers:[`TonyRL`],handler:a};async function a(i){let{keyword:a,mainCat:o}=i.req.param(),s=new URL(`${t}/trading/search.php`,t);s.searchParams.append(`keyword`,a),s.searchParams.append(`type`,`all`),o&&s.searchParams.append(`main_cat`,o),s.searchParams.append(`form_action`,`search_action`);let c=r(await e(s.href)),l=c(`.item_list li a`).toArray().map(e=>(e=c(e),e.find(`.optional`).remove(),{title:e.find(`.trade_title`).text(),link:new URL(e.attr(`href`),s.href).href,author:e.find(`.trade_info`).text()})),u=await Promise.all(l.map(e=>n(e)));return{title:c(`head title`).text(),link:s.href,image:`https://cdn10.dcfever.com/images/android_192.png`,item:u}}export{i as route};