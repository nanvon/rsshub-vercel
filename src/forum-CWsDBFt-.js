import"./esm-shims-2LyWUseo.js";import{config as e}from"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-BLnIkXRv.js";import"./helpers-gUVC02jt.js";import{cache_default as t}from"./cache-Dfid4xgQ.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{got_default as r}from"./got-DPq_2TLS.js";import{ViewType as i}from"./types-Bi82qguM.js";const a=`NGA_skull/6.0.5(iPhone10,3;iOS 12.0.1)`,o={path:`/forum/:fid/:recommend?`,categories:[`bbs`],view:i.Articles,example:`/nga/forum/489`,parameters:{fid:`分区 id, 可在分区主页 URL 找到, 没有 fid 时 stid 同样适用`,recommend:`是否只显示精华主题, 留空为否, 任意值为是`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`分区帖子`,maintainers:[`xyqfer`],handler:s};async function s(i){let{fid:o,recommend:s}=i.req.param(),c=`guestJs=${Math.floor(Date.now()/1e3)};`;e.nga.uid&&e.nga.cid&&(c=`ngaPassportUid=${e.nga.uid}; ngaPassportCid=${e.nga.cid};`);let l=e=>e.replaceAll(/\[img](.+?)\[\/img]/g,(e,t)=>`<img src="${t.replaceAll(/\?.*/g,``)}" />`).replaceAll(/\[url](.+?)\[\/url]/g,`<a href="$1">$1</a>`),u=await r.post(`https://ngabbs.com/app_api.php?__lib=subject&__act=list`,{headers:{"X-User-Agent":a,Cookie:c},form:{fid:o,recommend:s?1:0}}),d=u.data.forumname,f=u.data.result.data.filter(({tid:e})=>e),p=await Promise.all(f.map(async({subject:e,postdate:i,tid:o})=>{let s=`https://nga.178.com/read.php?tid=${o}`,u={title:e,description:``,link:s,pubDate:n(i,`X`)};return u.description=await t.tryGet(`nga-forum: ${s}`,async()=>{let e=await r.post(`https://ngabbs.com/app_api.php?__lib=post&__act=list`,{headers:{"X-User-Agent":a,Cookie:c},form:{tid:o}});return e.data.code===0?l(e.data.result[0].content):e.data.msg}),u}));return{title:`NGA-${d}${s?`-精华`:``}`,link:`https://nga.178.com/thread.php?fid=${o}`,description:`NGA是国内专业的游戏玩家社区,魔兽世界,英雄联盟,炉石传说,风暴英雄,暗黑破坏神3(D3)游戏攻略讨论,以及其他热门游戏玩家社区`,item:p}}export{o as route};