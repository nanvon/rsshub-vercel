import"./esm-shims-BmHUa0Yk.js";import{config as e}from"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-DCfHHxuQ.js";import"./helpers-gUVC02jt.js";import{cache_default as t}from"./cache-Dfid4xgQ.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./got-D5TEN1xL.js";import{config_not_found_default as r}from"./config-not-found-mNOcOzCd.js";import{getToken as i,maskHeader as a,pixiv_got_default as o,utils_default as s}from"./utils-CsP3mfey.js";import c from"query-string";function l(e){return o(`https://app-api.pixiv.net/v2/illust/follow`,{headers:{...a,Authorization:`Bearer `+e},searchParams:c.stringify({restrict:`public`})})}const u={path:`/user/illustfollows`,categories:[`social-media`],example:`/pixiv/user/illustfollows`,parameters:{},features:{requireConfig:[{name:`PIXIV_REFRESHTOKEN`,description:``}],requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.pixiv.net/bookmark_new_illust.php`]}],name:`Following timeline`,maintainers:[`ClarkeCheng`],handler:d,url:`www.pixiv.net/bookmark_new_illust.php`,description:`::: warning
  Only for self-hosted
:::`};async function d(){if(!e.pixiv||!e.pixiv.refreshToken)throw new r(`pixiv RSS is disabled due to the lack of <a href="https://docs.rsshub.app/deploy/config#route-specific-configurations">relevant config</a>`);let a=await i(t.tryGet);if(!a)throw new r(`pixiv not login`);return{title:`Pixiv关注的新作品`,link:`https://www.pixiv.net/bookmark_new_illust.php`,description:`Pixiv关注的画师们的最新作品`,item:(await l(a)).data.illusts.map(e=>{let t=s.getImgs(e);return{title:e.title,author:e.user.name,pubDate:n(e.create_date),description:`${e.caption}<br><p>画师：${e.user.name} - 阅览数：${e.total_view} - 收藏数：${e.total_bookmarks}</p>${t.join(``)}`,link:`https://www.pixiv.net/artworks/${e.id}`,category:e.tags.map(e=>e.name)}})}}export{u as route};