import"./esm-shims-L08rKynx.mjs";import"./config-Bs8nOQqi.mjs";import"./logger-BvLYiR5T.mjs";import"./proxy-CS9WS3LB.mjs";import{t as e}from"./ofetch-1TBKTiHL.mjs";import{t}from"./cache-BDs-9Wd7.mjs";import{n}from"./parse-date-bKmkZ9gg.mjs";import{t as r}from"./types-BD1MU_-b.mjs";import{t as i}from"./puppeteer-BtFhUOxK.mjs";import{load as a}from"cheerio";import o from"sanitize-html";const s=async e=>{let t,{destory:n}=await i(e,{onBeforeLoad:async e=>{await e.setRequestInterception(!0),e.on(`request`,e=>{e.resourceType()===`document`?e.continue():e.abort()}),e.on(`response`,async e=>{t=await(e.request().url().includes(`/api/posts`)?e.json():e.text())})}});return await n(),t},c={path:`/user/:id/:type?`,categories:[`social-media`],example:`/picnob/user/xlisa_olivex`,parameters:{id:`Instagram id`,type:`Type of profile page (profile or tagged)`},features:{requireConfig:!1,requirePuppeteer:!0,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.pixnoy.com/profile/:id`],target:`/user/:id`},{source:[`www.pixnoy.com/profile/:id/tagged`],target:`/user/:id/tagged`}],name:`User Profile - Picnob`,maintainers:[`TonyRL`,`micheal-death`,`AiraNadih`,`DIYgod`],handler:l,view:r.Pictures};async function l(r){let i=`https://www.pixnoy.com`,c=r.req.param(`id`),l=r.req.param(`type`)??`profile`,u=`${i}/profile/${c}/${l===`tagged`?`tagged/`:``}`,d,f=!1;try{d=await e(u)}catch{d=await s(u),f=!0}let p=a(d),m=p(`.post_box`).toArray().map(e=>{let t=p(e),r=t.find(`.sum`).text(),a=t.find(`.cover_link`).attr(`href`),s=a?.split(`/`)?.[2];return{title:o(r.split(`
`)[0],{allowedTags:[],allowedAttributes:{}}),description:`<img src="${t.find(`.preview_w img`).attr(`data-src`)}" /><br />${r.replaceAll(`
`,`<br>`)}`,link:`${i}${a}`,guid:s,pubDate:n(t.find(`.time .txt`).text())}}),h=await Promise.all(m.map(n=>t.tryGet(`picnob:user:${c}:${n.guid}`,async()=>{try{let t=a(f?await s(n.link):await e(n.link,{headers:{"user-agent":`PostmanRuntime/7.44.0`}}));if(t(`.video_img`).length>0)return`<video src="${t(`.video_img a`).attr(`href`)}" poster="${t(`.video_img img`).attr(`data-src`)}"></video><br />${t(`.sum_full`).text()}`;{let e=``;for(let n of t(`.swiper-slide`).toArray()){let r=t(n);e+=`<img src="${r.find(`.pic img`).attr(`data-src`)}" /><br />`}return e+=t(`.sum_full`).text(),e}}catch{return``}})));return{title:`${p(`h1.fullname`).text()} (@${c}) ${l===`tagged`?`tagged`:`public`} posts - Picnob`,description:p(`.info .sum`).text(),link:u,image:p(`.ava .pic img`).attr(`src`),item:m.map((e,t)=>({...e,description:h[t]||e.description}))}}export{c as route};