import{__dirname as e,init_esm_shims as t}from"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import{logger_default as n}from"./logger-BvonkID1.js";import"./ofetch-rK3Yp7nj.js";import"./helpers-gUVC02jt.js";import{cache_default as r}from"./cache-Dfid4xgQ.js";import{art as i}from"./render-DftO2d-b.js";import{parseDate as a}from"./parse-date-DHsdom8D.js";import{got_default as o}from"./got-Bnno2HfO.js";import s from"node:path";t();const c={1:`崩坏三`,2:`原神`,3:`崩坏二`,4:`未定事件簿`,6:`崩坏：星穹铁道`,8:`绝区零`},l={1:`公告`,2:`活动`,3:`资讯`},u={1:`bh3`,2:`ys`,3:`bh2`,4:`wd`,6:`sr`,8:`zzz`},d={1:`6`,2:`28`,3:`31`,4:`33`,6:`53`,8:`58`};var f=class extends Error{constructor(e){super(e),this.name=`MiHoYoOfficialError`}};const p=async({gids:e,type:t,page_size:n,last_id:r})=>(await o({method:`get`,url:`https://bbs-api-static.miyoushe.com/painter/wapi/getNewsList?${new URLSearchParams({client_type:`4`,gids:e,type:t,page_size:n,last_id:r}).toString()}`}))?.data?.data?.list,m=async(t,n=`2`)=>{let c=t.post,l=c.post_id,d=`https://bbs-api.miyoushe.com/post/wapi/getPostFull?${new URLSearchParams({post_id:l}).toString()}`;return await r.tryGet(d,async()=>{let r=await o(d),p=r?.data?.data?.post;if(!p)throw new f(`mihoyo/bbs/official: getPostContent failed: ${d} - ${JSON.stringify(r)}`);let m=p?.post?.game_id||n,h=p?.user?.nickname||``,g=p?.post?.content||``,_=p?.topics?.map(e=>e.name)||[],v=i(s.join(e,`templates/official-b135d099.art`),{hasCover:c.has_cover,coverList:t.cover_list,content:g});return{title:c.subject,link:`https://www.miyoushe.com/${u[m]}/article/${l}`,description:v,pubDate:a(c.created_at*1e3),category:_,author:h}})},h=(e,t=`2`)=>Promise.all(e.map(e=>m(e,t).catch(e=>{if(e instanceof f)return n.error(e.message),null;throw e}))).then(e=>e.filter(Boolean)),g={path:`/bbs/official/:gids/:type?/:page_size?/:last_id?`,categories:[`game`],example:`/mihoyo/bbs/official/2/3/20/`,parameters:{gids:`游戏id`,type:`公告类型，默认为 2(即 活动)`,page_size:`分页大小，默认为 20 `,last_id:`跳过的公告数，例如指定为 40 就是从第 40 条公告开始，可用于分页`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`米游社 - 官方公告`,maintainers:[`CaoMeiYouRen`],handler:_,description:`游戏 id

| 崩坏三 | 原神 | 崩坏二 | 未定事件簿 | 星穹铁道 | 绝区零 |
| ------ | ---- | ------ | ---------- | -------- | ------ |
| 1      | 2    | 3      | 4          | 6        | 8      |

  公告类型

| 公告 | 活动 | 资讯 |
| ---- | ---- | ---- |
| 1    | 2    | 3    |`};async function _(e){let{gids:t,type:n=`2`,page_size:r=`20`,last_id:i=``}=e.req.param(),a=await h(await p({gids:t,type:n,page_size:r,last_id:i}),t);return{title:`米游社 - ${c[t]||``} - ${l[n]||``}`,link:`https://www.miyoushe.com/${u[t]}/home/${d[t]}?type=${n}`,item:a}}export{g as route};