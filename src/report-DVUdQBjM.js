import{n as e,t}from"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CfXAR0UO.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-dCh-Ojgc.js";import{t as o}from"./timezone-BPfwRbwD.js";import s from"node:path";import{load as c}from"cheerio";e();const l={path:[`/lc_report/:id?`,`/report/:id?`],categories:[`new-media`],example:`/logclub/lc_report`,parameters:{id:`报告 id，见下表，默认为罗戈研究出品`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`报告`,maintainers:[`nczitzk`],handler:u,description:`| 罗戈研究出品 | 物流报告       | 绿色双碳报告          |
| ------------ | -------------- | --------------------- |
| Report       | IndustryReport | GreenDualCarbonReport |`};async function u(e){let{id:l=`Report`}=e.req.param(),u=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):11,d=`https://www.logclub.com`,f=new URL(`lc_report`,d).href,p=new URL(`front/lc_report/load${l}List`,d).href,{data:m}=await a.post(p,{json:{page:1}}),h=m.list.slice(0,u).map(e=>({title:e.title,link:new URL(`front/lc_report/get_report_info/${e.id}`,d).href,description:r(s.join(t,`templates/description-b417c82f.art`),{image:{src:e.img_url?.split(/\?/)[0]??void 0,alt:e.title}}),author:e.author,category:[e.channel_name],guid:`logclub-report-${e.id}`,pubDate:o(i(e.release_time),8)}));h=await Promise.all(h.map(e=>n.tryGet(e.link,async()=>{let{data:n}=await a(e.link),i=c(n);return i(`img`).each((e,n)=>{n=i(n),n.replaceWith(r(s.join(t,`templates/description-b417c82f.art`),{image:{src:n.prop(`src`)?.split(/\?/)[0]??void 0,alt:n.prop(`title`)}}))}),e.title=i(`h1`).first().text(),e.description+=r(s.join(t,`templates/description-b417c82f.art`),{description:i(`div.article-cont`).html()}),e.author=i(`div.lc-infos a`).toArray().map(e=>i(e).text()).join(`/`),e.category=[...new Set([...e.category??[],...i(`div.article-label-r a.label`).toArray().map(e=>i(e).text())])].filter(Boolean),e})));let{data:g}=await a(f),_=c(g),v=_(`div.this_nav`).text().trim(),y=new URL(_(`link[rel="shortcut icon"]`).prop(`href`),d).href,b=_(`meta[name="keywords"]`).prop(`content`);return{item:h,title:`${_(`title`).text()}${v}`,link:f,description:_(`meta[name="description"]`).prop(`content`),language:`zh`,image:new URL(_(`div.logo_img img`).prop(`src`),d).href,icon:y,logo:y,subtitle:b.replaceAll(`,`,``),author:b.split(/,/)[0]}}export{l as route};