import{n as e,t}from"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t as n}from"./ofetch-CfXAR0UO.js";import{t as r}from"./cache-CpEhLexq.js";import{t as i}from"./render-d6AVTUl2.js";import{t as a}from"./parse-date-CHEO0z5G.js";import{t as o}from"./types-Bn7An2Wc.js";import s from"node:path";import{load as c}from"cheerio";e();const l=`https://www.theblockbeats.info`,u=`https://api.blockbeats.cn`,d=e=>{let n=c(i(s.join(t,`templates/description-ee3da0fe.art`),e),null,!1);return n(`img`).each((e,t)=>{let r=n(t),i=r.attr(`src`);r.attr(`src`,i?.split(`?`)[0])}),n.html()},f={newsflash:{title:`快讯`,link:`${l}/newsflash`,api:`${u}/v2/newsflash/list`},article:{title:`文章`,link:`${l}/article`,api:`${u}/v2/article/list`}},p={path:`/:channel?/:original?`,categories:[`finance`],view:o.Articles,example:`/theblockbeats/newsflash`,parameters:{channel:{description:`类型`,options:[{value:`newsflash`,label:`快讯`},{value:`article`,label:`文章`}],default:`newsflash`},original:{description:"文章类型，仅 `channel` 为 `article` 时有效",options:[{value:`0`,label:`全部`},{value:`1`,label:`深度`},{value:`2`,label:`精选`},{value:`3`,label:`热点追踪`}],default:`0`}},name:`新闻快讯`,maintainers:[`Fatpandac`,`jameshih`,`DIYgod`],handler:m,radar:[{title:`文章`,source:[`www.theblockbeats.info/article`],target:`/article`},{title:`快讯`,source:[`www.theblockbeats.info/newsflash`],target:`/newsflash`}],description:`|    快讯   |   文章  |
| :-------: | :-----: |
| newsflash | article |

| 全部 | 深度 | 精选 | 热点追踪 |
| :--: | :--: | :--: | :---: |
|     | -2  | 1    |  2     |`};async function m(e){let{channel:t=`newsflash`,original:i}=e.req.param(),o=(await n(f[t].api,{query:{limit:e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):20,original:t===`article`?i:void 0}})).data.list.map(e=>({title:e.title,link:`${l}/${t===`newsflash`?`flash`:`news`}/${e.article_id}`,description:e.content??e.abstract,pubDate:a(e.add_time,`X`),author:e.author?.nickname,category:e.tag_list,imgUrl:e.img_url}));return t!==`newsflash`&&(o=await Promise.all(o.map(e=>r.tryGet(`theblockbeats:${e.link}`,async()=>{let t=c(await n(e.link));return e.description=d({image:e.imgUrl,description:t(`div.news-content`).html()}),e})))),{title:`TheBlockBeats - ${f[t].title}`,link:f[t].link,item:o}}export{p as route};