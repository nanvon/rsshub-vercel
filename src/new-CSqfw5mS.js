import{__dirname as e,init_esm_shims as t}from"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-rK3Yp7nj.js";import"./helpers-gUVC02jt.js";import{cache_default as n}from"./cache-Dfid4xgQ.js";import{art as r}from"./render-DftO2d-b.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import{got_default as a}from"./got-Bnno2HfO.js";import o from"node:path";import{load as s}from"cheerio";import c from"iconv-lite";t();const l={path:`/new`,categories:[`blog`],example:`/xys/new`,parameters:{},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`xys.org/`,`xys.org/new.html`]}],name:`新到资料`,maintainers:[`wenzhenl`],handler:u,url:`xys.org/`};async function u(t){let l=`http://www.xys.org`,u=`${l}/new.html`,d=await a({method:`get`,url:u,responseType:`buffer`}),f=s(c.decode(d.data,`gb2312`)),p=f(`li a`).slice(4,t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`)):30).toArray().map(e=>{e=f(e);let t=e.attr(`href`);/^https?:\/\//.test(t)||(t=l+`/`+t.replace(/^\//,``));let n=e.parent().text().trim().slice(0,8);return n=i(n,`YY.MM.DD`),{title:e.text(),link:t,pubDate:n}});return p=await Promise.all(p.filter(e=>!e.link.endsWith(`.zip`)).map(t=>n.tryGet(t.link,async()=>{if(t.link.match(/(?:https?:\/\/)?(?:www\.)?youtu\.?be(?:\.com)?\/?.*(?:watch|embed)?(?:.*v=|v\/|\/)([\w-]+)&?/g))t.description=r(o.join(e,`templates/desc-2f9d87ea.art`),{youTube:t.link.slice(32)});else{let e=await a({method:`get`,url:t.link,responseType:`buffer`});t.description=s(c.decode(e.data,`gb2312`)).text().replaceAll(`
`,`<br>
`)}return t}))),{title:`新语丝 - 新到资料`,link:u,item:p}}export{l as route};