import"./esm-shims-DIdKin6S.mjs";import{t as e}from"./config-PItPnVIx.mjs";import"./logger-BoKmWr7Z.mjs";import"./ofetch-rVU2XYFs.mjs";import"./helpers-vRt84cId.mjs";import{t}from"./cache-KwJARS5Z.mjs";import{t as n}from"./parse-date-9Tu6hSFW.mjs";import"./md5-CNuHcJTL.mjs";import{t as r}from"./got-BeQM9q-W.mjs";import{t as i}from"./types-zV-JXsJH.mjs";import{n as a}from"./utils-DOYgo4Ds.mjs";const o={path:`/people/allCollections/:id`,categories:[`social-media`],view:i.Articles,example:`/zhihu/people/allCollections/87-44-49-67`,parameters:{id:`作者 id，可在用户主页 URL 中找到`},features:{requireConfig:[{name:`ZHIHU_COOKIES`,description:``}],requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.zhihu.com/people/:id`]}],name:`用户全部收藏内容`,maintainers:[`Healthyyue`],handler:s};async function s(i){let o=i.req.param(`id`),s=(await r(`https://api.zhihu.com/people/${o}/collections`,{headers:{cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/people/${o}/collections`}})).data.data,c=(await Promise.all(s.map(async n=>{let{data:i,paging:{totals:o}}=(await r(`https://www.zhihu.com/api/v4/collections/${n.id}/items?offset=0&limit=20`,{headers:{...a,cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/collection/${n.id}`}})).data;if(o>20){let s=Array.from({length:Math.ceil(o/20)-1},(e,t)=>(t+1)*20),c=await Promise.all(s.map(i=>t.tryGet(`https://www.zhihu.com/api/v4/collections/${n.id}/items?offset=${i}&limit=20`,async()=>(await r(`https://www.zhihu.com/api/v4/collections/${n.id}/items?offset=${i}&limit=20`,{headers:{...a,cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/collection/${n.id}`}})).data.data)));i.push(...c.flat())}return{collectionId:n.id,collectionTitle:n.title,items:i}}))).flatMap(e=>e.items.map(t=>({...t,collectionTitle:e.collectionTitle})));return{title:`${s[0].creator.name}的知乎收藏`,link:`https://www.zhihu.com/people/${o}/collections`,item:c.map(e=>{let t=e.content;return{title:t.type===`article`||t.type===`zvideo`?t.title:t.question.title,link:t.url,description:t.type===`zvideo`?`<img src=${t.video.url}/>`:t.content,pubDate:n((t.type===`article`?t.updated:t.updated_time)*1e3),category:[e.collectionTitle]}})}}export{o as route};