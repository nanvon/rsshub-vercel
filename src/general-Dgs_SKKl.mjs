import{n as e,t}from"./esm-shims-L08rKynx.mjs";import{t as n}from"./cache-BDs-9Wd7.mjs";import{t as r}from"./render-CBhnapAf.mjs";import{t as i}from"./parse-date-bKmkZ9gg.mjs";import{r as a}from"./common-utils-CrvTTrJV.mjs";import{t as o}from"./got-Be7Twwza.mjs";import{t as s}from"./timezone-CE0MDOJ-.mjs";import{n as c}from"./wechat-mp-BmGiOFrX.mjs";import{load as l}from"cheerio";e();const u=async(e,u)=>{let d=a(u).split(`/`).filter(e=>e!==``),[f,p]=d,m=e.pathstartat===void 0?0:e.pathstartat,h=`http://`+p+`.`+f+`.gov.cn`;for(let e=0;e<m;e++){let t=d[e+2];h=h+`/`+t}let g=e.defaultPath,_=e.name_element,v=e.name_match_type,y=e.name_match,b=e.name_join,x=e.list_element,S=e.list_include;if(x===void 0&&(x=`a[href*="content"]`,S=`site`),S===`site`){x=x.split(`,`).filter(e=>e!==``);for(let e=0;e<x.length;e++)x[e]+=`[href*="`+h.slice(7)+`"]`;x=x.join(`,`)}let C=e.title_element,w=e.title_match,T=e.author_element,E=e.author_match,D=e.authorisme,O=e.description_element,k=e.pubDate_element,A=e.pubDate_match,j=e.pubDate_format;d.splice(0,2+m);let M=d.join(`/`);M=M===``?g:M.endsWith(`/`)?M:M+`/`;let N=`${h}/${M}`,P=``,F=``,I=``;if(M.startsWith(`gkmlpt`)){C=void 0,w=void 0,O=`div[class="article-content"]`,k=void 0,A=void 0,j=void 0;let e=await o(`${h}/gkmlpt/api/all/0`);F=D+`政府信息公开平台`,I=e.data.articles.filter(e=>e.url.includes(`content`))}else{let e=(await o(N)).data;switch(P=l(e),v){case`name`:F=_;break;case`meta`:_=_.split(`,`).filter(e=>e!==``);for(let e=0;e<_.length;e++)_[e]=P(`meta[name="`+_[e].trim()+`"]`).attr(`content`);F=_.join(b);break;case`element`:_=_.split(`,`).filter(e=>e!==``);for(let e=0;e<_.length;e++)_[e]=P(_[e].trim()).text().match(y)[1];F=_.join(b);break;default:F=P(`head title`).text();break}I=P(x)}let L=I.map((e,t)=>{let n=``;return M.startsWith(`gkmlpt`)?n=e.url:(n=P(t).attr(`href`),n.startsWith(`http`)||(n=n.startsWith(`/`)?`${h}${n}`:`${h}/${n}`)),n}),R=await Promise.all(L.map(e=>{let a=new URL(e);return a.pathname===`/zcjdpt`?n.tryGet(e,async()=>{let n=(await o(`https://zcjd.cloud.gd.gov.cn/api/home/article`+a.search)).data.data;for(let e=0;e<n.jie_du_items.length;e++)n.jie_du_items[e].jd_content=n.jie_du_items[e].jd_content.replaceAll(/((\n {4})|(\n))/g,`</p><p style="font-size: 16px;line-height: 32px;text-indent: 2em;">`);return{link:e,title:n.art_title,description:r(d.join(t,`templates/zcjdpt-2599868d.art`),n),pubDate:s(i(n.pub_time),8),author:/(本|本网|本站)/.test(n.pub_unite)?D:n.pub_unite}}):a.host===`mp.weixin.qq.com`?c({link:e}):n.tryGet(e,async()=>{let{data:t}=await o(e),n=l(t),r=``;r=T===void 0?n(`meta[name="ContentSource"]`).attr(`content`):n(T).text().trim().match(E)[1].trim().replaceAll(/(-*$)/g,``);let a=``;a=k===void 0?n(`meta[name="PubDate"]`).attr(`content`):n(k).text().trim().match(A)[1].trim().replaceAll(/(-*$)/g,``);let c=``;c=C===void 0?n(`meta[name="ArticleTitle"]`).attr(`content`):n(C).text().trim().match(w)[1];let u=O.split(`,`).filter(e=>e!==``);for(let e=0;e<u.length;e++)u[e]=n(u[e].trim()).html();let d=u.join(``);return{link:e,title:c,description:d,pubDate:s(i(a,j),8),author:/本|本网|本站/.test(r)?D:r}})}));return{title:F,link:N,item:R}};export{u as t};