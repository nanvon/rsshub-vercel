import"./esm-shims-DtWyl6zt.js";import"./config-BpwDbAkH.js";import"./logger-B3QfaIfn.js";import"./dist-CKN2M7CD.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-BWStd97H.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import"./ofetch-CYKAhM9L.js";import{got_default as n}from"./got-pWlL3EH4.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import*as i from"cheerio";const a={path:`/weatheralarm/:province?`,categories:[`forecast`],example:`/nmc/weatheralarm/广东省`,parameters:{province:`省份`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`nmc.cn/publish/alarm.html`,`nmc.cn/`],target:`/weatheralarm`}],name:`全国气象预警`,maintainers:[`ylc395`],handler:o,url:`nmc.cn/publish/alarm.html`};async function o(a){let{province:o=``}=a.req.param(),{data:s}=await n(`http://www.nmc.cn/rest/findAlarm`,{searchParams:{pageNo:1,pageSize:20,signaltype:``,signallevel:``,province:o}}),c=s.data.page.list.map(e=>({title:e.title,link:`http://www.nmc.cn${e.url}`,pubDate:r(t(e.issuetime),8)})),l=await Promise.all(c.map(t=>e.tryGet(t.link,async()=>{let{data:e}=await n(t.link),r=i.load(e);return t.description=r(`#icon`).html()+r(`#alarmtext`).toArray().map(e=>r(e).html()).join(``),t})));return{title:`中央气象台全国气象预警`,link:`http://www.nmc.cn/publish/alarm.html`,allowEmpty:!0,item:l}}export{a as route};