import{n as e,t}from"./esm-shims-D4LgnpSl.mjs";import"./config-L8Ls2W7q.mjs";import"./logger-C50fTRi5.mjs";import"./ofetch-CvLG4YCQ.mjs";import"./helpers-mo8InLYm.mjs";import{t as n}from"./cache-ZTWfXd2T.mjs";import{t as r}from"./render-CBhnapAf.mjs";import{t as i}from"./parse-date-bKmkZ9gg.mjs";import{t as a}from"./got-AYh7EWi-.mjs";import{t as o}from"./timezone-CE0MDOJ-.mjs";import{t as s}from"./invalid-parameter-Cn6c8J1f.mjs";import{t as c}from"./valid-host-Xp56J0Ip.mjs";import l from"node:path";import{load as u}from"cheerio";e();const d={path:`/devlog/:user/:id`,categories:[`game`],example:`/itch/devlog/teamterrible/the-baby-in-yellow`,parameters:{user:`User id, can be found in URL`,id:`Item id, can be found in URL`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`Developer Logs`,maintainers:[`nczitzk`],handler:f,description:"`User id` is the field before `.itch.io` in the URL of the corresponding page, e.g. the URL of [The Baby In Yellow Devlog](https://teamterrible.itch.io/the-baby-in-yellow/devlog) is `https://teamterrible.itch.io/the-baby-in-yellow/devlog`, where the field before `.itch.io` is `teamterrible`.\n\n  `Item id` is the field between `itch.io` and `/devlog` in the URL of the corresponding page, e.g. the URL for [The Baby In Yellow Devlog](https://teamterrible.itch.io/the-baby-in-yellow/devlog) is `https://teamterrible.itch.io/the-baby-in-yellow/devlog`, where the field between `itch.io` and `/devlog` is `the-baby-in-yellow`.\n\n  So the route is [`/itch/devlogs/teamterrible/the-baby-in-yellow`](https://rsshub.app/itch/devlogs/teamterrible/the-baby-in-yellow)."};async function f(e){let d=e.req.param(`user`)??``,f=e.req.param(`id`)??``,p=Number.parseInt(e.req.query(`limit`))||20;if(!c(d))throw new s(`Invalid user`);let m=`https://${d}.itch.io/${f}/devlog`,h=u((await a({method:`get`,url:m})).data),g=h(`.title`).toArray().slice(0,p).map(e=>(e=h(e),{title:e.text(),link:e.attr(`href`),pubDate:o(i(e.text()),8)}));return g=await Promise.all(g.map(e=>n.tryGet(e.link,async()=>{let n=u((await a({method:`get`,url:e.link})).data),i=n(`script[type="application/ld+json"]:contains("@type":"BlogPosting")`),o=JSON.parse(n(i).text());return e.author=o.author.name,e.pubDate=o.datePublished,e.description=r(l.join(t,`templates/description-6541c218.art`),{images:n(`.post_image`).toArray().map(e=>n(e).attr(`src`)),description:n(`.post_body`).html()}),e}))),{title:h(`title`).text(),link:m,item:g}}export{d as route};