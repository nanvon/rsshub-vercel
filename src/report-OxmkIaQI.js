import{n as e,t}from"./esm-shims-CMsyBHYK.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CRUPiVpr.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-BlqYKpVp.js";import{t as o}from"./types-Bn7An2Wc.js";import s from"node:path";import{load as c}from"cheerio";e();function l(e){let t=``;switch(String(e)){case`0`:t=`调高`;break;case`1`:t=`调低`;break;case`2`:t=`首次`;break;case`3`:t=`维持`;break;case`4`:t=`无`;break;default:t=`-`;break}return t}function u(e,t){let n=``;return e!==void 0&&(n=e===``?``:Number(e).toFixed(t)),n}const d={path:`/report/:category`,categories:[`finance`],view:o.Articles,example:`/eastmoney/report/strategyreport`,parameters:{category:{description:`研报类型`,options:[{value:`strategyreport`,label:`策略报告`},{value:`macresearch`,label:`宏观研究`},{value:`brokerreport`,label:`券商晨报`},{value:`industry`,label:`行业研报`},{value:`stock`,label:`个股研报`}]}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`data.eastmoney.com/report/:category`]}],name:`研究报告`,maintainers:[`syzq`],handler:f,description:`| 策略报告       | 宏观研究    | 券商晨报     | 行业研究 | 个股研报 |
| -------------- | ----------- | ------------ | -------- | -------- |
| strategyreport | macresearch | brokerreport | industry | stock    |`};async function f(e){let o=`https://data.eastmoney.com`,{category:d=`strategyreport`}=e.req.param(),f={brokerreport:`券商晨报`,industry:`行业研报`,macresearch:`宏观研究`,strategyreport:`策略报告`,stock:`个股研报`},p={brokerreport:`zw_brokerreport`,industry:`zw_industry`,macresearch:`zw_macresearch`,strategyreport:`zw_strategy`,stock:`info`},m=c((await a(`${o}/report/${d}`)).data),h=JSON.parse(m(`script`).text().match(/var initdata(.=?)(.*?);/)[2]).data.map(e=>{let t=d===`stock`?`[${e.stockName}]`:``;return{title:`[${e.orgSName}]${t}${e.title}`,link:`${o}/report/${p[d]}`+(d===`stock`?`/${e.infoCode}.html`:`.jshtml?encodeUrl=${e.encodeUrl}`),pubDate:i(e.publishDate),author:e.researcher,originItem:e}}),g=await Promise.all(h.map(e=>{let i=e.originItem;return delete e.originItem,n.tryGet(e.link,async()=>{try{let{data:n}=await a(e.link),o=c(n);if(d===`stock`){let{title:n,stockName:a,stockCode:c,emRatingName:d,ratingChange:f,orgSName:p,indvInduName:m}=i,h=l(f),g=new Date().getFullYear(),_=g+1,v=o(`.newsContent`).html(),y=o(`#ContentBody .rightlab`).attr(`href`),b=u(i.predictThisYearEps,3),x=u(i.predictThisYearPe,2),S=u(i.predictNextYearEps,3),C=u(i.predictNextYearPe,2);e.enclosure_url=y,e.description=r(s.join(t,`templates/stock_description-13fa7813.art`),{title:n,stockName:a,stockCode:c,emRatingName:d,ratingChangeStr:h,description:v,orgSName:p,predictThisYearEps:b,predictThisYearPe:x,predictNextYearEps:S,predictNextYearPe:C,indvInduName:m,currentYear:g,nextYear:_,enclosureUrl:y})}else e.link=o(`.pdf-link`).attr(`href`),e.description=o(`.ctx-content`).text();return e}catch{return e}})}));return{title:`东方财富网-${f[d]}`,link:o,item:g}}export{d as route};