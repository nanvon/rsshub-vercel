import{cache_default as e}from"./cache-BjesfGXD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{got_default as n}from"./got-DF7DsGgk.js";import{timezone as r}from"./timezone-CMz5pnRe.js";import{fetchArticle as i}from"./wechat-mp-DCQ8hEM6.js";import{load as a}from"cheerio";const o=e=>{if(!e.startsWith(`http`))return`in-nua`;let t=new URL(e);return t.hostname===`mp.weixin.qq.com`?`wechat-mp`:t.hostname===`www.nua.edu.cn`?`nua`:`unknown`};function s(e,t){return`<a href="${t}">${e}</a>`}async function c(e,i,s,c,l){let u=await n(e,{https:{rejectUnauthorized:!1}}),d=a(u.data),f=d(l).text().trim();return[d(s).toArray().map(e=>{let n=d(e).find(`a`).attr(`href`),a=o(n);return{link:a===`in-nua`?i+n:n,title:d(e).find(`a`).attr(`title`),pubDate:r(t(d(e).find(c).first().text(),`YYYY-MM-DD`),8),type:a}}),f]}var l={ProcessList:c,ProcessFeed:(t,r)=>Promise.all(t.map(t=>e.tryGet(t.link,async()=>{switch(t.type){case`in-nua`:case`nua`:{let e=await n(t.link,{https:{rejectUnauthorized:!1}}),i=a(e.data);return t.author=i(`.arti_publisher`).text()+`  `+i(`.arti_views`).text(),t.description=i(r).html(),t}case`wechat-mp`:return i(t.link);case`unknown`:default:return t.description=`暂不支持解析该内容，请点击 ${s(`原文`,t.link)}`,t}})))};export{l as utils_default};