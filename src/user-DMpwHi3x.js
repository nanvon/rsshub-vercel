import{__dirname as e,init_esm_shims as t}from"./esm-shims-2LyWUseo.js";import{config as n}from"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-BLnIkXRv.js";import"./helpers-gUVC02jt.js";import{cache_default as r}from"./cache-Dfid4xgQ.js";import{art as i}from"./render-CSnicFA3.js";import{parseDate as a}from"./parse-date-DHsdom8D.js";import{got_default as o}from"./got-DPq_2TLS.js";import s from"node:path";t();const c={path:`/:handle`,categories:[`picture`],example:`/artstation/wlop`,parameters:{handle:`Artist handle, can be found in URL`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.artstation.com/:handle`]}],name:`Artist Profolio`,maintainers:[`TonyRL`],handler:l};async function l(t){let c=t.req.param(`handle`),l={accept:`application/json, text/plain, */*`,"accept-language":`en-US,en;q=0.9`,"content-type":`application/json`,"user-agent":n.trueUA},u=await r.tryGet(`artstation:csrfToken`,async()=>(await o.post(`https://www.artstation.com/api/v2/csrf_protection/token.json`,{headers:l})).headers[`set-cookie`][0].split(`;`)[0].split(`=`)[1]),{data:d}=await o(`https://www.artstation.com/users/${c}/quick.json`,{headers:{...l,cookie:`PRIVATE-CSRF-TOKEN=${u}`}}),{data:f}=await o(`https://www.artstation.com/users/${c}/projects.json`,{headers:{...l,cookie:`PRIVATE-CSRF-TOKEN=${u}`},searchParams:{user_id:d.id,page:1}}),p=e=>e.replace(/\/\d{14}\/small_square\//,`/large/`),m=f.data.map(t=>({title:t.title,description:i(s.join(e,`templates/description-674eb99b.art`),{description:t.description,image:{src:p(t.cover.small_square_url),title:t.title}}),pubDate:a(t.published_at),updated:a(t.updated_at),link:t.permalink,author:d.full_name,assetsCount:t.assets_count,hashId:t.hash_id,icons:t.icons})),h=await Promise.all(m.map(t=>r.tryGet(t.link,async()=>{if(t.assetsCount>1||!t.icons.image){let{data:n}=await o(`https://www.artstation.com/projects/${t.hashId}.json`,{headers:{...l,cookie:`PRIVATE-CSRF-TOKEN=${u}`}});t.description=i(s.join(e,`templates/description-674eb99b.art`),{description:n.description,assets:n.assets});for(let e of n.assets)if(e.asset_type!==`video`&&e.asset_type!==`image`&&e.asset_type!==`video_clip`&&e.asset_type!==`cover`)throw Error(`Unhandle asset type: ${e.asset_type}`)}return t})));return{title:`${d.full_name} - ArtStation`,description:d.headline,link:d.permalink,logo:d.large_avatar_url,icon:d.large_avatar_url,image:d.default_cover_url,item:h}}export{c as route};