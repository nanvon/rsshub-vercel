import{n as e,t}from"./esm-shims-D4LgnpSl.mjs";import"./config-L8Ls2W7q.mjs";import"./logger-C50fTRi5.mjs";import"./ofetch-CvLG4YCQ.mjs";import"./helpers-mo8InLYm.mjs";import{t as n}from"./render-CBhnapAf.mjs";import{t as r}from"./parse-date-bKmkZ9gg.mjs";import{t as i}from"./got-AYh7EWi-.mjs";import a from"node:path";e();const o={path:`/post/:id`,categories:[`bbs`],example:`/douyu/post/631737151576473201`,parameters:{id:`帖子 id，可在帖子页 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`yuba.douyu.com/p/:id`,`yuba.douyu.com/`]}],name:`鱼吧跟帖`,maintainers:[`nczitzk`],handler:s};async function s(e){let o=e.req.param(`id`),s=`https://yuba.douyu.com`,c=`${s}/p/${o}`,l=(await i({method:`get`,url:`${s}/wbapi/web/post/detail/${o}`})).data.data,u=`${s}/wbapi/web/post/comments/${o}?group_id=${l.group_id}&sink=1&page=1`,d=await i({method:`get`,url:u});u=`${s}/wbapi/web/post/comments/${o}?group_id=${l.group_id}&sink=1&page=${d.data.page_total}`,d=await i({method:`get`,url:u});let f=d.data.data.map(e=>({title:`${e.nick_name}: ${e.content}`,link:`${c}#${e.comment_id}${e.sub_replies.length>0?`+${e.sub_replies.map(e=>e.comment_id).join(`+`)}`:``}`,pubDate:r(e.created_ts*1e3),description:n(a.join(t,`templates/description-45e4c66d.art`),{content:e.content,images:e.imglist.map(e=>({size:e.size,url:e.url})),replies:e.sub_replies.map(e=>({nickname:e.nickname,content:e.content,time:new Date(e.created_ts*1e3).toLocaleString()}))??void 0})}));return{title:`斗鱼鱼吧 - ${l.title}`,link:c,item:f,description:l.content}}export{o as route};