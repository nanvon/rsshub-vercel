import{n as e,t}from"./esm-shims-L08rKynx.mjs";import"./config-Bs8nOQqi.mjs";import"./logger-BvLYiR5T.mjs";import"./ofetch-1TBKTiHL.mjs";import"./helpers-mo8InLYm.mjs";import{t as n}from"./render-CBhnapAf.mjs";import{t as r}from"./parse-date-bKmkZ9gg.mjs";import{t as i}from"./got-Be7Twwza.mjs";import a from"node:path";e();const o={path:`/knowledge/:topic?/:type?`,categories:[`new-media`],example:`/dedao/knowledge`,parameters:{topic:`话题 id，可在对应话题页 URL 中找到`,type:"分享类型，`true` 指精选，`false` 指最新，默认为精选"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`dedao.cn/knowledge/topic/:topic`,`dedao.cn/knowledge`,`dedao.cn/`]}],name:`知识城邦`,maintainers:[`nczitzk`],handler:s};async function s(e){let o=e.req.param(`topic`)??``,s=/t|y/i.test(e.req.param(`type`)??`true`),c=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):100,l=`https://www.dedao.cn`,u=`${l}/knowledge${o===``?``:`/topic/`+o}`,d=`${l}/pc/ledgers/${o===``?`notes/friends_timeline`:`topic/notes/list`}`,f=`${l}/pc/ledgers/topic/detail`,p=``,m=``;if(o!==``){let e=await i({method:`post`,url:f,json:{incr_view_count:!1,topic_id_hazy:o}});p=e.data.c.name,m=e.data.c.intro}let h=await i({method:`post`,url:d,json:{count:c,load_chain:!0,is_elected:s,page_id:0,topic_id_hazy:o,version:2}}),g=(o===``?h.data.c.notes:h.data.c.note_detail_list).map(e=>({title:e.f_part.note,author:e.f_part.nick_name,link:`${l}/knowledge/note/${e.f_part.note_id_hazy}`,pubDate:r(e.f_part.time_desc,`MM-DD`),description:n(a.join(t,`templates/knowledge-72d39b85.art`),{rootUrl:l,f_part:e.f_part,s_part:e.s_part})}));return{title:`得到 - 知识城邦${p===``?``:` - `+p}`,link:u,item:g,description:m}}export{o as route};