import{__dirname as e,init_esm_shims as t}from"./esm-shims-BGJi2y--.js";import{art as n}from"./render-CSnicFA3.js";import{parseDate as r}from"./parse-date-DHsdom8D.js";import{got_default as i}from"./got-BOnMlRH6.js";import a from"node:path";import o from"dayjs";import{load as s}from"cheerio";import c from"dayjs/plugin/localizedFormat.js";import{JSDOM as l}from"jsdom";import"dayjs/locale/zh-cn.js";t(),o.extend(c);function u(e){let t={};try{t=new l(e,{runScripts:`dangerously`}).window.__NUXT__.data[0]}catch{throw Error(`Nuxt 框架信息提取失败，请报告这个问题`)}return t}function d(e){return`<img src="${e}"><br/>`}async function f(e){let t=(await i(e)).data;return{content:s(t)(`.description`).html()}}async function p(e){let t=(await i(e)).data,n=s(t),a=n(`.detail-body-container`).html(),o=n(`.topics-articleHead__date`).text();return a=a.replaceAll(`src="/topics/`,`src="https://www.nintendo.com.hk/topics/`),{content:a,pubDate:r(o,`YYYY.M.D`)}}var m={ProcessItem:(e,t)=>Promise.all(e.map(async e=>{let n=await t.tryGet(e.link,()=>f(e.link));return{...e,...n}})),ProcessNews:(e,t)=>Promise.all(e.map(async e=>{let n=await t.tryGet(e.url,()=>p(`https://www.nintendo.com.hk`+e.url));return{...e,...n}})),ProcessNewsChina:(e,t)=>Promise.all(e.map(async e=>{let n=await t.tryGet(e.link,async()=>u((await i(e.link)).data));return{...e,description:e.description+n.newsData.content,category:n.newsData.category,pubDate:r(n.newsData.releaseTime,`x`)}})),ProcessItemChina:(t,r)=>Promise.all(t.map(async t=>{if(!t.link.startsWith(`https://www.nintendoswitch.com.cn/software/`))return t;let s=(await r.tryGet(t.link,async()=>u((await i(t.link)).data))).data;return{...t,category:[...s.supportLanguages,...s.genre,...s.playMode],description:n(a.join(e,`templates/eshop_cn-23aed242.art`),{item:t,software:s,releaseDatetime:o(s.releaseDatetime).locale(`zh-cn`).format(`lll`)})}})),nuxtReader:u,generateImageLink:d};export{m as utils_default};