import{n as e,t}from"./esm-shims-D5mxTuu_.mjs";import"./config-CDM38Tpk.mjs";import"./logger-B0B1yUZ6.mjs";import"./ofetch-FkpIOIxH.mjs";import"./helpers-CMl_ndRq.mjs";import{t as n}from"./cache-C6z2tE2n.mjs";import{t as r}from"./render-D2i47mnC.mjs";import{t as i}from"./parse-date-Cv8vEJfE.mjs";import{t as a}from"./got-CxBlPaz_.mjs";import{t as o}from"./timezone-DuBj3K5r.mjs";import s from"node:path";import{load as c}from"cheerio";e();const l=`https://weixin.shmtu.edu.cn/dynamic/shmtuHttps`,u=`https://portal.shmtu.edu.cn/api`,d=async e=>{let t=await a.post(l,{form:{interfaceUrl:e},https:{rejectUnauthorized:!1}});return JSON.parse(t.data)},f=(e,n)=>Promise.all(e.map(e=>n.tryGet(e.link,async()=>{let n=await d(e.link),i=n.field_file,a=n.field_image;return e.description=r(s.join(t,`templates/portal-9c9e2508.art`),{body:n.body.und[0].safe_value,images:a.length!==0&&Object.keys(a).length!==0?a.und:null,files:i.length!==0&&Object.keys(i).length!==0?i.und:null}),e.link=n.path,e}))),p={path:`/portal/:type`,categories:[`university`],example:`/shmtu/portal/bmtzgg`,parameters:{type:`类型名称`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`portal.shmtu.edu.cn/:type`]}],name:`数字平台`,maintainers:[`imbytecat`],handler:m,description:`| 部门通知公告 | 学术与大型活动公告 | 部门动态 |
| ------------ | ------------------ | -------- |
| bmtzgg       | xsydxhdgg          | bmdt     |`};async function m(e){let t=e.req.param(`type`),r;switch(t){case`bmtzgg`:r=`部门通知公告`;break;case`xsydxhdgg`:r=`学术与大型活动公告`;break;case`bmdt`:r=`部门动态`;break;default:r=`未知`;break}let s=await a.post(l,{form:{interfaceUrl:`${u}/${t}.json?page=0`},https:{rejectUnauthorized:!1}}),d=await f(JSON.parse(s.data).map(e=>({title:c(e.title).text(),link:`${u}/node/${e.nid}.json`,pubDate:o(i(e.created),8),category:e.field_department[0],author:e.field_department[0]})),n);return{title:`上海海事大学 ${r}`,link:`https://portal.shmtu.edu.cn/bumentongzhigonggao`,description:`上海海事大学 数字平台`,item:d}}export{p as route};