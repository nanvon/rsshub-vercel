import"./esm-shims-BGJi2y--.js";import{config as e}from"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as t}from"./ofetch-DqHh1IN2.js";import{cache_default as n}from"./cache-Dfid4xgQ.js";import{config_not_found_default as r}from"./config-not-found-B7nOMdXp.js";import{getHeaders as i}from"./utils-CJMMBGFc.js";import{load as a}from"cheerio";const o={path:`/product/:id`,categories:[`shopping`],example:`/smzdm/product/zm5vzpe`,parameters:{id:`商品 id，网址上直接可以看到`},features:{requireConfig:[{name:`SMZDM_COOKIE`,description:`什么值得买登录后的 Cookie 值`}],requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`wiki.smzdm.com/p/:id`],target:`/product/:id`}],name:`商品`,maintainers:[`chesha1`],handler:s};async function s(o){if(!e.smzdm.cookie)throw new r(`什么值得买排行榜 is disabled due to the lack of SMZDM_COOKIE`);let s=`https://wiki.smzdm.com/p/${o.req.param(`id`)}`,c=await t(s,{headers:i()}),l=a(c),u=l(`title`).text(),d=l(`ul#feed-main-list li`).toArray().map(e=>{let t=l(e).find(`img`).attr(`alt`),n=l(e).find(`h5.feed-block-title a`).attr(`href`),r=l(e).find(`.z-highlight`).text(),i=t+` `+r,a=l(e).find(`.feed-block-descripe`).text().replaceAll(/\s+/g,``);return{title:i,link:n,description:a}}),f=(await Promise.all(d.map(e=>n.tryGet(e.link,async()=>{let n=await t(e.link,{headers:i()}),r=a(n);return r(`span.old`).length>0?null:(e.pubDate=r(`meta[name="weibo:webpage:create_at"]`).attr(`content`),e.description===`阅读全文`&&(e.description=r(`p[itemprop="description"]`).first().html()),e)})))).filter(e=>e!==null);return{title:u,link:s,item:f}}export{o as route};