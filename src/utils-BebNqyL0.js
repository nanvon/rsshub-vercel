import{n as e,t}from"./esm-shims-CMsyBHYK.js";import{t as n}from"./config-DZMnNPig.js";import{t as r}from"./ofetch-CRUPiVpr.js";import{t as i}from"./cache-CpEhLexq.js";import{t as a}from"./render-d6AVTUl2.js";import{t as o}from"./parse-date-CHEO0z5G.js";import{t as s}from"./timezone-BPfwRbwD.js";import{t as c}from"./config-not-found-CX6cWM57.js";import l from"node:path";const u=[{name:`SDO_FF14RISINGSTONES`,description:`值为 Cookie 头中 ff14risingstones 值`},{name:`SDO_UA`,description:`值为与在网页端获取 Cookie 时相匹配的 User-Agent 值`}],d=`https://apiff14risingstones.web.sdo.com/api`,f=`https://ff14risingstones.web.sdo.com`,p=`${f}/pc/index.html`,m=`${f}/pc/favicon.ico`,h={2:`采矿/园艺`,3:`成就收集`,4:`大型任务`,5:`钓鱼`,6:`多玛方城战`,7:`房屋`,8:`怪物狩猎`,9:`集体动作`,10:`角色扮演`,11:`金碟游乐场`,18:`练级`,19:`休闲玩家`,20:`硬核玩家`,21:`主线`,22:`赚钱`,23:`武具投影`,26:`乐器演奏`,28:`聊天`,29:`玩家自办活动`,30:`迷宫挑战`,31:`讨伐歼灭战`,32:`玩家对战`,33:`随机任务`,34:`寻宝`,35:`特殊迷宫探索`,36:`特殊地图探索`,37:`青魔法师`,38:`开拓无人岛`,39:`制作`,41:`绝境战`,42:`深层迷宫挑战`},g={1:`防护职业`,3:`进攻职业`,5:`治疗职业`,6:`骑士`,7:`战士`,8:`暗黑骑士`,9:`绝枪战士`,10:`白魔法师`,11:`占星术士`,12:`学者`,13:`贤者`,14:`武僧`,15:`龙骑士`,16:`忍者`,17:`武士`,18:`钐镰客`,19:`吟游诗人`,20:`机工士`,21:`舞者`,22:`黑魔法师`,23:`召唤师`,24:`赤魔法师`,25:`青魔法师`,28:`近战职业`,29:`远程物理`,30:`远程魔法`,32:`任意职业`,33:`蝰蛇剑士`,34:`绘灵法师`},_=[{value:`34`,label:`冒险者行会`},{value:`52`,label:`生活杂谈`},{value:`38`,label:`同人创作`},{value:`36`,label:`剧情讨论`},{value:`51`,label:`建议和BUG反馈`},{value:`37`,label:`游戏记录`},{value:`35`,label:`举手提问`},{value:`74`,label:`版务专区`},{value:`75`,label:`官方讯息`}],v=[{label:`新手指引`,value:`1`},{label:`副本攻略`,value:`2`},{label:`战斗职业`,value:`3`},{label:`PVP`,value:`4`},{label:`生产采集`,value:`5`},{label:`投影外观`,value:`6`},{label:`房屋装修`,value:`7`},{label:`骑士`,value:`8`},{label:`武僧`,value:`9`},{label:`战士`,value:`10`},{label:`龙骑士`,value:`11`},{label:`吟游诗人`,value:`12`},{label:`白魔法师`,value:`13`},{label:`黑魔法师`,value:`14`},{label:`召唤师`,value:`15`},{label:`学者`,value:`16`},{label:`忍者`,value:`17`},{label:`机工士`,value:`18`},{label:`暗黑骑士`,value:`19`},{label:`占星术士`,value:`20`},{label:`武士`,value:`21`},{label:`赤魔法师`,value:`22`},{label:`青魔法师`,value:`23`},{label:`绝枪战士`,value:`24`},{label:`舞者`,value:`25`},{label:`钐镰客`,value:`26`},{label:`贤者`,value:`27`},{label:`猫魅族`,value:`28`},{label:`拉拉菲尔族`,value:`29`},{label:`人族`,value:`30`},{label:`精灵族`,value:`31`},{label:`维埃拉族`,value:`32`},{label:`敖龙族`,value:`59`},{label:`硌狮族`,value:`60`},{label:`鲁加族`,value:`61`},{label:`无人岛`,value:`62`},{label:`特殊场景探索`,value:`63`},{label:`游戏资讯`,value:`64`},{label:`内容考据`,value:`65`},{label:`摄影截图`,value:`66`},{label:`金碟游乐场`,value:`67`},{label:`综合`,value:`68`},{label:`其他`,value:`69`},{label:`国际服资讯翻译`,value:`70`},{label:`游戏资讯整理`,value:`71`},{label:`其他`,value:`72`}],y={top:`置顶`,refine:`精华`,hot:`周热门`};let b=function(e){return e[e.General=1]=`General`,e[e.Post=2]=`Post`,e[e.Strat=3]=`Strat`,e[e.NoviceNetwork=5]=`NoviceNetwork`,e[e.Duty=6]=`Duty`,e[e.FreeCompany=7]=`FreeCompany`,e[e.RolePlay=8]=`RolePlay`,e[e.Other=9]=`Other`,e}({}),x=function(e){return e[e.Mentor=1]=`Mentor`,e[e.Sprout=2]=`Sprout`,e}({});const S=async e=>await P(`${d}/home/userInfo/getResently?uuid=${e}`),C=async e=>await P(`${d}/home/userInfo/getUserInfo?uuid=${e}`),w=async(e,t)=>await P(`${d}/home/userInfo/getUserPosts?uuid=${e}&type=${t}`).then(e=>e.rows),T=async e=>await P(`${d}/home/userInfo/getUserDynamic?uuid=${e}`).then(e=>e.rows);async function E(e){try{return await i.tryGet(`sdo/ff14risingstones/post-detail:${e}`,async()=>await P(`${d}/home/posts/postsDetail?id=${e}`))}catch{return null}}async function D(e){try{return await i.tryGet(`sdo/ff14risingstones/novice-network-recruit-detail:${e}`,async()=>await P(`${d}/home/recruit/getNeDetail?id=${e}`))}catch{return null}}async function O(e){try{return await i.tryGet(`sdo/ff14risingstones/duties-recruit-detail:${e}`,async()=>await P(`${d}/home/recruit/getRecruitFbDetail?id=${e}`))}catch{return null}}async function k(e){try{return await i.tryGet(`sdo/ff14risingstones/free-company-recruit-detail:${e}`,async()=>await P(`${d}/home/recruit/getRecruitGuildDetail?id=${e}`))}catch{return null}}async function A(e){let t=new URLSearchParams;for(let[n,r]of Object.entries(e))r!==void 0&&t.set(n,r.toString());return await P(`${d}/home/posts/postsList?${t.toString()}`).then(e=>e.rows)}const j=async e=>await P(`${d}/home/dynamic/getFollowDynamicList?limit=${e}`).then(e=>e.rows);e();function M(){if(!n.sdo.ff14risingstones||!n.sdo.ua)throw new c(`ff14risingstones RSS is disabled due to the lack of relevant config`)}function N(e,t){return r(e,{...t,headers:{Cookie:`ff14risingstones=${n.sdo.ff14risingstones}`,"User-Agent":n.sdo.ua,...t?.headers}})}async function P(e,t){let n=await N(e,t);if(n.code!==1e4)throw Error(n.msg);return n.data}async function F(e){return await Promise.all(e.map(async e=>{let t=await E(e.posts_id);return{title:`[${e.part_name}] ${e.title}`,link:`${p}#/post/detail/${e.posts_id}`,description:t?.contentInfo.content,pubDate:s(o(e.created_at),8),updated:t?.updated_at?s(o(t.updated_at),8):void 0,guid:`sdo/ff14risingstones/posts:${e.posts_id}`,author:`${e.character_name}@${e.group_name}`}}))}async function I(e){return await Promise.all(e.map(async e=>{let n=`${e.character_name}@${e.group_name} ${e.mask_content}`,r,i,c=null;switch(e.from){case b.Post:case b.Strat:if(!e.from_info)break;n+=e.from_info.title,r=`${p}#/post/detail/${e.from_info.posts_id}`,c=await E(e.from_info.posts_id),i=c?.contentInfo.content;break;case b.NoviceNetwork:if(!e.from_info)break;n+=`[找${e.from_info.identity===x.Mentor?`豆芽`:`导师`}] ${e.from_info.title}`,r=`${p}#/recruit/beginner?id=${e.from_info.id}`,c=await D(e.from_info.id),i=a(l.join(t,`templates/novice-network-party-e9dacf9e.art`),{detail_mask:e.from_info.detail_mask,styles:e.from_info.style.map(e=>h[e]).join(`,`),target:`${e.from_info.target_area_name} ${e.from_info.target_group_name??`全区`}`,weekday_time:c?.weekday_time,weekend_time:c?.weekend_time});break;case b.Duty:if(!e.from_info)break;n+=`[${e.from_info.fb_type}] ${e.from_info.fb_name}`,r=`${p}#/recruit/party?id=${e.from_info.id}`,c=await O(e.from_info.id),i=a(l.join(t,`templates/duties-party-67b1d959.art`),{progress:e.from_info.progress,strategy:e.from_info.strategy,fb_name:e.from_info.fb_name,fb_time:e.from_info.fb_time,labelInfo:e.from_info.labelInfo,team_composition:e.from_info.team_composition,team_position:e.from_info.team_position?{A:Object.keys(e.from_info.team_position.A).filter(t=>e.from_info.team_position.A[t]!==`0`).map(t=>`${t}: ${g[e.from_info.team_position.A[t]]}`).join(`，`),B:Object.keys(e.from_info.team_position.B).filter(t=>e.from_info.team_position.B[t]!==`0`).map(t=>`${t}: ${g[e.from_info.team_position.B[t]]}`).join(`，`),C:Object.keys(e.from_info.team_position.C).filter(t=>e.from_info.team_position.C[t]!==`0`).map(t=>`${t}: ${g[e.from_info.team_position.C[t]]}`).join(`，`)}:null,MT:g[e.from_info.MT],ST:g[e.from_info.ST],T:g[e.from_info.T],H:g[e.from_info.H],H1:g[e.from_info.H1],H2:g[e.from_info.H2],D1:g[e.from_info.D1],D2:g[e.from_info.D2],D3:g[e.from_info.D3],D4:g[e.from_info.D4],need_job:c?.need_job.map(e=>g[e]).join(`，`),team_detail_mask:c?.team_detail_mask,recruit_require_mask:c?.recruit_require_mask,strategy_desc_mask:c?.strategy_desc_mask});break;case b.FreeCompany:if(!e.from_info)break;n+=`[部队招待] ${e.from_info.guild_name} <${e.from_info.guild_tag}>`,r=`${p}#/recruit/guild/detail/${e.from_info.id}`,c=await k(e.from_info.id),i=a(l.join(t,`templates/fc-party-c69888ce.art`),{cover_pic:e.from_info.cover_pic,guild_name:e.from_info.guild_name,guild_tag:e.from_info.guild_tag,labelInfo:e.from_info.labelInfo,area_name:e.from_info.target_area_name,group_name:e.from_info.target_group_name,active_member_num:e.from_info.active_member_num,target_recruit_num:e.from_info.target_recruit_num,weekday_time:e.from_info.weekday_time,weekend_time:e.from_info.weekend_time,guild_address:c?.guild_address??``,create_time:c?.create_time??``,foot_pic:c?.foot_pic??``,detail_mask:e.from_info.detail_mask});break;case b.RolePlay:if(!e.from_info)break;n+=e.from_info.rp_name,r=`${p}#/recruit/roleplay/detail/${e.from_info.id}`,i=a(l.join(t,`templates/rp-party-90271e34.art`),{cover_pic:e.from_info.cover_pic,open_time:e.from_info.open_time,rp_type:`${e.from_info.rp_type.map(e=>({0:`无`,1:`轻`,2:`中`,3:`重`})[e]).join(`/`)}RP 元素`,create_time:e.from_info.create_time,area:`${e.from_info.rp_area_name} ${e.from_info.rp_group_name}`,address:e.from_info.address,custom_label:e.from_info.custom_label,profile:e.from_info.profile,detail_mask:e.from_info.detail_mask});break;case b.Other:if(!e.from_info)break;n+=`[${e.from_info.category_name}] ${e.from_info.title}`,r=`${p}#/recruit/others?id=${e.from_info.id}`,i=e.from_info.detail_mask;break;default:}return{title:n,link:r,pubDate:s(o(e.created_at),8),guid:`sdo/ff14risingstones/dynamics:${e.id}`,author:`${e.character_name}@${e.group_name}`,description:i}}))}export{A as a,C as c,m as d,_ as f,v as h,j as i,w as l,u as m,I as n,S as o,y as p,F as r,T as s,M as t,p as u};