import"./esm-shims-DE2PJqdr.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-CJF2SF6b.js";import"./helpers-gUVC02jt.js";import{cache_default as e}from"./cache-Dfid4xgQ.js";import{got_default as t}from"./got-Baw2Nbdf.js";import{ViewType as n}from"./types-Bi82qguM.js";import{load as r}from"cheerio";const i={path:`/group/:groupid/:type?`,categories:[`social-media`],view:n.SocialMedia,example:`/douban/group/648102`,parameters:{groupid:`豆瓣小组的 id`,type:{description:`类型`,default:`latest`,options:[{label:`最新`,value:`latest`},{label:`最热`,value:`essence`},{label:`精华`,value:`elite`}]}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.douban.com/group/:groupid`],target:`/group/:groupid`}],name:`豆瓣小组`,maintainers:[`DIYgod`],handler:a};async function a(n){let i=n.req.param(`groupid`),a=n.req.param(`type`),o=`https://www.douban.com/group/${i}/${a&&a!==`latest`?`?type=${a}`:``}`,s=await t({method:`get`,url:o}),c=r(s.data),l=c(`.olt tr:not(.th)`).slice(0,30).toArray(),u=await Promise.all(l.map(n=>{let i=c(n),a={title:i.find(`.title a`).attr(`title`),author:i.find(`a`).eq(1).text(),link:i.find(`.title a`).attr(`href`)};return e.tryGet(a.link,async()=>{try{let e=await t({method:`get`,url:a.link}),n=r(e.data);return a.pubDate=n(`.create-time`).text(),a.description=n(`.rich-content`).html(),a}catch{return a}})}));return{title:`豆瓣小组-${c(`h1`).text().trim()}`,link:o,item:u}}export{i as route};