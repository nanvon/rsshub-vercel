import{n as e,t}from"./esm-shims-D4LgnpSl.mjs";import"./config-L8Ls2W7q.mjs";import"./logger-C50fTRi5.mjs";import"./ofetch-CvLG4YCQ.mjs";import"./helpers-mo8InLYm.mjs";import{t as n}from"./render-CBhnapAf.mjs";import{t as r}from"./parse-date-bKmkZ9gg.mjs";import{t as i}from"./got-AYh7EWi-.mjs";import{t as a}from"./timezone-CE0MDOJ-.mjs";import o from"node:path";import{load as s}from"cheerio";e();const c={CM:`中国移动`,CU:`中国联通`,CT:`中国电信`},l={path:`/cloudflareyes/:type?`,categories:[`other`],example:`/hostmonit/cloudflareyes`,parameters:{type:`类型，见下表，默认为 v4`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`CloudFlareYes`,maintainers:[`nczitzk`],handler:u,description:`| v4 | v6 |
| -- | -- |
|    | v6 |`};async function u(e){let{type:l=`v4`}=e.req.param(),u=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):30,d=`hostmonit.com`,f=`CloudFlareYes${l===`v6`?l.toUpperCase():``}`,p=`https://stock.${d}`,m=`https://api.${d}`,h=new URL(`get_optimization_ip`,m).href,g=new URL(f,p).href,{data:_}=await i.post(h,{json:{key:`iDetkOys`,...l===`v6`?{type:`v6`}:{}}}),v=_.info.slice(0,u).map(e=>{let i=e.ip,s=e.latency===void 0?void 0:`${e.latency}ms`,l=e.line===void 0?void 0:Object.hasOwn(c,e.line)?c[e.line]:e.line,u=e.loss===void 0?void 0:`${e.loss}%`,p=e.node,m=e.speed===void 0?void 0:`${e.speed} KB/s`,h=a(r(e.time),8);return{title:n(o.join(t,`templates/title-c8d56156.art`),{line:l,latency:s,loss:u,speed:m,node:p,ip:i}),link:g,description:n(o.join(t,`templates/description-0589dc12.art`),{line:l,node:p,ip:i,latency:s,loss:u,speed:m}),author:p,category:[l,s,u,p].filter(Boolean),guid:`${d}-${f}-${i}#${h.toISOString()}`,pubDate:h}}),{data:y}=await i(g),b=s(y),x=new URL(b(`link[rel="icon"]`).prop(`href`),p).href;return{item:v,title:b(`title`).text().replace(/- .*$/,`- ${f}`),link:g,description:b(`meta[name="description"]`).prop(`content`),language:b(`html`).prop(`lang`),icon:x,logo:x,subtitle:f,author:b(`title`).text().split(/\s-/)[0],allowEmpty:!0}}export{l as route};