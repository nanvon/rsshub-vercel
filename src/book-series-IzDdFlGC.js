import{__dirname as e,init_esm_shims as t}from"./esm-shims-BFmOnnpb.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-am9EnuPq.js";import"./helpers-gUVC02jt.js";import{cache_default as n}from"./cache-Dfid4xgQ.js";import{art as r}from"./render-CSnicFA3.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import{got_default as a}from"./got-CmdBCkM8.js";import o from"node:path";import{load as s}from"cheerio";t();const c={path:`/:bookName/book-series/:bookId`,radar:[{source:[`routledge.com/:bookName/book-series/:bookId`]}],name:`Unknown`,maintainers:[`TonyRL`],handler:l};async function l(t){let{bookName:c,bookId:l}=t.req.param(),u=`https://www.routledge.com/${c}/book-series/${l}`,{data:d}=await a(u,{headers:{accept:`text/html, */*; q=0.01`},searchParams:{publishedFilter:`alltitles`,pd:`published,forthcoming`,pg:1,pp:12,so:`pub`,view:`list`}}),f=s(d),p=f(`.row.book`).toArray().map(e=>{e=f(e);let t=e.find(`h3 a`),n=e.find(`p.description`),r=e.find(`p.description`).prev().text().split(`
`);return{title:t.text(),link:t.attr(`href`),description:n.text(),pubDate:i(r.pop().trim(),`MMMM DD, YYYY`),author:r.map(e=>e.trim()).filter(Boolean).join(`, `)}}),m=await Promise.all(p.map(t=>n.tryGet(t.link,async()=>{let{data:n}=await a(t.link),i=s(n),c=i(`meta[property="books:isbn"]`).attr(`content`),{data:l}=await a(`https://productimages.routledge.com`,{searchParams:{isbn:c,size:`amazon`,ext:`jpg`}}),u=i(`.sticky-div`);return u.find(`button.accordion-button`).contents().unwrap(),u.find(`.fa-shopping-cart`).parent().parent().remove(),t.description=r(o.join(e,`templates/description-c2244266.art`),{image:l,description:u.html()}),t})));return{title:f(`head title`).text(),description:f(`head meta[name="description"]`).attr(`content`),link:u,item:m}}export{c as route};