import{n as e,t}from"./esm-shims-BKVRry6h.mjs";import"./ofetch-BRplXtiZ.mjs";import"./config-D7dgKYF5.mjs";import"./logger-CkUWGGaS.mjs";import{t as n}from"./cache-Bv3_kFbE.mjs";import"./helpers-Tm7Pw8Vq.mjs";import{t as r}from"./parse-date-_GmTZfjS.mjs";import{t as i}from"./render-CSqLtqb8.mjs";import{t as a}from"./got-BglkE51W.mjs";import{t as o}from"./timezone-BAp4uBjD.mjs";import s from"node:path";import{load as c}from"cheerio";e();const l={path:[`/lc_report/:id?`,`/report/:id?`],categories:[`new-media`],example:`/logclub/lc_report`,parameters:{id:`报告 id，见下表，默认为罗戈研究出品`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`报告`,maintainers:[`nczitzk`],handler:u,description:`| 罗戈研究出品 | 物流报告       | 绿色双碳报告          |
| ------------ | -------------- | --------------------- |
| Report       | IndustryReport | GreenDualCarbonReport |`};async function u(e){let{id:l=`Report`}=e.req.param(),u=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):11,d=`https://www.logclub.com`,f=new URL(`lc_report`,d).href,p=new URL(`front/lc_report/load${l}List`,d).href,{data:m}=await a.post(p,{json:{page:1}}),h=m.list.slice(0,u).map(e=>({title:e.title,link:new URL(`front/lc_report/get_report_info/${e.id}`,d).href,description:i(s.join(t,`templates/description-b417c82f.art`),{image:{src:e.img_url?.split(/\?/)[0]??void 0,alt:e.title}}),author:e.author,category:[e.channel_name],guid:`logclub-report-${e.id}`,pubDate:o(r(e.release_time),8)}));h=await Promise.all(h.map(e=>n.tryGet(e.link,async()=>{let{data:n}=await a(e.link),r=c(n);return r(`img`).each((e,n)=>{n=r(n),n.replaceWith(i(s.join(t,`templates/description-b417c82f.art`),{image:{src:n.prop(`src`)?.split(/\?/)[0]??void 0,alt:n.prop(`title`)}}))}),e.title=r(`h1`).first().text(),e.description+=i(s.join(t,`templates/description-b417c82f.art`),{description:r(`div.article-cont`).html()}),e.author=r(`div.lc-infos a`).toArray().map(e=>r(e).text()).join(`/`),e.category=[...new Set([...e.category??[],...r(`div.article-label-r a.label`).toArray().map(e=>r(e).text())])].filter(Boolean),e})));let{data:g}=await a(f),_=c(g),v=_(`div.this_nav`).text().trim(),y=new URL(_(`link[rel="shortcut icon"]`).prop(`href`),d).href,b=_(`meta[name="keywords"]`).prop(`content`);return{item:h,title:`${_(`title`).text()}${v}`,link:f,description:_(`meta[name="description"]`).prop(`content`),language:`zh`,image:new URL(_(`div.logo_img img`).prop(`src`),d).href,icon:y,logo:y,subtitle:b.replaceAll(`,`,``),author:b.split(/,/)[0]}}export{l as route};