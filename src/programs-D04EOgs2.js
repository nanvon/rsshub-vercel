import{__dirname as e,init_esm_shims as t}from"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-rK3Yp7nj.js";import"./helpers-gUVC02jt.js";import{cache_default as n}from"./cache-Dfid4xgQ.js";import{art as r}from"./render-DftO2d-b.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import{got_default as a}from"./got-Bnno2HfO.js";import o from"node:path";import s from"dayjs";import{load as c}from"cheerio";t();const l={path:`/programs`,categories:[`program-update`],example:`/appstorrent/programs`,name:`Programs`,maintainers:[`xzzpig`],handler:u,url:`appstorrent.ru/programs/`};async function u(t){let l=t?.req.query(`limit`)?Number.parseInt(t?.req.query(`limit`)??`20`):20,u=`https://appstorrent.ru`,d=`${u}/programs/`,f={http2:!0},p=c((await a(d,f)).data),m=p(`article.soft-item:not(.locked)`).slice(0,l).toArray().map(e=>{let t=p(e);return{title:t.find(`.subtitle`).text().trim(),link:t.find(`.subtitle a`).attr(`href`),category:[t.find(`.info .category`).text().trim()],version:t.find(`.version`).text(),architecture:t.find(`.architecture`).text().trim(),size:t.find(`.size`).text().trim()}}),h=await Promise.all(m.map(t=>n.tryGet(t.link,async()=>{let n=c((await a(t.link,f)).data),l=i(n(`.tech-info .date-news a`).attr(`href`)?.replace(`https://appstorrent.ru/`,``)??``);return{title:t.title,link:t.link,category:t.category,pubDate:l,description:r(o.join(e,`templates/description-9593c953.art`),{cover:u+n(`.main-title img`).attr(`src`)?.trim(),title:t.title,pubDate:s(l).format(`YYYY-MM-DD`),version:t.version,architecture:t.architecture,compatibility:n(`div.right > div.info > div.right-container > div:nth-child(5) > div > span:nth-child(2) > a`).text(),size:t.size,activation:n(`div.right > div.info > div.right-container > div:nth-child(4) > div > span:nth-child(2) > a`).text(),description:n(`.content .body-content`).first().text(),changelog:n(`.content .body-content`).last().text(),screenshots:n(`.screenshots img`).toArray().map(e=>n(e).attr(`src`)).map(e=>u+e)})}})));return{title:p(`title`).text(),link:d.toString(),allowEmpty:!0,item:h}}export{l as route};