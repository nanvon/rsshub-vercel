import{n as e,t}from"./esm-shims-D5mxTuu_.mjs";import"./config-CDM38Tpk.mjs";import"./logger-B0B1yUZ6.mjs";import"./ofetch-FkpIOIxH.mjs";import"./helpers-CMl_ndRq.mjs";import{t as n}from"./cache-C6z2tE2n.mjs";import{t as r}from"./render-D2i47mnC.mjs";import{t as i}from"./got-CxBlPaz_.mjs";import a from"node:path";import{load as o}from"cheerio";e();const s=`https://freecomputerbooks.com/`;async function c(e){return o((await i(e)).data)}const l={path:`/:category?`,name:`Book List`,url:new URL(s).host,maintainers:[`cubroe`],handler:u,example:`/freecomputerbooks/compscAlgorithmBooks`,parameters:{category:"A category id., which should be the HTML file name (but **without** the `.html` suffix) in the URL path of a book list page."},categories:[`reading`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`freecomputerbooks.com/`,`freecomputerbooks.com/index.html`],target:``}]};async function u(e){let t=e.req.param(`category`)?.trim(),r=t?new URL(`${t}.html`,s).href:s,i=await c(r),a=i(`.maintitlebar`).text();return{title:`Free Computer Books - `+a,link:r,description:i(`title`).text(),item:await Promise.all(i(`ul[id^=newBooks] > li`).toArray().map(e=>d(i(e),a,n)))}}function d(e,t,n){let r=o(``),i=e.find(`a:first`),a=e.find(`p:contains("Post under")`),c={title:i.text(),link:new URL(i.attr(`href`),s).href,category:a.length?a.find(`a`).toArray().map(e=>r(e).text()):t};return n.tryGet(c.link,()=>f(c))}async function f(e){let n=await c(e.link);n.root().find(`*`).contents().filter((e,t)=>t.type===`comment`).remove();let i=n(`#bookdesc img[title]`).attr(`src`),o=n(`#booktitle ul`).removeAttr(`style`),s=n(`#bookdesccontent`).removeAttr(`id`);return o.find(`li:contains(Share This)`).remove(),s.find(`img[src$="/hot.gif"]`).remove(),s.find(`:contains(Similar Books)`).nextAll().addBack().remove(),e.description=r(a.join(t,`templates/desc-dc50e91a.art`),{imageURL:i,metadata:o,content:s}),e}export{l as route};