import{n as e,t}from"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CfXAR0UO.js";import"./helpers-Cqaav28H.js";import{t as n}from"./render-d6AVTUl2.js";import{t as r}from"./parse-date-CHEO0z5G.js";import{t as i}from"./got-dCh-Ojgc.js";import{t as a}from"./timezone-BPfwRbwD.js";import o from"node:path";import{load as s}from"cheerio";e();const c={path:[`/tieba/forum/good/:kw/:cid?/:sortBy?`,`/tieba/forum/:kw/:sortBy?`],categories:[`bbs`],example:`/baidu/tieba/forum/good/女图`,parameters:{kw:`吧名`,cid:"精品分类，默认为 `0`（全部分类），如果不传 `cid` 则获取全部分类",sortBy:"排序方式：`created`, `replied`。默认为 `created`"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`精品帖子`,maintainers:[`u3u`],handler:l};async function l(e){let{kw:c,cid:l=`0`,sortBy:u=`created`}=e.req.param(),d={kw:encodeURIComponent(c)};e.req.path.includes(`good`)&&(d.tab=`good`),l&&(d.cid=l);let{data:f}=await i(`https://tieba.baidu.com/f`,{headers:{Referer:`https://tieba.baidu.com/`},searchParams:d}),p=s(s(f)(`code[id="pagelet_html_frs-list/pagelet/thread_list"]`).contents().filter(e=>e.nodeType===`8`).prevObject[0].data),m=p(`#thread_list > .j_thread_list[data-field]`).toArray().map(e=>{let i=p(e),{id:s,author_name:c}=i.data(`field`),l=u===`created`?i.find(`.is_show_create_time`).text().trim():i.find(`.threadlist_reply_date`).text().trim(),d=i.find(`a.j_th_tit`).text().trim(),f=i.find(`.threadlist_abs`).text().trim(),m=i.find(`.threadlist_media img`).toArray().map(e=>`<img src="${p(e).attr(`bpic`)}">`).join(``);return{title:d,description:n(o.join(t,`templates/forum-744e0e74.art`),{details:f,medias:m,author_name:c}),pubDate:a(r(l,[`HH:mm`,`M-D`,`YYYY-MM`],!0),8),link:`https://tieba.baidu.com/p/${s}`}});return{title:`${c}吧`,description:s(f)(`meta[name="description"]`).attr(`content`),link:`https://tieba.baidu.com/f?kw=${encodeURIComponent(c)}`,item:m}}export{c as route};