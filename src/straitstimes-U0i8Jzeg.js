import{n as e,t}from"./esm-shims-mGm6WwCc.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-BASlBuka.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-CgQXMNWI.js";import o from"node:path";e();const s={path:`/:category?/:section?`,categories:[`traditional-media`],example:`/straitstimes/singapore`,parameters:{category:`Category, see below for more information`,section:`Section, see below for more information`},features:{requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1,requireConfig:!1},name:`News`,maintainers:[`quiniapiezoelectricity`],handler:c,description:"\n| Category               | `:category`               |\n| ---------------------- | --------------------------- |\n| Singapore              | `singapore`               |\n| Asia                   | `asia`                    |\n| World                  | `world`                   |\n| Opinion                | `opinion`                 |\n| Life                   | `life`                    |\n| Business               | `business`                |\n| Jobs                   | `jobs`                    |\n| Parenting & Education  | `parenting-and-education` |\n| Food                   | `food`                    |\n| Tech                   | `tech`                    |\n| Sport                  | `sport`                   |\n| Podcasts               | `podcasts`                |,\n\n| Section                | `:section`                |\n| ---------------------- | --------------------------- |\n| Top Stories            | `top-stories`             |\n| Latest                 | `latest`                  |",radar:[{source:[`www.straitstimes.com/:category`],target:`/:category`},{source:[`www.straitstimes.com`],target:`/`}]};async function c(e){let s=e.req.param(`category`)?e.req.param(`category`).toLowerCase():`singapore`,c=e.req.param(`section`)?e.req.param(`section`).toLowerCase():void 0,l=`T9XUJM9rAZoLOd2CAx2wCBSTrm3xoyPw`,u=`iosflex`,d;d=(await a({method:`get`,url:`https://newsapi.sphdigital.com/v2/feed/section/st?page=1&platform=${u}&section=${s}/star&subscribed=false&version=4.0`,headers:{"x-api-key":l}})).data.data;let f=new Set(d.filter(e=>e.items[0].itemType===`SectionFooter`).map(e=>e.items[0].sectionFooterData.link.id)),p=c&&f.has(`${s}-${c}-more/star`)?`${s}-${c}-more/star`:void 0;if(c===void 0){for(let e of[`latest`,`top-picks`,`top-stories`])if(f.has(`${s}-${e}-more/star`)){p=`${s}-${e}-more/star`;break}}p&&(d=(await a({method:`get`,url:`https://newsapi.sphdigital.com/v2/feed/section/st?page=1&platform=${u}&section=${p}&subscribed=false&version=4.0`,headers:{"x-api-key":l}})).data.data);let m=d.filter(e=>e.items[0].itemType===`Article`),h=await Promise.all(m.map(e=>n.tryGet(e.items[0].articleData.url,async()=>{let n=e.items[0].articleData;n.authors&&(e.author=n.authors.map(e=>e.name).join(`, `)),n.keywords&&(e.category=n.keywords.map(e=>e.name)),e.title=n.headline,e.pubDate=i(n.publicationTime,`X`),e.updated=i(n.updatedTime,`X`),e.link=n.url;let s=n.teaser;return n.documentId&&(s=(await a({method:`get`,url:`https://newsapi.sphdigital.com/v2/feed/article/st/${n.documentId}?platform=${u}&version=4.0`,headers:{"x-api-key":l}})).data.data.body),e.description=r(o.join(t,`templates/description-38cf9443.art`),{images:n.images??[],article:s}),e})));return{title:`The Strait Times - ${s.replaceAll(`-`,` `).toUpperCase()}`,link:`https://www.straitstimes.com/${s.toLowerCase()}`,item:h}}export{s as route};