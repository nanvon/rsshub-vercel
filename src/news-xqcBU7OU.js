import"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t as e}from"./ofetch-CfXAR0UO.js";import{t}from"./cache-CpEhLexq.js";import{t as n}from"./parse-date-CHEO0z5G.js";import{t as r}from"./timezone-BPfwRbwD.js";import{t as i}from"./types-Bn7An2Wc.js";import{load as a}from"cheerio";import o from"iconv-lite";const s=async i=>{let{category:s=23}=i.req.param(),c=Number.parseInt(i.req.query(`limit`)??`30`,10),l=`https://lol.qq.com`,u=`https://apps.game.qq.com`,d=new URL(`news/index.shtml`,l).href,f=new URL(`cmc/zmMcnTargetContentList`,u).href,p=new URL(`cmc/zmMcnContentInfo`,u).href,m=await e(f,{query:{page:1,num:c,target:s}}),h=await e(d,{responseType:`arrayBuffer`}),g=a(o.decode(Buffer.from(h),`gbk`)),_=g(`html`).attr(`lang`)??`zh-CN`,v=[];return v=m.data.result.slice(0,c).map(e=>{let t=e.sTitle,i=e.sCreated,a=e.iDocID?`${e.iVideoId?`v/v2`:`news`}/detail.shtml?docid=${e.iDocID}`:void 0,o=e.sAuthor?[{name:e.sAuthor,avatar:e.sCreaterHeader}]:void 0,s=e.iDocID,c=e.sIMG?e.sIMG.startsWith(`http`)?e.sIMG:`https:${e.sIMG}`:void 0,u=e.updated??i;return{title:t,pubDate:i?r(n(i),8):void 0,link:a?new URL(a,l).href:void 0,author:o,guid:s,id:s,image:c,banner:c,updated:u?r(n(u),8):void 0,language:_}}),v=(await Promise.all(v.map(i=>i.link?t.tryGet(i.link,async()=>{let t=(await e(p,{query:{type:0,docid:i.guid}}))?.data?.result??void 0;if(!t)return i;let a=t.sTitle,o=t.sContent,s=t.sCreated,c=t.iDocID?`${t.iVideoId?`v/v2`:`news`}/detail.shtml?docid=${t.iDocID}`:void 0,u=t.sAuthor?[{name:t.sAuthor,avatar:t.sCreaterHeader}]:void 0,d=`qq-lol-${t.iDocID}`,f=t.sIMG?t.sIMG.startsWith(`http`)?t.sIMG:`https:${t.sIMG}`:void 0,m=t.sIdxTime??s,h={title:a,description:o,pubDate:s?r(n(s),8):void 0,link:c?new URL(c,l).href:void 0,author:u,guid:d,id:d,content:{html:o,text:o},image:f,banner:f,updated:m?r(n(m),8):void 0,language:_};return{...i,...h}}):i))).filter(e=>!0),{title:`${g(`div.website-path a`).toArray().map(e=>g(e).text()).join(``)} - ${g(`li[data-newsId="${s}"]`).text()}`,description:g(`meta[name="Description"]`).attr(`content`),link:d,item:v,allowEmpty:!0,image:`https:${g(`a.logo img`).attr(`src`)}`,author:g(`meta[name="author"]`).attr(`content`),language:_,id:d}},c={path:`/lol/news/:category?`,name:`英雄联盟新闻`,url:`lol.qq.com`,maintainers:[`nczitzk`],handler:s,example:`/qq/lol/news`,parameters:{category:"分类，默认为 `23`，即综合，见下表"},description:"::: tip\n若订阅 [英雄联盟首页新闻列表 - 公告](https://lol.qq.com/news/index.shtml)，网址为 `https://lol.qq.com/news/index.shtml`，请选择 `24` 作为 `category` 参数填入，此时目标路由为 [`/qq/lol/news/24`](https://rsshub.app/qq/lol/news/24)。\n:::\n\n| 综合 | 公告 | 赛事 | 攻略 | 社区 |\n| ---- | ---- | ---- | ---- | ---- |\n| 23   | 24   | 25   | 27   | 28   |\n",categories:[`game`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{title:`综合`,source:[`lol.qq.com/news/index.shtml`],target:`/lol/news/23`},{title:`公告`,source:[`lol.qq.com/news/index.shtml`],target:`/lol/news/24`},{title:`赛事`,source:[`lol.qq.com/news/index.shtml`],target:`/lol/news/25`},{title:`攻略`,source:[`lol.qq.com/news/index.shtml`],target:`/lol/news/27`},{title:`社区`,source:[`lol.qq.com/news/index.shtml`],target:`/lol/news/28`}],view:i.Articles};export{s as handler,c as route};