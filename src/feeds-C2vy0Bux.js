import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-BpwDbAkH.js";import"./logger-B3QfaIfn.js";import"./ofetch-TsvCL7Kz.js";import"./helpers-LVq640iW.js";import{cache_default as n}from"./cache-CzcusEyX.js";import{art as r}from"./render-DE4LRFBD.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import"./got-lNAQakSo.js";import{ViewType as a}from"./types-Bi82qguM.js";import{getFeed as o,getFeedGenerator as s,resolveHandle as c}from"./utils-DNidXAOp.js";import l from"node:path";t();const u={path:`/profile/:handle/feed/:space/:routeParams?`,categories:[`social-media`],view:a.SocialMedia,example:`/bsky.app/profile/jaz.bsky.social/feed/cv:cat`,parameters:{handle:`User handle, can be found in URL`,space:`Space ID, can be found in URL`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`Feeds`,maintainers:[`FerrisChi`],handler:d};async function d(t){let a=t.req.param(`handle`),u=t.req.param(`space`),d=await c(a,n.tryGet),f=`at://${d}/app.bsky.feed.generator/${u}`,p=await s(f,n.tryGet),m=await o(f,n.tryGet),h=m.feed.map(({post:t})=>({title:t.record.text.split(`
`)[0],description:r(l.join(e,`templates/post-7b0043bb.art`),{text:t.record.text.replaceAll(`
`,`<br>`),embed:t.embed}),author:t.author.displayName,pubDate:i(t.record.createdAt),link:`https://bsky.app/profile/${t.author.handle}/post/${t.uri.split(`app.bsky.feed.post/`)[1]}`,upvotes:t.likeCount,comments:t.replyCount}));return t.set(`json`,{DID:d,profile:p,feeds:m}),{title:`${p.view.displayName} â€” Bluesky`,description:p.view.description?.replaceAll(`
`,` `),link:`https://bsky.app/profile/${a}/feed/${u}`,image:p.view.avatar,icon:p.view.avatar,logo:p.view.avatar,item:h,allowEmpty:!0}}export{u as route};