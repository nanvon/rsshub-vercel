import{t as e}from"./cache-Bv3_kFbE.mjs";import{n as t,t as n}from"./parse-date-_GmTZfjS.mjs";import{t as r}from"./got-BglkE51W.mjs";import{t as i}from"./timezone-BAp4uBjD.mjs";import{load as a}from"cheerio";function o(o){return o.link?e.tryGet(o.link,async()=>{try{let e=a((await r({method:`get`,url:o.link})).data),s=e(`.bbs-user-info-name, .bbs-user-wrapper-content-name-span`).text(),c=e(`.second-line-user-info span:not([class])`).text(),l=new Date().getFullYear(),u=new Date,d=/^(\d{2})-(\d{2}) (\d{2}):(\d{2})$/,f=/^(\d{1,2}):(\d{2})$/,p=c;d.test(c)?p=`${l}-${c}`:f.test(c)&&(p=`${l}-${String(u.getMonth()+1).padStart(2,`0`)}-${String(u.getDate()).padStart(2,`0`)} ${c}`);let m=[o.pubDate,i(n(p),8),i(t(c),8)].find(e=>e instanceof Date&&!Number.isNaN(e.getTime())),h=e(`.basketballTobbs_tag > a, .tag-player-team`).toArray().map(t=>e(t).text()).filter(Boolean);e(`.basketballTobbs_tag`).remove(),e(`.hupu-img`).each(function(){let t=e(this).attr(`data-gif`)||e(this).attr(`data-origin`)||e(this).attr(`src`);e(this).parent().html(`<img src="${t}">`)});let g=[],_=e(`#bbs-thread-content, .bbs-content-font`).html();_&&g.push(_);let v=e(`.header-video-wrapper`);if(v.length>0){let e=v.find(`video`);if(e.length>0){let t=e.prop(`outerHTML`);t&&g.push(t)}}let y=g.length>0?g.join(``):void 0;return{...o,author:s,category:h.length>0?h:o.category,description:y,pubDate:m}}catch{return o}}):Promise.resolve(o)}export{o as t};