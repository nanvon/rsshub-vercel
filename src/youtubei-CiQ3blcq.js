import{cache_default as e}from"./cache-Dfid4xgQ.js";import{parseRelativeDate as t}from"./parse-date-DHsdom8D.js";import{getSrtAttachmentBatch as n,getVideoUrl as r,utils_default as i}from"./utils-Br-x323n.js";import{Innertube as a}from"youtubei.js";const o=a.create(),s=t=>e.tryGet(`youtube:getChannelIdByUsername:${t}`,async()=>(await(await o).resolveURL(`https://www.youtube.com/${t}`)).payload.browseId),c=async({username:e,embed:t,filterShorts:n})=>l({channelId:await s(e),embed:t,filterShorts:n}),l=async({channelId:e,embed:a})=>{let s=await(await o).getChannel(e),c=await s.getVideos(),l=await n(c.videos.filter(e=>`video_id`in e).map(e=>e.video_id));return{title:`${s.metadata.title||e} - YouTube`,link:`https://www.youtube.com/channel/${e}`,image:s.metadata.avatar?.[0].url,description:s.metadata.description,item:await Promise.all(c.videos.filter(e=>`video_id`in e).map(e=>{let n=l[e.video_id]||[],o=`best_thumbnail`in e?e.best_thumbnail?.url:`thumbnails`in e?e.thumbnails?.[0]?.url:void 0;return{title:e.title.text||`YouTube Video ${e.video_id}`,description:`description_snippet`in e?i.renderDescription(a,e.video_id,o,i.formatDescription(e.description_snippet?.toHTML())):null,link:`https://www.youtube.com/watch?v=${e.video_id}`,author:typeof e.author==`string`?e.author:e.author.name===`N/A`?void 0:e.author.name,image:o,pubDate:`published`in e&&e.published?.text?t(e.published.text):void 0,attachments:[{url:r(e.video_id),mime_type:`text/html`,duration_in_seconds:e.duration&&`seconds`in e.duration?e.duration.seconds:void 0},...n]}}))}},u=async({playlistId:e,embed:n})=>{let a=await(await o).getPlaylist(e),s=await a.videos;return{title:`${a.info.title||e} by ${a.info.author.name} - YouTube`,link:`https://www.youtube.com/playlist?list=${e}`,image:a.info.thumbnails?.[0].url,description:a.info.description||`${a.info.title} by ${a.info.author.name}`,item:s.filter(e=>`id`in e).map(e=>{let a=`best_thumbnail`in e?e.best_thumbnail?.url:e.thumbnails?.[0]?.url;return{title:e.title.text||`YouTube Video ${e.id}`,description:i.renderDescription(n,e.id,a,``),link:`https://www.youtube.com/watch?v=${e.id}`,pubDate:`published`in e&&e.published?.text?t(e.published.text):void 0,author:`author`in e?[{name:e.author.name,url:e.author.url,avatar:e.author.thumbnails?.[0]?.url}]:void 0,image:a,attachments:[{url:r(e.id),mime_type:`text/html`,duration_in_seconds:`duration`in e&&e.duration&&`seconds`in e.duration?e.duration.seconds:void 0}]}})}};export{l as getDataByChannelId,u as getDataByPlaylistId,c as getDataByUsername};