import"./esm-shims-2LyWUseo.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as e}from"./ofetch-BLnIkXRv.js";import{cache_default as t}from"./cache-Dfid4xgQ.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{timezone as r}from"./timezone-CMz5pnRe.js";import i from"dayjs";import a from"dayjs/plugin/duration.js";import{load as o}from"cheerio";i.extend(a);const s={path:`/explore/:type`,categories:[`multimedia`],example:`/podwise/explore/latest`,parameters:{type:`latest or all episodes.`},radar:[{source:[`podwise.ai/explore/:type`]}],name:`Episodes`,maintainers:[`lyling`],handler:async i=>{let a=`https://podwise.ai/explore/${i.req.param(`type`)}`,s=await e(a),u=o(s),d=u(`#navigator`).next(),f=d.find(`h1`).first().text(),p=d.find(`p`).eq(1).text(),m=d.find(`.group`).toArray().map(e=>{e=u(e);let t=e.find(`a`).first().attr(`href`),i=e.find(`p`).first().text(),a=e.find(`a`).next().children(`span`).text();return{link:`https://podwise.ai${t}`,description:i,pubDate:r(n(a,`DD MMM YYYY`,`en`),8)}}),h=await Promise.all(m.map(n=>t.tryGet(n.link,async()=>{let t=await e(n.link),r=o(t);n.description=r(`summary`).first().html();let i=r(`img[alt="Podcast cover"]`).eq(1).next().find(`span`).eq(2),a=JSON.parse(r(`script:contains("podName")`).first().text().match(/self\.__next_f\.push\((.+)\)/)?.[1]??``),s=JSON.parse(a[1].slice(2))[1][3].children[3].episode;return n.title=s.title,n.author=s.podName,n.itunes_item_image=s.cover,n.itunes_duration=c(i.text()),n.enclosure_url=s.link,n.enclosure_type=l(s.linkType),n})));return{title:f,description:p,link:a,item:h}}};function c(e){let t=e.match(/(\d+h)?(\d+m)?/),n=t[1]?Number.parseInt(t[1]):0,r=t[2]?Number.parseInt(t[2]):0;return i.duration({hours:n,minutes:r}).asSeconds()}function l(e){switch(e){case`mp3`:return`audio/mpeg`;case`m4a`:return`audio/x-m4a`;case`mp4`:return`video/mp4`;default:return e}}export{s as route};