import{n as e,t}from"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t as n}from"./ofetch-CfXAR0UO.js";import{t as r}from"./cache-CpEhLexq.js";import{t as i}from"./render-d6AVTUl2.js";import{t as a}from"./parse-date-CHEO0z5G.js";import{t as o}from"./timezone-BPfwRbwD.js";import s from"node:path";import{load as c}from"cheerio";e();const l=e=>i(s.join(t,`templates/mod-810bfe96.art`),{mod:e}),u={path:`/:type`,categories:[`game`],example:`/mcmod/new`,parameters:{type:`查询类型，详见下表`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`最新MOD`,maintainers:[`hualiong`],description:`\`:type\` 类型可选如下

| 随机显示MOD | 最新收录MOD | 最近编辑MOD |
| ------ | --- | ---- |
| random | new | edit |`,handler:async e=>{let t=e.req.param(`type`),i=n.create({baseURL:`https://www.mcmod.cn`}),s=c(await i(`/`)),u=s(`div.left > ul > li[i='${t}']`).attr(`title`),d=s(`#indexNew_${t} > .block`).toArray().map(e=>{let t=s(e),n=t.find(`div .time`);return{title:t.find(`div > .name > a`).text(),image:t.find(`img`).attr(`src`)?.split(`@`)[0],link:t.children(`a`).attr(`href`),pubDate:n.attr(`title`)&&o(a(n.attr(`title`).slice(6),`YYYY-MM-DD HH:mm:ss`),8)}}),f=await Promise.all(d.map(e=>r.tryGet(e.link,async()=>{let t=c(await i(e.link));e.author=t(`.author li`).toArray().map(e=>{let n=t(e),r=n.find(`.name a`);return{name:r.text(),url:`https://www.mcmod.cn`+r.attr(`href`),avatar:n.find(`.avatar img`).attr(`src`)?.split(`?`)[0]}});let n=t(`.common-text[data-id="1"]`).html(),r=t(`.mcver > ul > ul`).toArray().map(e=>{let n=t(e);return{label:n.children(`li:first-child`).text(),versions:n.children(`li:not(:first-child)`).toArray().map(e=>t(e).text()).join(`，`)}});return e.description=l({pic:`https:`+e.image,label:t(`.class-info  li.col-lg-4`).toArray().map(e=>t(e).text()),support:r})+n.replaceAll(/\ssrc=".+?"/g,``).replaceAll(`data-src`,`src`),e})));return{title:`${u} - MC百科`,description:s(`meta[name="description"]`).attr(`content`),link:`https://www.mcmod.cn`,item:f}}};export{u as route};