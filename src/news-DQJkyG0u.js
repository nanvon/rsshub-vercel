import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-BL2l-VlN.js";import"./logger-DWogN5HJ.js";import{ofetch_default as n}from"./ofetch-e4r9n7lx.js";import{cache_default as r}from"./cache-BjesfGXD.js";import{art as i}from"./render-CSnicFA3.js";import{parseDate as a}from"./parse-date-DHsdom8D.js";import{timezone as o}from"./timezone-CMz5pnRe.js";import{ViewType as s}from"./types-Bi82qguM.js";import{invalid_parameter_default as c}from"./invalid-parameter-B0jPSaWz.js";import l from"node:path";import{load as u}from"cheerio";t();const d={newslist:`newsList`,r18list:`newsPornList`},f=async t=>{let{type:s=`newslist`,category:f=`all`}=t.req.param();if(!d.hasOwnProperty(s))throw new c(`Invalid type: ${s}`);let p=Number.parseInt(t.req.query(`limit`)??`30`,10),m=`https://news.gamebase.com.tw`,h=new URL(`news${f===`all`?``:`/newslist?type=${f}`}`,m).href,g=new URL(`api/news/getNewsList`,`https://api.gamebase.com.tw`).href,_=await n(g,{method:`post`,body:{GB_type:d[s],category:f,page:1}}),v=await n(h),y=u(v),b=y(`html`).attr(`lang`)??`zh-TW`,x=await Promise.all(_.return_msg?.list?.slice(0,p).map(t=>r.tryGet(`gamebase-news-${t.news_no}`,async()=>{let r=t.news_title,s=t.post_time,c=t.news_no?`news/detail/${t.news_no}`:void 0,u=[t.system],d=t.nickname,f=`gamebase-news-${t.news_no}`,p=t.news_img,h=t.updated??s,g=t.news_meta?.meta_des;g||(g=((await n(t.link)).match(/(\\u003C.*?)","/)?.[1]??``).replaceAll(String.raw`\"`,`"`).replaceAll(/\\u([\da-f]{4})/gi,(e,t)=>String.fromCodePoint(Number.parseInt(t,16))));let _=i(l.join(e,`templates/description-881baa33.art`),{images:p&&!g?[{src:p,alt:r}]:void 0,intro:t.news_short_desc,description:g});return{title:r,description:_,pubDate:s?o(a(s),8):void 0,link:c?new URL(c,m).href:void 0,category:u,author:d,guid:f,id:f,content:{html:_,text:_},image:p,banner:p,updated:h?o(a(h),8):void 0,language:b}}))??[]);return{title:y(`title`).text(),description:y(`meta[property="og:description"]`).attr(`content`),link:h,item:x,allowEmpty:!0,image:y(`meta[property="og:image"]`).attr(`content`),author:y(`meta[property="og:title"]`).attr(`content`)?.split(/\|/).pop()?.trim(),language:b,id:y(`meta[property="og:url"]`).attr(`content`)}},p={path:`/news/:type?/:category?`,name:`新聞`,url:`news.gamebase.com.tw`,maintainers:[`nczitzk`],handler:f,example:`/gamebase/news`,parameters:{type:`類型，見下表，預設為 newslist`,category:"分類，預設為 `all`，即全部，可在對應分類頁 URL 中找到"},description:":::tip\n若訂閱 [手機遊戲新聞](https://news.gamebase.com.tw/news/newslist?type=mobile)，網址為 `https://news.gamebase.com.tw/news/newslist?type=mobile`，請截取 `https://news.gamebase.com.tw/news/` 到末尾的部分 `newslist` 作為 `type` 參數填入，`mobile` 作為 `category` 參數填入，此時目標路由為 [`/gamebase/news/newslist/mobile`](https://rsshub.app/gamebase/news/newslist/mobile)。\n:::\n\n| newslist | r18list |\n| -------- | ------- |\n",categories:[`game`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`news.gamebase.com.tw/news`,`news.gamebase.com.tw/news/:type`],target:(e,t)=>{let n=e.type,r=new URL(t).searchParams.get(`type`)??void 0;return`/gamebase/news${n?`/${n}${r?`/${r}`:``}`:``}`}}],view:s.Articles,zh:{path:`/news/:type?/:category?`,name:`新闻`,url:`news.gamebase.com.tw`,maintainers:[`nczitzk`],handler:f,example:`/gamebase/news`,parameters:{type:`类型，见下表，默认为 newslist`,category:"分类，默认为 `all`，即全部，可在对应分类页 URL 中找到"},description:":::tip\n若订阅 [手机游戏新闻](https://news.gamebase.com.tw/news/newslist?type=mobile)，网址为 `https://news.gamebase.com.tw/news/newslist?type=mobile`，请截取 `https://news.gamebase.com.tw/news/` 到末尾的部分 `newslist` 作为 `type` 参数填入，`mobile` 作为 `category` 参数填入，此时目标路由为 [`/gamebase/news/newslist/mobile`](https://rsshub.app/gamebase/news/newslist/mobile)。\n:::\n\n| newslist | r18list |\n| -------- | ------- |\n"}};export{f as handler,p as route};