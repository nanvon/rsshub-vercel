import{n as e,t}from"./esm-shims-CMsyBHYK.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t as n}from"./ofetch-CRUPiVpr.js";import{t as r}from"./cache-CpEhLexq.js";import{t as i}from"./render-d6AVTUl2.js";import{t as a}from"./parse-date-CHEO0z5G.js";import{t as o}from"./timezone-BPfwRbwD.js";import{t as s}from"./types-Bn7An2Wc.js";import c from"node:path";import{load as l}from"cheerio";e();const u=async e=>{let{id:s}=e.req.param(),u=Number.parseInt(e.req.query(`limit`)??`12`,10),d=`https://www.scientificamerican.com`,f=new URL(`podcast${s?`/${s}`:`s`}/`,d).href,p=await n(f),m=l(p),h=m(`html`).attr(`lang`)??`en`,g=p.match(/window\.__DATA__=JSON\.parse\(`(.*?)`\)/)?.[1],_=g?JSON.parse(g.replaceAll(`\\\\`,`\\`)):void 0,v=[];return v=_?_.initialData.props.results.slice(0,u).map(e=>{let n=e.title,r=e.image_url,s=i(c.join(t,`templates/description-161a46b8.art`),{images:r?[{src:r,alt:e.image_alt_text||n,width:e.image_width,height:e.image_height}]:void 0,intro:e.summary}),l=e.date_published,u=e.url,f=[...new Set([e.category,e.subtype,e.column,e.digital_column].filter(Boolean))],p=e.authors.map(e=>({name:e.name,url:e.url?new URL(e.url,d).href:void 0,avatar:e.picture_file})),m=`-${e.id}`,g=e.release_date??l,_={title:n,description:s,pubDate:l?o(a(l),8):void 0,link:u?new URL(u,d).href:void 0,category:f,author:p,doi:e.article_doi,guid:m,id:m,content:{html:s,text:e.summary??s},image:r,banner:r,updated:g?o(a(g),8):void 0,language:h},v=e.media_url;if(v){let e=`audio/${v.replace(/\?.*$/,``).split(/\./).pop()}`;_={..._,enclosure_url:v,enclosure_type:e,enclosure_title:n,itunes_item_image:r}}return _}):[],v=(await Promise.all(v.map(e=>e.link?r.tryGet(e.link,async()=>{let r=(await n(e.link)).match(/window\.__DATA__=JSON\.parse\(`(.*?)`\)/)?.[1],s=r?JSON.parse(r.replaceAll(`\\\\`,`\\`)):void 0;if(!s)return e;let l=s.initialData.article,u=l.title,f=l.image_url,p=i(c.join(t,`templates/description-161a46b8.art`),{images:f?[{src:f,alt:l.image_alt_text||u,width:l.image_width,height:l.image_height}]:void 0,intro:l.summary,content:l.content}),m=l.published_at_date_time,g=[...new Set([l.display_category,l.primary_category,l.subcategory,...l.categories??[],l.podcast_series_name])],_=l.authors.map(e=>({name:e.name,url:e.url?new URL(e.url,d).href:void 0,avatar:e.picture_file})),v=`scientificamerican-${l.id}`,y=l.updated_at_date_time??m,b={title:u,description:p,pubDate:m?o(a(m),8):void 0,category:g,author:_,doi:l.article_doi,guid:v,id:v,content:{html:p,text:l.summary??p},image:f,banner:f,updated:y?o(a(y),8):void 0,language:h},x=l.media_url;if(x){let e=`audio/${x.replace(/\?.*$/,``).split(/\./).pop()}`;b={...b,enclosure_url:x,enclosure_type:e,enclosure_title:u,itunes_item_image:f}}return{...e,...b}}):e))).filter(e=>!0),{title:m(`title`).text(),description:m(`meta[name="description"]`).attr(`content`),link:f,item:v,allowEmpty:!0,image:m(`meta[property="og:image"]`).attr(`content`),author:m(`meta[property="og:site_name"]`).attr(`content`),language:h,feedLink:m(`link[type="application/rss+xml"]`).attr(`href`),itunes_author:m(`meta[property="og:site_name"]`).attr(`content`),itunes_category:`Science`,id:m(`meta[property="og:url"]`).attr(`content`)}},d={path:`/podcast/:id?`,name:`Podcasts`,url:`www.scientificamerican.com`,maintainers:[`nczitzk`],handler:u,example:`/scientificamerican/podcast`,parameters:{id:`ID, see below`},description:"::: tip\nIf you subscribe to [Science Quickly](https://www.scientificamerican.com/podcast/science-quickly/)，where the URL is `https://www.scientificamerican.com/podcast/science-quickly/`, extract the part `https://www.scientificamerican.com/podcast/` to the end, which is `science-quickly`, and use it as the parameter to fill in. Therefore, the route will be [`/scientificamerican/podcast/science-quickly`](https://rsshub.app/scientificamerican/podcast/science-quickly).\n:::\n\n| All | Science Quickly | Uncertain    |\n| --- | --------------- | ------------ |\n|     | science-quickly | science-talk |\n",categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.scientificamerican.com/podcasts/`,`www.scientificamerican.com/podcast/:id`],target:e=>{let t=e.id;return`/scientificamerican/podcast${t?`/${t}`:``}`}},{title:`Science Quickly`,source:[`www.scientificamerican.com/podcast/science-quickly/`],target:`/podcast/science-quickly`},{title:`Uncertain`,source:[`www.scientificamerican.com/podcast/science-talk/`],target:`/podcast/science-talk`}],view:s.Articles,zh:{path:`/podcast/:id?`,name:`Podcasts`,url:`www.scientificamerican.com`,maintainers:[`nczitzk`],handler:u,example:`/scientificamerican/podcast`,parameters:{id:`ID，见下表`},description:"::: tip\n若订阅 [Science Quickly](https://www.scientificamerican.com/podcast/science-quickly/)，网址为 `https://www.scientificamerican.com/podcast/science-quickly/`，请截取 `https://www.scientificamerican.com/podcast/` 到末尾 `/` 的部分 `science-quickly` 作为 `id` 参数填入，此时目标路由为 [`/scientificamerican/podcast/science-quickly`](https://rsshub.app/scientificamerican/podcast/science-quickly)。\n:::\n\n| 全部 | Science Quickly | Uncertain    |\n| ---- | --------------- | ------------ |\n|      | science-quickly | science-talk |\n"}};export{u as handler,d as route};