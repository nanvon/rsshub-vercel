import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import"./dist-CRTt8uUM.js";import{cache_default as e}from"./cache-Sft5n2jg.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-BHWobzJG.js";import{load as r}from"cheerio";const i={name:`投稿`,categories:[`reading`],path:`/works/:id`,example:`/kakuyomu/works/1177354054894027232`,parameters:{id:`投稿 ID`},maintainers:[`KarasuShin`],handler:a,features:{supportRadar:!0},radar:[{source:[`kakuyomu.jp/works/:id`],target:`/works/:id`}]};async function a(i){let a=i.req.param(`id`),o=`https://kakuyomu.jp/works/${a}`,s=Number.parseInt(i.req.query(`limit`)||`10`),c=r(await n(o)),l=JSON.parse(c(`#__NEXT_DATA__`).text()),{props:{pageProps:{__APOLLO_STATE__:u}}}=l,{[`Work:${a}`]:{title:d,catchphrase:f}}=u,p=Object.values(u),m=p.filter(e=>e.__typename===`Episode`),h=await Promise.all(m.sort((e,t)=>t.publishedAt.localeCompare(e.publishedAt)).slice(0,s).map(i=>{let o=`https://kakuyomu.jp/works/${a}/episodes/${i.id}`;return e.tryGet(o,async()=>{let e=r(await n(o)),a=e(`.widget-episodeBody`).html();return{title:i.title,link:o,description:a,pubDate:t(i.publishedAt),guid:i.id}})}));return{title:d,link:o,description:f,item:h}}export{i as route};