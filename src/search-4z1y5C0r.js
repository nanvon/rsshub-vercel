import{n as e,t}from"./esm-shims-mGm6WwCc.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-BASlBuka.js";import"./helpers-Cqaav28H.js";import{t as n}from"./render-d6AVTUl2.js";import{t as r}from"./parse-date-CHEO0z5G.js";import{t as i}from"./got-CgQXMNWI.js";import{t as a}from"./timezone-BPfwRbwD.js";import o from"node:path";import{load as s}from"cheerio";import c from"iconv-lite";e();const l={path:`/tieba/search/:qw/:routeParams?`,categories:[`bbs`],example:`/baidu/tieba/search/neuro`,parameters:{qw:`搜索关键词`,routeParams:`额外参数；请参阅以下说明和表格`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`贴吧搜索`,maintainers:[`JimenezLi`],handler:u,description:`| 键           | 含义                                                       | 接受的值      | 默认值 |
| ------------ | ---------------------------------------------------------- | ------------- | ------ |
| kw           | 在名为 kw 的贴吧中搜索                                     | 任意名称 / 无 | 无     |
| only_thread  | 只看主题帖，默认为 0 关闭                                  | 0/1           | 0      |
| rn           | 返回条目的数量                                             | 1-20          | 20     |
| sm           | 排序方式，0 为按时间顺序，1 为按时间倒序，2 为按相关性顺序 | 0/1/2         | 1      |

  用例：\`/baidu/tieba/search/neuro/kw=neurosama&only_thread=1&sm=2\``};async function u(e){let l=e.req.param(`qw`),u=new URLSearchParams(e.req.param(`routeParams`));u.set(`ie`,`utf-8`),u.set(`qw`,l),u.set(`rn`,u.get(`rn`)||`20`);let d=`https://tieba.baidu.com/f/search/res?${u.toString()}`,f=await i.get(d,{headers:{Referer:`https://tieba.baidu.com`},responseType:`buffer`}),p=s(c.decode(f.data,`gbk`)),m=p(`div.s_post`);return{title:`${l} - ${u.get(`kw`)||`百度贴`}吧搜索`,link:d,item:m.toArray().map(e=>{let i=p(e),s=i.find(`.p_title a`),c=s.text().trim(),l=s.attr(`href`),u=i.find(`.p_date`).text().trim(),d=i.find(`.p_content`).text().trim(),f=i.find(`.p_mediaCont img`).toArray().map(e=>`<img src="${p(e).attr(`original`)}">`).join(``),m=i.find(`a.p_forum`).text().trim(),h=i.find(`a`).last().text().trim();return{title:c,description:n(o.join(t,`templates/tieba_search-a766b6b5.art`),{details:d,medias:f,tieba:m,author:h}),author:h,pubDate:a(r(u,`YYYY-MM-DD HH:mm`),8),link:l}})}}export{l as route};