import{n as e,t}from"./esm-shims-mGm6WwCc.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-BASlBuka.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-CgQXMNWI.js";import{t as o}from"./invalid-parameter-CLGd_tte.js";import{n as s,t as c}from"./utils-djwnjyV6.js";import l from"node:path";import{load as u}from"cheerio";e();const d={1e3:`头条`,1003:`股市`,1135:`港股`,1007:`环球`,1005:`公司`,1118:`券商`,1110:`基金`,1006:`地产`,1032:`金融`,1119:`汽车`,1111:`科创`,1127:`创业版`,1160:`品见`,1124:`期货`,1176:`投教`},f={path:`/depth/:category?`,categories:[`finance`],example:`/cls/depth/1000`,parameters:{category:`分类代码，可在首页导航栏的目标网址 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`深度`,maintainers:[`nczitzk`],handler:p,description:`| 头条 | 股市 | 港股 | 环球 | 公司 | 券商 | 基金 | 地产 | 金融 | 汽车 | 科创 | 创业版 | 品见 | 期货 | 投教 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ------ | ---- | ---- | ---- |
| 1000 | 1003 | 1135 | 1007 | 1005 | 1118 | 1110 | 1006 | 1032 | 1119 | 1111 | 1127   | 1160 | 1124 | 1176 |`};async function p(e){let f=e.req.param(`category`)??`1000`,p=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):50,m=d[f];if(!m)throw new o(`Bad category. See <a href="https://docs.rsshub.app/routes/finance#cai-lian-she-shen-du">docs</a>`);let h=`${s}/v3/depth/home/assembled/${f}`,g=`${s}/depth?id=${f}`,_=await a({method:`get`,url:h,searchParams:c()}),v=[..._.data.data.top_article,..._.data.data.depth_list].slice(0,p).map(e=>({title:e.title||e.brief,link:`${s}/detail/${e.id}`,pubDate:i(e.ctime*1e3),author:e.source}));return v=await Promise.all(v.map(e=>n.tryGet(e.link,async()=>{let n=u((await a({method:`get`,url:e.link})).data),i=JSON.parse(n(`script#__NEXT_DATA__`).text()).props.initialState.detail.articleDetail;return e.author=i.author?.name??e.author??``,e.description=r(l.join(t,`templates/depth-39e6d921.art`),{articleDetail:i}),e}))),{title:`财联社 - ${m}`,link:g,item:v}}export{f as route};