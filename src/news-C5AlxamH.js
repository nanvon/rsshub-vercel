import"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t as e}from"./ofetch-CfXAR0UO.js";import{t}from"./cache-CpEhLexq.js";import{t as n}from"./parse-date-CHEO0z5G.js";import{t as r}from"./timezone-BPfwRbwD.js";import{n as i,r as a,t as o}from"./constants-CE29tomw.js";import*as s from"cheerio";const c=(e,t)=>{if(typeof e==`number`)return e;if(e===void 0)return t===void 0?NaN:t;let n=Number.parseInt(e,10);return t!==void 0&&Number.isNaN(n)?t:n},l=e=>a.includes(e),u=t=>t===o.Chinese?e(`https://media-cdn-mingchao.kurogame.com/akiwebsite/website2.0/json/G152/zh/ArticleMenu.json`,{query:{t:Date.now()}}):e(`https://hw-media-cdn-mingchao.kurogame.com/akiwebsite/website2.0/json/G152/${t}/MainMenu.json`).then(e=>e.article),d=(e,t)=>e===o.Chinese?`https://media-cdn-mingchao.kurogame.com/akiwebsite/website2.0/json/G152/zh/article/${t}.json`:`https://hw-media-cdn-mingchao.kurogame.com/akiwebsite/website2.0/json/G152/${e}/article/${t}.json`,f=(e,t)=>e===o.Chinese?`https://mc.kurogames.com/main/news/detail/${t}`:`https://wutheringwaves.kurogames.com/${e}/main/news/detail/${t}`,p=e=>{switch(e){case o.English:return`en`;case o.Chinese:return`zh-CN`;case o.ChineseTaiwan:return`zh-TW`;case o.French:return`fr`;case o.German:return`de`;case o.Japanese:return`ja`;case o.Korean:return`ko`;case o.Spanish:return`es`;default:throw Error(`Could not resolve handler language from "${e}"`)}},m={path:`/wutheringwaves/news/:${i.Language}?`,categories:[`game`],example:`/kurogames/wutheringwaves/news`,parameters:{[i.Language]:"The language to use for the content. Default: `zh`."},name:`鸣潮 — 游戏公告、新闻与活动`,radar:[{source:[`mc.kurogames.com/m/main/news`,`mc.kurogames.com/main`]},{title:`Wuthering Waves — Game announcements, news and events`,source:[`wutheringwaves.kurogames.com/en/main/news`,`wutheringwaves.kurogames.com/en/main`]}],maintainers:[`goestav`,`enpitsulin`],description:`
Language codes for the \`${i.Language}\` parameter:

| Language | Code         |
|----------|--------------|
| English  | en           |
| 日本語    | jp           |
| 한국어     | kr           |
| 简体中文   | zh (default) |
| 繁體中文   | zh-tw        |
| Español  | es           |
| Français | fr           |
| Deutsch  | de           |
    `,async handler(m){let h=m.req.query(i.Limit),g=m.req.param(i.Language),_=c(h,30),v=g||o.Chinese;if(!l(v))throw TypeError(`Language parameter is not valid. Please use one of the following: ${a.join(`, `)}`);let y=(await u(v)).filter(e=>e.articleType!==0).slice(0,_),b=await Promise.all(y.map(i=>{let a=d(v,i.articleId),o={title:i.articleTitle,pubDate:r(n(i.createTime),8),link:f(v,i.articleId)};return t.tryGet(`wutheringwaves:${v}:${i.articleId}`,async()=>{let t=(await e(a,{query:{t:Date.now()}})).articleContent??``;return o.description=s.load(t).html()??i.articleDesc??``,o})}));return{title:v===o.Chinese?`《鸣潮》— 游戏公告、新闻和活动`:`Wuthering Waves - Announcements, News and Events`,link:v===o.Chinese?`https://mc.kurogames.com/main#news`:`https://wutheringwaves.kurogames.com/${v}/main/#news`,item:b,language:p(v)}}};export{m as route};