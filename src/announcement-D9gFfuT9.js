import"./esm-shims-B6VgfGYP.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as e}from"./ofetch-D4MiciTC.js";import{cache_default as t}from"./cache-Dfid4xgQ.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{ViewType as r}from"./types-Bi82qguM.js";import*as i from"cheerio";const a={"new-cryptocurrency-listing":48,"latest-binance-news":49,"latest-activities":93,"new-fiat-listings":50,"api-updates":51,"crypto-airdrop":128,"wallet-maintenance-updates":157,delisting:161};function o(e){return!(!e||typeof e!=`object`||!(`reactRoot`in e)||!Array.isArray(e.reactRoot)||e.reactRoot?.[0]?.id!==`Fragment`)}function s(e){return!(!e||typeof e!=`object`||!(`config`in e)||!(`list`in e.config))}const c={path:`/announcement/:type`,categories:[`finance`],view:r.Articles,example:`/binance/announcement/new-cryptocurrency-listing`,parameters:{type:{description:`Binance Announcement type`,default:`new-cryptocurrency-listing`,options:[{value:`new-cryptocurrency-listing`,label:`New Cryptocurrency Listing`},{value:`latest-binance-news`,label:`Latest Binance News`},{value:`latest-activities`,label:`Latest Activities`},{value:`new-fiat-listings`,label:`New Fiat Listings`},{value:`api-updates`,label:`API Updates`},{value:`crypto-airdrop`,label:`Crypto Airdrop`},{value:`wallet-maintenance-updates`,label:`Wallet Maintenance Updates`},{value:`delisting`,label:`Delisting`}]}},name:`Announcement`,description:`
Type category

 - new-cryptocurrency-listing => New Cryptocurrency Listing
 - latest-binance-news        => Latest Binance News
 - latest-activities          => Latest Activities
 - new-fiat-listings          => New Fiat Listings
 - api-updates                => API Updates
 - crypto-airdrop             => Crypto Airdrop
 - wallet-maintenance-updates => Wallet Maintenance Updates
 - delisting                  => Delisting
`,maintainers:[`enpitsulin`],handler:async r=>{let c=`https://www.binance.com`,l=`${c}/support/announcement`,{type:u}=r.req.param(),d=r.req.header(`Accept-Language`),f={Referer:c,"Accept-Language":d??`en-US,en;q=0.9`},p=await t.tryGet(`binance:announcements:${d}`,async()=>{let t=await e(l,{headers:f}),n=i.load(t),r=JSON.parse(n(`#__APP_DATA`).text()),a=Object.values(r.appState.loader.dataByRouteId).find(e=>`playlist`in e);if(!o(a.playlist))throw Error(`Get announcement config failed`);let c=a.playlist.reactRoot[0].children.find(e=>e.id===`TopicCardList`)?.props;if(!s(c))throw Error(`Can't get announcement config list`);return c.config.list}),m=a[u];if(!m)throw Error(`${u} is not supported`);let h=p.find(e=>e.url.includes(`c-${m}`));if(!h)throw Error(`Unexpected announcements config`);let g=new URL(h.url,c).toString(),_=await e(g,{headers:f}),v=i.load(_),y=JSON.parse(v(`#__APP_DATA`).text()),b=Object.values(y.appState.loader.dataByRouteId).find(e=>`catalogs`in e).catalogs.find(e=>e.catalogId===m),x=await Promise.all(b.articles.map(r=>{let a=`${l}/${r.code}`,o={title:r.title,link:a,description:r.title,pubDate:n(r.releaseDate)};return t.tryGet(`binance:announcement:${r.code}:${d}`,async()=>{let t=await e(a,{headers:f}),n=i.load(t)(`#support_article > div`).first();return n.find(`style`).remove(),o.description=n.html()??``,o})}));return{title:h.title,link:g,description:h.description,item:x}}};export{c as route};