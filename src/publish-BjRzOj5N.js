import"./esm-shims-Dqvxr0BZ.js";import{config as e}from"./config-BpwDbAkH.js";import"./logger-B3QfaIfn.js";import{ofetch_default as t}from"./ofetch-TsvCL7Kz.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{load as r}from"cheerio";const i=/([^/]+)\.md$/,a=e=>{let t=e.match(i);return t?t[1]:``},o={path:`/publish/:id`,categories:[`blog`],example:`/obsidian/publish/marshallontheroad`,parameters:{id:`网站 id，由Publish持有者自定义`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`publish.obsidian.md/`]}],name:`Publish`,maintainers:[`Xy2002`],handler:s,url:`publish.obsidian.md/`};async function s(e){let t=e.req.param(`id`),n=await c(t);return{title:`Obsidian Publish`,language:`en-us`,item:n,link:`https://publish.obsidian.md/`}}async function c(i){let o=`https://publish.obsidian.md/${i}`,s=await t(o),c=r(s),l=c(`script:contains("preloadCache")`).text().match(/preloadCache\s*=\s*f\("([^"]+)"\);/)?.[1]||``,u;try{u=await t(l,{headers:{"User-Agent":e.trueUA,Referer:`https://publish.obsidian.md/`,Origin:`https://publish.obsidian.m/`}})}catch{u={}}let d=Object.entries(u).map(([e,t])=>{if(!t)return null;let r={title:t.frontmatter?.title||a(e),link:`${o}/${e.replaceAll(` `,`+`).split(`.md`)[0]}`,pubDate:t.frontmatter?.[`date created`]?n(t.frontmatter[`date created`]):void 0,...t.frontmatter};return r}).filter(Boolean);return d}export{o as route};