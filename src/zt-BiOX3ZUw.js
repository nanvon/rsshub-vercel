import{__dirname as e,init_esm_shims as t}from"./esm-shims-DE2PJqdr.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-CJF2SF6b.js";import"./helpers-gUVC02jt.js";import{cache_default as n}from"./cache-Dfid4xgQ.js";import{art as r}from"./render-CSnicFA3.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import{got_default as a}from"./got-Baw2Nbdf.js";import{timezone as o}from"./timezone-CMz5pnRe.js";import s from"node:path";import{load as c}from"cheerio";t();const l=async t=>{let{id:l=`xijiayi`}=t.req.param(),u=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):50,d=`https://www.ithome.com`,f=new URL(`zt/${l}`,d).href,{data:p}=await a(f),m=c(p),h=`IT之家`,g=m(`div.newsbody`).slice(0,u).toArray().map(e=>{e=m(e);let t=e.find(`h2`).text(),n=e.find(`img`).prop(`data-original`)??e.find(`img`).prop(`src`);return{title:t,pubDate:o(i(e.find(`span.time script`).text().match(/'(.*?)'/)),8),link:e.find(`a`).first().prop(`href`),author:e.find(`div.editor`).contents().first().text(),image:n,banner:n,language:`zh`}});g=await Promise.all(g.map(t=>n.tryGet(t.link,async()=>{let{data:n}=await a(t.link),l=c(n);l(`p.ad-tips, a.topic-bar`).remove(),l(`div#paragraph p img`).each((t,n)=>{n=l(n);let i=n.prop(`data-original`);i&&n.replaceWith(r(s.join(e,`templates/description-463c9506.art`),{images:[{src:i,alt:n.prop(`alt`)}]}))});let u=l(`h1`).text(),d=l(`div#paragraph`).html(),f=l(`div#paragraph img`).first().prop(`src`);return t.title=u,t.description=d,t.pubDate=o(i(l(`span#pubtime_baidu`).text()),8),t.category=l(`div.cv a`).toArray().map(e=>l(e).text()).slice(1),t.author=l(`span#author_baidu`).contents().last().text()||l(`span#source_baidu`).contents().last().text()||l(`span#editor_baidu`).contents().last().text(),t.content={html:d,text:l(`div#paragraph`).text()},t.image=f,t.banner=f,t.language=`zh`,t})));let _=new URL(m(`meta[property="og:image"]`).prop(`content`),d).href;return{title:`${h} - ${m(`title`).text()}`,description:m(`meta[name="description"]`).prop(`content`),link:f,item:g,allowEmpty:!0,image:_,author:h,language:`zh`}},u={path:`/zt/:id?`,name:`专题`,url:`ithome.com`,maintainers:[`nczitzk`],handler:l,example:`/ithome/zt/xijiayi`,parameters:{category:`专题 id，默认为 xijiayi，即 [喜加一](https://www.ithome.com/zt/xijiayi)，可在对应专题页 URL 中找到`},description:`::: tip
  更多专题请见 [IT之家专题](https://www.ithome.com/zt)
:::`,categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`ithome.com/zt/:id`],target:`/zt/:id`}]};export{l as handler,u as route};