import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-BL2l-VlN.js";import"./logger-DWogN5HJ.js";import{ofetch_default as n}from"./ofetch-e4r9n7lx.js";import{cache_default as r}from"./cache-BjesfGXD.js";import{art as i}from"./render-CSnicFA3.js";import a from"node:path";import*as o from"cheerio";t();const s=t=>i(a.join(e,`templates/media-554156ec.art`),{video:{cover:t.posterImages?.full?.href||t.posterImages?.default?.href,src:t.links?.source.mezzanine?.href||t.links?.source.HD?.href||t.links?.source.full?.href||t.links?.source.href,title:t.title,description:t.description},image:{src:t.url,alt:t.alt,caption:t.caption,credit:t.credit}}),c=/inline\d+|alsosee/,l=/(photo|video)(\d+)/,u={path:`/news/:sport`,name:`News`,maintainers:[`weijianduan0302`],example:`/espn/news/nba`,categories:[`traditional-media`],parameters:{sport:`sport category, can be nba, nfl, mlb, nhl etc.`},description:`Get the news feed of the sport you love on ESPN.
| Sport                |  sport  |  Sport         |  sport  |
|----------------------|---------|----------------|---------|
| 🏀 NBA                | nba     | 🎾 Tennis       | tennis  |
| 🏀 WNBA               | wnba    | ⛳️ Golf         | golf    |
| 🏈 NFL                | nfl     | 🏏 Cricket      | cricket |
| ⚾️ MLB                | mlb     | ⚽️ Soccer       | soccer  |
| 🏒 NHL                | nhl     | 🏎️ F1           | f1      |
| ⛹️ College Basketball | ncb      | 🥊 MMA          | mma     |
| 🏟️️ College Football   | ncf     | 🏈 UFL          | ufl     |
| 🏉 Rugby              | rugby   | 🃏 Poker        | poker   |`,radar:[{source:[`espn.com/:sport*`],target:`/news/:sport`}],handler:async e=>{let{sport:t=`nba`}=e.req.param(),i=await n(`https://onefeed.fan.api.espn.com/apis/v3/cached/contentEngine/oneFeed/leagues/${t}?offset=0`,{headers:{accept:`application/json`}}),a=new Set([`HeadlineNews`,`Story`,`Media`,`Shortstop`]),u=i.feed.filter(e=>a.has(e.data.now[0].type)).map(e=>{let t=e.data.now[0],n=t.type;return{title:t.headline,link:t.links.web.href,author:t.byline,pubDate:e.date,description:n===`Media`?s(t.video[0]):n===`Shortstop`?t.headline:``}}),d=await Promise.all(u.map(e=>r.tryGet(e.link,async()=>{if(e.description===``){let t=await n(`${e.link}?xhr=1`,{headers:{accept:`application/json`}}),r=o.load(t.content.story,null,!1);r(`*`).each((e,n)=>{if(c.test(n.name)&&r(n).remove(),l.test(n.name)){let e=n.name.match(l)[1]===`photo`?`images`:`video`,i=Number.parseInt(n.name.match(l)[2])-1,a=t.content[e][i];a?r(n).replaceWith(s(a)):r(n).remove()}}),e.description=r.html()}return e})));return{title:`ESPN ${t.toUpperCase()} News`,link:`https://www.espn.com/espn/rss/${t}/news`,item:d}}};export{u as route};