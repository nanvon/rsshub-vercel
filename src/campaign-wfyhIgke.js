import"./esm-shims-mGm6WwCc.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-BASlBuka.js";import"./helpers-Cqaav28H.js";import{t as e}from"./got-CgQXMNWI.js";import{t}from"./invalid-parameter-CLGd_tte.js";import{load as n}from"cheerio";const r=`https://www.dlsite.com`,i={home:{type:`home`,name:`「DLsite 同人」`,url:`/home/fsr`,params:{campaign:`campaign`,work_category:[`doujin`],order:[`cstart_d`],per_page:30,show_type:1}},comic:{type:`comic`,name:`「DLsite コミック」`,url:`/comic/fsr`,params:{campaign:`campaign`,work_category:[`books`],order:[`cstart_d`],per_page:30,show_type:1}},soft:{type:`soft`,name:`「DLsite PCソフト」`,url:`/soft/fsr`,params:{campaign:`campaign`,work_category:[`pc`],order:[`cstart_d`],per_page:30,show_type:1}},maniax:{type:`maniax`,name:`「DLsite 同人 - R18」`,url:`/maniax/fsr`,params:{campaign:`campaign`,work_category:[`doujin`],order:[`cstart_d`],per_page:30,show_type:1}},books:{type:`books`,name:`「DLsite 成年コミック - R18」`,url:`/books/fsr`,params:{campaign:`campaign`,work_category:[`books`],order:[`cstart_d`],per_page:30,show_type:1}},pro:{type:`pro`,name:`「DLsite 美少女ゲーム」`,url:`/pro/fsr`,params:{campaign:`campaign`,work_category:[`pc`],order:[`cstart_d`],per_page:30,show_type:1}},girls:{type:`girls`,name:`「DLsite 乙女」`,url:`/girls/fsr`,params:{campaign:`campaign`,work_category:[`doujin`],order:[`cstart_d`],per_page:30,show_type:1}},bl:{type:`bl`,name:`「DLsite BL」`,url:`/bl/fsr`,params:{campaign:`campaign`,work_category:[`doujin`],order:[`cstart_d`],per_page:30,show_type:1}}},a=e=>{let t=`${e.url}/=/`,n=e.params;for(let e in n)if(Array.isArray(n[e]))for(let r in n[e])t+=`${e}[${r}]/${n[e][r]}/`;else t+=`${e}/${n[e]}/`;return t.slice(1)},o={path:`/campaign/:type/:free?`,categories:[`anime`],example:`/dlsite/campaign/home`,parameters:{type:{description:`类型`,options:Object.values(i).map(e=>({value:e.type,label:e.name}))},free:{description:`免费`,options:[{value:`1`,label:`是`}]}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1,nsfw:!0},name:`Discounted Works`,maintainers:[`cssxsh`],handler:s};async function s(o){let s=i[o.req.param(`type`)];if(s===void 0)throw new t(`不支持指定类型！`);o.req.param(`free`)!==void 0&&(s.params.is_free=1);let c=a(s),l=(await e(new URL(c,r),{method:`GET`})).data,u=n(l),d=`${s.name} | 割引中の作品`,f=u(`meta[name="description"]`).attr(`content`),p=u(`tr[class]`,`.n_worklist`).toArray().map(e=>{let t=u(`.work_name`,e).text(),n=u(`.work_name > a`,e).attr(`href`);return u(`a`,e).each((e,t)=>{u(t).attr(`target`,`_blank`)}),{title:t,link:n,description:u(e).html(),category:u(`a`,u(`.search_tag`,e)).toArray().map(e=>u(e).text()),author:u(`.maker_name`,e).text()}});return{title:d,link:`${r}/${c}`,description:f,language:`ja-jp`,allowEmpty:!0,item:p}}export{o as route};