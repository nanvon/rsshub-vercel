import"./esm-shims-Dqvxr0BZ.js";import"./config-BpwDbAkH.js";import"./logger-B3QfaIfn.js";import"./dist-BYIKqG8W.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import{toTitleCase as t}from"./common-utils-CvkwbCD5.js";import{ofetch_default as n}from"./ofetch-CSKgrsrO.js";import{load as r}from"cheerio";const i={path:`/:region/:eventType?/:includePromoted?`,categories:[`other`],example:`/eventbrite/canada--toronto/all-events`,parameters:{eventType:`category of events for filtering`,region:`Region or scope of events`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`eventbrite.com/d/:region/:eventType`],target:`/:region/:eventType`},{source:[`eventbrite.ca/d/:region/:eventType`],target:`/:region/:eventType`}],name:`Events`,maintainers:[`elibroftw`],handler:async i=>{let c=i.req.param(),{region:l,includePromoted:u=`false`}=c,d=c.eventType||`all-events`;d===`events`&&(d=`all-events`);let f=`https://www.eventbrite.com/d/${l}/${d}/`,p=await n(f),m=r(p),h=new URL(`https://www.eventbrite.com/api/v3/destination/events`),g=u!==`false`,_=m(`div.search-results-panel-content section>ul>li`).toArray().filter(e=>g||!m(e).text().includes(`Promoted`)),v=_.map(e=>m(e).find(`a.event-card-link`).first().attr(`data-event-id`));h.searchParams.append(`event_ids`,v.join(`,`)),h.searchParams.append(`page_size`,v.length.toString()),h.searchParams.append(`expand`,`image,primary_venue,ticket_availability,primary_organizer`);let y=(await n(h.href)).events,b=_.map((t,n)=>{let r=m(t),i=r.find(`.event-card-details a.event-card-link`).first(),c=i.attr(`aria-label`)||i.text()||i.toString(),l=y[n];if(l===void 0){let e=r.find(`p`);return{title:c,author:e.length>1?m(e[1]).text():void 0}}let u=r.text().includes(`Promoted`);return{title:u?`${l.name} (Promoted)`:l.name,link:l.url,pubDate:e(l.published),author:l.primary_organizer===void 0?JSON.stringify(l):l.primary_organizer.name,category:l.tags.map(e=>e.display_name),image:l.image.original.url,description:l.summary,id:l.eventbrite_event_id,content:{html:`${s(l)}<br>${a(l)}<br>${o(l)}`,text:``}}}),x=t(d.replaceAll(`-`,` `)),S=t(l.replaceAll(`-`,` `));return{title:`${x} in ${S}`,link:f,item:b}}};function a(e){return`<a href="${e.primary_organizer.url}">${e.primary_organizer.name}</a>`}function o(e){let t=e.ticket_availability.minimum_ticket_price.display,n=e.ticket_availability.maximum_ticket_price.display;return t===n?t:`${t} - ${n}`}function s(e){let t=e.end_date,n=e.start_date,r=e.start_time,i=e.end_time;return n===t?`${n} ${r} - ${i}`:`${n} ${r} - ${t} ${i}`}export{i as route};