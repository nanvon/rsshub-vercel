import{n as e,t}from"./esm-shims-CMsyBHYK.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CRUPiVpr.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-BlqYKpVp.js";import o from"node:path";import{load as s}from"cheerio";e();const c=async e=>{let{conference:c}=e.req.param(),l=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):12,u=`https://www.infoq.com`,d=new URL(`${c?`${c}/`:``}presentations/`,u).href,{data:f}=await a(d),p=s(f),m=p(`html`).prop(`lang`),h=p(`ul[data-tax="presentations"] li[data-path]`).slice(0,l).toArray().map(e=>{e=p(e);let n=e.find(`h3.card__title a`),a=n.prop(`title`)||n.text().trim(),s=e.find(`img.card__image`).prop(`src`),c=r(o.join(t,`templates/description-36fefaf3.art`),{images:s?[{src:s,alt:a}]:void 0,intro:e.find(`p.card__excerpt`).text()}),l=new URL(n.prop(`href`),u).href,d=`infoq-${e.prop(`data-path`).replace(/^\//,``)}`,f=e.find(`div.card__length`).text()||void 0;return{title:a,description:c,pubDate:i(e.find(`span.card__date span`).text().trim()),link:l,category:e.find(`div.card__topics`).toArray().map(e=>p(e).text().trim()),author:e.find(`div.card__authors a`).toArray().map(e=>p(e).text().trim()).join(`/`),guid:d,id:d,content:{html:c,text:e.find(`p.card__excerpt`).text()},image:s,banner:s,language:m,enclosure_url:f?l:void 0,enclosure_type:f?`video/mp4`:void 0,enclosure_title:a,itunes_duration:f}});h=await Promise.all(h.map(e=>n.tryGet(e.link,async()=>{let{data:n}=await a(e.link),c=s(n);c(`div.player`).prevAll().remove(),c(`div.event__list-box`).remove();let l=c(`div.player__actions span`).text()||void 0,u=c(`script[type="text/javascript"]`).text(),d=u.match(/P\.s\s=\s'(.*?)';/)?.[1]??void 0,f=u.match(/P\.c\(.*?isWideScreen,\s'(.*?)',\s/)?.[1]??void 0,p=u.match(/var\stopicsInPage\s=\sJSON\.parse\('(.*?)'\);/)?.[1]?.replaceAll(`\\`,``)??void 0;d&&c(`div.player`).replaceWith(r(o.join(t,`templates/description-36fefaf3.art`),{videos:[{src:d,poster:f,type:`video/${d.split(/\./).pop()}`}]}));let h=c(`meta[property="og:title"]`).prop(`content`).trim(),g=c(`meta[property="twitter:image"]`).prop(`content`)||c(`meta[property="og:image"]`).prop(`content`);e.title=h,e.pubDate=i(c(`p.date`).text()),e.link=c(`meta[property="og:url"]`).prop(`content`),e.category=p?JSON.parse(p).map(e=>e.name):c(`meta[name="keywords"]`).prop(`content`).split(/,/),e.author=c(`ul.authors a.author__link`).toArray().map(e=>c(e).text()).join(`/`),c(`div.article__content`).nextAll().remove();let _=r(o.join(t,`templates/description-36fefaf3.art`),{images:g?[{src:g,alt:h}]:void 0,description:c(`article.article`).html()});return e.description=_,e.content={html:_,text:c(`article.article`).text()},e.image=g,e.banner=g,e.language=m,e.enclosure_url=d,e.enclosure_type=e.enclosure_url?`video/mp4`:void 0,e.enclosure_title=h,e.itunes_duration=l,e})));let g=p(`title`).text(),_=p(`meta[property="og:image"]`).prop(`content`);return{title:g,description:p(`meta[name="description"]`).prop(`content`),link:d,item:h,allowEmpty:!0,image:_,author:g.split(/-/).pop(),language:m}},l={path:`/presentations/:conference?`,name:`Presentations`,url:`www.infoq.com`,maintainers:[`nczitzk`],handler:c,example:`/infoq/presentations`,parameters:{conference:`Conference, all by default, can be found in URL`},description:"::: tip\n  If you subscribe to [InfoQ Live Jan 2024](https://www.infoq.com/infoq-live-jan-2024/presentations/)ï¼Œwhere the URL is `https://www.infoq.com/infoq-live-jan-2024/presentations/`, extract the part `https://www.infoq.com/` to the end, which is `/presentations/`, and use it as the parameter to fill in. Therefore, the route will be [`/infoq/presentations/infoq-live-jan-2024`](https://rsshub.app/infoq/presentations/infoq-live-jan-2024).\n:::\n    ",categories:[`programming`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.infoq.com/presentations`,`www.infoq.com/:conference/presentations`],target:e=>{let t=e.conference;return`/presentations${t?`/${t}`:``}`}}]};export{c as handler,l as route};