import{n as e,t}from"./esm-shims-C3MSy80G.mjs";import"./config-PItPnVIx.mjs";import"./logger-BoKmWr7Z.mjs";import"./ofetch-Byd8Ct7M.mjs";import"./helpers-vRt84cId.mjs";import{t as n}from"./cache-KwJARS5Z.mjs";import{t as r}from"./render-ZYpwNl2L.mjs";import{t as i}from"./got-BYElsd7I.mjs";import a from"node:path";import{load as o}from"cheerio";import{CookieJar as s}from"tough-cookie";e();const c=new s,l={path:[`/:journal/latest`,`/:journal`],radar:[{source:[`www.sciencedirect.com/journal/:journal/*`],target:`/:journal`}],name:`Unknown`,maintainers:[],handler:u};async function u(e){let s=e.req.param(`journal`),l=`https://www.sciencedirect.com`,u=`${l}/journal/${s}`,d=o((await i(u,{cookieJar:c})).data),f=d(`.anchor.js-title-link`).text(),p=`${l}${d(`.link-anchor.u-clr-black`).attr(`href`)}`,m=``;p.match(`suppl`)===null?p.match(`issue`)!==null&&(m=`Volume `+p.match(`vol/(.*)/issue`)[1]+` Issue `+p.match(`/issue/(.*)`)[1]):m=`Volume `+p.match(`vol/(.*)/suppl`)[1];let h=o((await i(p,{cookieJar:c})).data),g=h(`.js-article`).toArray().map(e=>{let t=h(e).find(`.js-article-title`).text(),n=h(e).find(`.js-article__item__authors`).text();return{title:t,link:h(e).find(`.article-content-title`).attr(`href`),id:h(e).find(`.article-content-title`).attr(`id`),authors:n,issue:m}}),_=e=>r(a.join(t,`templates/description-cc75687b.art`),{item:e});return{title:f,link:u,item:await Promise.all(g.map(e=>n.tryGet(e.link,async()=>{let t=o((await i(`${l}/science/article/pii/${e.id}`,{cookieJar:c})).data);return t(`.section-title`).remove(),e.doi=t(`.doi`).attr(`href`).replace(`https://doi.org/`,``),e.abstract=t(`.abstract.author`).text(),e.description=_(e),e})))}}export{l as route};