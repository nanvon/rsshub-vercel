import"./esm-shims-BFmOnnpb.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as e}from"./ofetch-am9EnuPq.js";import{cache_default as t}from"./cache-Dfid4xgQ.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{ViewType as r}from"./types-Bi82qguM.js";import{load as i}from"cheerio";const a=async r=>{let{category:a=`jiaotongyaowen`}=r.req.param(),o=Number.parseInt(r.req.query(`limit`)??`30`,10),s=`https://www.mot.gov.cn`,c=new URL(a.endsWith(`/`)?a:`${a}/`,s).href,l=await e(c),u=i(l),d=u(`html`).attr(`lang`)??`zh`,f=[];return f=u(`div.tab-pane a`).slice(0,o).toArray().map(e=>{let t=u(e),r=t.attr(`title`)??t.find(`span`).first().text(),i=t.find(`span.badge`).text(),a=t.attr(`href`),o=t.find(`.time`).text()||i;return{title:r,pubDate:i?n(i):void 0,link:a?a.startsWith(`http`)?a:new URL(a,c).href:void 0,updated:o?n(o):void 0,language:d}}),f=await Promise.all(f.map(r=>!r.link||!/mot\.gov\.cn/.test(r.link)||!r.link.endsWith(`.html`)?r:t.tryGet(r.link,async()=>{let t=await e(r.link),a=i(t),o=a(`h1`).first().text(),c=a(`div.TRS_UEDITOR`).html()??void 0,l=a(`meta[name="PubDate"]`).attr(`content`),u=[...new Set([a(`meta[name="ColumnName"]`).attr(`content`),a(`meta[name="ColumnType"]`).attr(`content`),a(`meta[name="ContentSource"]`).attr(`content`),...a(`meta[name="Keywords"]`).attr(`content`)?.split(`;`)??[]].filter(Boolean))],f=[a(`meta[name="ColumnSource"]`).attr(`content`),a(`meta[name="Author"]`).attr(`content`)].filter(Boolean).map(e=>({name:e,url:void 0,avatar:void 0})),p=a(`a.navbar-brand img`).attr(`src`)?new URL(a(`a.navbar-brand img`).attr(`src`),s).href:void 0,m=l,h={title:o,description:c,pubDate:l?n(l):r.pubDate,category:u,author:f,content:{html:c,text:c},image:p,banner:p,updated:m?n(m):r.updated,language:d};return{...r,...h}}))),{title:u(`title`).text(),description:u(`meta[name="ColumnDescription"]`).attr(`content`),link:c,item:f,allowEmpty:!0,image:u(`a.navbar-brand img`).attr(`src`)?new URL(u(`a.navbar-brand img`).attr(`src`),s).href:void 0,author:u(`meta[name="SiteName"]`).attr(`content`),language:d,id:c}},o={path:`/mot/:category{.+}?`,name:`中华人民共和国交通运输部`,url:`www.mot.gov.cn`,maintainers:[`ladeng07`,`nczitzk`],handler:a,example:`/gov/mot/jiaotongyaowen`,parameters:{category:{description:"分类，默认为 `jiaotongyaowen`，即交通要闻，可在对应分类页 URL 中找到",options:[{label:`交通要闻`,value:`jiaotongyaowen`},{label:`时政要闻`,value:`shizhengyaowen`},{label:`重要会议`,value:`zhongyaohuiyi`}]}},description:"::: tip\n若订阅 [重要会议](https://www.mot.gov.cn/zhongyaohuiyi/)，网址为 `https://www.mot.gov.cn/zhongyaohuiyi/`，请截取 `https://www.mot.gov.cn/` 到末尾 `/` 的部分 `zhongyaohuiyi` 作为 `category` 参数填入，此时目标路由为 [`/gov/mot/zhongyaohuiyi`](https://rsshub.app/gov/mot/zhongyaohuiyi)。\n:::",categories:[`government`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.mot.gov.cn/:category`],target:e=>{let t=e.category;return`/mot${t?`/${t}`:``}`}},{title:`交通要闻`,source:[`www.mot.gov.cn/jiaotongyaowen/`],target:`/mot/jiaotongyaowen`},{title:`时政要闻`,source:[`www.mot.gov.cn/shizhengyaowen/`],target:`/mot/shizhengyaowen`},{title:`重要会议`,source:[`www.mot.gov.cn/zhongyaohuiyi/`],target:`/mot/zhongyaohuiyi`}],view:r.Articles};export{a as handler,o as route};