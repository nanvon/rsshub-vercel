import{n as e,t}from"./esm-shims-D5mxTuu_.mjs";import{t as n}from"./render-D2i47mnC.mjs";import{t as r}from"./parse-date-Cv8vEJfE.mjs";import{t as i}from"./got-CxBlPaz_.mjs";import{t as a}from"./timezone-DuBj3K5r.mjs";import o from"node:path";import{load as s}from"cheerio";e();const c=(e,t,n)=>i(`https://feed.mix.sina.com.cn/api/roll/get`,{headers:{referer:`https://news.sina.com.cn/`},searchParams:{pageid:e,lid:t,k:``,num:n,page:1,r:Math.random(),_:Date.now()}}),l=e=>e.map(e=>({title:e.title,description:e.intro,link:e.url.replace(`http://`,`https://`),author:e.media_name,pubDate:r(e.intime,`X`),updated:r(e.mtime,`X`)})),u=(e,c)=>c(e.link,async()=>{let c=s((await i(e.link)).data);c(`#left_hzh_ad, .appendQr_wrap, .app-kaihu-qr, .tech-quotation`).remove();let l=c(`meta[property="article:published_time"]`),u=c(`#pub_date, .date`),d=u.length?a(r(u.text(),[`YYYY年MM月DD日 HH:mm`,`YYYY年MM月DD日HH:mm`]),8):null,f=l.length?r(l.attr(`content`)):d;if(e.pubDate=e.pubDate??f,e.author=c(`meta[property="article:author"]`).attr(`content`),e.link.startsWith(`https://slide.sports.sina.com.cn/`)||e.link.startsWith(`https://slide.tech.sina.com.cn/`)){let r=JSON.parse(c(`script`).text().match(/var slide_data = ({.*?})\s/)[1]);e.description=n(o.join(t,`templates/slide-5c74a843.art`),{slideData:r})}else if(e.link.startsWith(`https://video.sina.com.cn/`)){let a=c(`script`).text().match(/video_id:'?(.*?)'?,/)[1],{data:s}=await i(`https://api.ivideo.sina.com.cn/public/video/play`,{searchParams:{video_id:a,appver:`V11220.210521.03`,appname:`sinaplayer_pc`,applt:`web`,tags:`sinaplayer_pc`,jsonp:``,plid:2021012801,prid:``,uid:``,tid:``,pid:1,ran:Math.random(),r:e.link,ssid:`gusr_pc_${Date.now()}`,preload:0,uu:``,isAuto:1}}),l=s.data,u=l.image,d=l.videos.find(e=>e.type===`mp4`).dispatch_result.url;e.description=n(o.join(t,`templates/video-68dabc54.art`),{poster:u,videoUrl:d}),e.pubDate=r(l.create_time,`X`)}else e.link.startsWith(`https://news.sina.com.cn/`)||e.link.startsWith(`https://mil.news.sina.com.cn/`)?(e.description=c(`#article`).html(),e.category=c(`meta[name="keywords"]`).attr(`content`).split(`,`)):(e.description=c(`#artibody`).html(),e.category=c(`#keywords`).data(`wbkey`)?.split(`,`));return e});export{u as n,l as r,c as t};