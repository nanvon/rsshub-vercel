import"./esm-shims-CaZMYoY8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t as e}from"./ofetch-VsB2Peor.js";import{t}from"./cache-CpEhLexq.js";import{t as n}from"./parse-date-CHEO0z5G.js";import{t as r}from"./types-Bn7An2Wc.js";import{load as i}from"cheerio";const a=async r=>{let a=Number.parseInt(r.req.query(`limit`)??`30`,10),o=`https://kiro.dev`,s=new URL(`changelog/`,o).href,c=i(await e(s)),l=c(`html`).attr(`lang`)??`en`,u=[];return u=c(`a.block`).slice(0,a).toArray().map(e=>{let t=c(e),r=`${t.parent().find(`span`).text()} ${t.find(`h3`).text()}`,i=t.parent().parent().find(`div.prose`).html()??void 0,a=t.parent().parent().parent().find(`time`).text(),s=t.attr(`href`),u=a;return{title:r,description:i,pubDate:a?n(a):void 0,link:s?new URL(s,o).href:void 0,content:{html:i,text:i},updated:u?n(u):void 0,language:l}}),u=await Promise.all(u.map(r=>r.link?t.tryGet(r.link,async()=>{let t=i(await e(r.link)),a=`${t(`article span`).first().text()} ${t(`article h3`).text()}`,o=t(`div.prose`).html()??void 0,s=t(`time`).text(),c=t(`meta[property="og:image"]`).attr(`content`),u=s,d={title:a,description:o,pubDate:s?n(s):r.pubDate,content:{html:o,text:o},image:c,banner:c,updated:u?n(u):r.updated,language:l};return{...r,...d}}):r)),{title:c(`title`).text(),description:c(`meta[property="og:description"]`).attr(`content`),link:s,item:u,allowEmpty:!0,image:c(`meta[property="og:image"]`).attr(`content`),author:c(`meta[property="og:site_name"]`).attr(`content`),language:l,id:s}},o={path:`/changelog`,name:`Changelog`,url:`kiro.dev`,maintainers:[`nczitzk`],handler:a,example:`/kiro/changelog`,parameters:void 0,description:void 0,categories:[`program-update`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`kiro.dev`,`kiro.dev/changelog/`],target:`/changelog`}],view:r.Articles};export{a as handler,o as route};