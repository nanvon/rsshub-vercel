import"./esm-shims-CMsyBHYK.js";import{t as e}from"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import{t}from"./ofetch-CRUPiVpr.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./parse-date-CHEO0z5G.js";import{t as i}from"./timezone-BPfwRbwD.js";import{load as a}from"cheerio";const o=`https://www.sehuatang.net/`,s={gcyc:`2`,yzwmyc:`36`,yzymyc:`37`,gqzwzm:`103`,sjxz:`107`,vr:`160`,srym:`104`,omwm:`38`,"4k":`151`,hgzb:`152`,dmyc:`39`,yczp:`155`,ztzp:`125`,hrjp:`50`,yzxa:`48`,omxa:`49`,ktdm:`117`,ttxz:`165`,zhtl:`95`,mrhj:`106`,ai:`113`,ydsc:`111`,hrxazp:`98`},c={path:[`/bt/:subforumid?`,`/picture/:subforumid`,`/:subforumid?/:type?`,`/:subforumid?`,``],name:`Forum`,maintainers:[`qiwihui`,`junfengP`,`nczitzk`],handler:u,features:{nsfw:!0},description:`**原创 BT 电影**

| 国产原创 | 亚洲无码原创 | 亚洲有码原创 | 高清中文字幕 | 三级写真 | VR 视频 | 素人有码 | 欧美无码 | 韩国主播 | 动漫原创 | 综合讨论 |
| -------- | ------------ | ------------ | ------------ | -------- | ------- | -------- | -------- | -------- | -------- | -------- |
| gcyc     | yzwmyc       | yzymyc       | gqzwzm       | sjxz     | vr      | srym     | omwm     | hgzb     | dmyc     | zhtl     |

  **色花图片**

| 原创自拍 | 转贴自拍 | 华人街拍 | 亚洲性爱 | 欧美性爱 | 卡通动漫 | 套图下载 |
| -------- | -------- | -------- | -------- | -------- | -------- | -------- |
| yczp     | ztzp     | hrjp     | yzxa     | omxa     | ktdm     | ttxz     |`},l=()=>n.tryGet(`sehuatang:safeid`,async()=>a(await t(o))(`script:contains("safeid")`).text().match(/safeid\s*=\s*'(.+)';/)?.[1],e.cache.routeExpire,!1);async function u(e){let c=e.req.param(`subforumid`)??`gqzwzm`,u=c in s?s[c]:c,d=e.req.param(`type`),f=`${o}forum.php?mod=forumdisplay&orderby=dateline&fid=${u}${d?`&filter=typeid&typeid=${d}`:``}`,p={Cookie:`_safe=${await l()};`},m=a(await t(f,{headers:p})),h=m(`#threadlisttableid tbody[id^=normalthread]`).slice(0,e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):25).toArray().map(e=>(e=m(e),{title:`${e.find(`th em a`).length?`[${e.find(`th em a`).text()}]`:``} ${e.find(`a.xst`).text()}`,link:o+e.find(`a.xst`).attr(`href`),pubDate:r(e.find(`td.by`).find(`em span span`).attr(`title`)),author:e.find(`td.by cite a`).first().text()})),g=await Promise.all(h.map(e=>n.tryGet(e.link,async()=>{let n=a(await t(e.link,{headers:p})),s=n(`div[id^="postmessage"], td[id^="postmessage"]`).slice(0,1),c=n(s).find(`img`);for(let e of c){let t=n(e).attr(`file`);!t||t===`undefined`?n(e).replaceWith(``):n(e).replaceWith(n(`<img src="${t}">`))}let l=n(`.pattl`),u=n(l).find(`img`);for(let e of u){let t=n(e).attr(`file`);!t||t===`undefined`?n(e).replaceWith(``):n(e).replaceWith(n(`<img src="${t}" />`))}s.append(n(l)),n(`em[onclick]`).remove(),e.description=(s.html()||`抓取原帖失败`).replaceAll(`ignore_js_op`,`div`),e.pubDate=i(r(n(`.authi em span`).attr(`title`)),8);let d=s.find(`div.blockcode li`).first().text(),f=d.startsWith(`magnet`),m=s.find(`p.attnm a`).attr(`href`);return(f||m!==void 0)&&(e.enclosure_url=f?d:new URL(m,o).href,e.enclosure_type=f?`application/x-bittorrent`:`application/octet-stream`),e})));return{title:`色花堂 - ${m(`#pt > div:nth-child(1) > a:last-child`).text()}`,link:f,item:g}}export{c as route};