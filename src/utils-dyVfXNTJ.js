import{n as e,t}from"./esm-shims-CMsyBHYK.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{n as i,t as a}from"./parse-date-CHEO0z5G.js";import{t as o}from"./got-BlqYKpVp.js";import s from"node:path";import{load as c}from"cheerio";e();const l=e=>({title:e.name,link:e.link,description:e.name,pubDate:a(e.pubTimeLong),media:{content:{url:e.pic}}});var u={ProcessItem:(e,u)=>{let d=u.req.query(`old`)===`yes`;if(e.link)return l(e);let f=`https://m.thepaper.cn/${e.cornerLabelDesc&&e.cornerLabelDesc===`短剧`?`series`:`detail`}/${e.contId}`;return n.tryGet(`${f}${d?`:old`:``}`,async()=>{let n=await o(f),u=JSON.parse(c(n.data)(`#__NEXT_DATA__`).html()).props.pageProps.detailData,p=u.contentDetail||u.liveDetail||u.specialDetail?.specialInfo;if(!p)return l(e);let m=p.content||p.summary||p.desc||``;p.videos&&(m+=p.summary),d&&(p.videos&&(m=r(s.join(t,`templates/video_detail-6e02b70e.art`),{videos:p.videos})+m),p.images&&(m=r(s.join(t,`templates/image_detail-7a807b2d.art`),{images:p.images})+m));let h=a(e.pubTimeLong||p.publishTime);Number.isNaN(h)&&(h=i(p.pubTime));let g={title:p.name||p.shareName,link:f,description:m,category:[...p.tagList?.map(e=>e.tag)??[],p?.nodeInfo?.name??[]],pubDate:h,author:p.author||``,media:{content:{url:e.pic||p.videos?.coverUrl||p.bigPic},thumbnails:{url:e.sharePic||p.sharePic}}};return p.voiceInfo?.isHaveVoice&&(g.enclosure_type=`audio/mpeg`,g.enclosure_url=p.voiceInfo.voiceSrc,g.itunes_item_image=e.pic||p.videos?.coverUrl),g})},ChannelIdToName:(e,t)=>t.props.appProps.menu.channelList.find(t=>t.nodeId.toString()===e.toString()).name,ListIdToName:(e,t)=>t.props.appProps.menu.channelList.flatMap(e=>e.childNodeList||[]).find(t=>t.nodeId.toString()===e.toString())?.name,ExtractLogo:e=>`https://m.thepaper.cn`+c(e.data)(`img.imageCover`).attr(`src`)};export{u as t};