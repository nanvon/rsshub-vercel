import"./esm-shims-BFmOnnpb.js";import{config as e}from"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as t}from"./ofetch-am9EnuPq.js";import{cache_default as n}from"./cache-Dfid4xgQ.js";import{parseDate as r}from"./parse-date-DHsdom8D.js";import{timezone as i}from"./timezone-CMz5pnRe.js";import{load as a}from"cheerio";const o=`https://www.sehuatang.net/`,s={gcyc:`2`,yzwmyc:`36`,yzymyc:`37`,gqzwzm:`103`,sjxz:`107`,vr:`160`,srym:`104`,omwm:`38`,"4k":`151`,hgzb:`152`,dmyc:`39`,yczp:`155`,ztzp:`125`,hrjp:`50`,yzxa:`48`,omxa:`49`,ktdm:`117`,ttxz:`165`,zhtl:`95`,mrhj:`106`,ai:`113`,ydsc:`111`,hrxazp:`98`},c={path:[`/bt/:subforumid?`,`/picture/:subforumid`,`/:subforumid?/:type?`,`/:subforumid?`,``],name:`Forum`,maintainers:[`qiwihui`,`junfengP`,`nczitzk`],handler:u,features:{nsfw:!0},description:`**原创 BT 电影**

| 国产原创 | 亚洲无码原创 | 亚洲有码原创 | 高清中文字幕 | 三级写真 | VR 视频 | 素人有码 | 欧美无码 | 韩国主播 | 动漫原创 | 综合讨论 |
| -------- | ------------ | ------------ | ------------ | -------- | ------- | -------- | -------- | -------- | -------- | -------- |
| gcyc     | yzwmyc       | yzymyc       | gqzwzm       | sjxz     | vr      | srym     | omwm     | hgzb     | dmyc     | zhtl     |

  **色花图片**

| 原创自拍 | 转贴自拍 | 华人街拍 | 亚洲性爱 | 欧美性爱 | 卡通动漫 | 套图下载 |
| -------- | -------- | -------- | -------- | -------- | -------- | -------- |
| yczp     | ztzp     | hrjp     | yzxa     | omxa     | ktdm     | ttxz     |`},l=()=>n.tryGet(`sehuatang:safeid`,async()=>{let e=await t(o);return a(e)(`script:contains("safeid")`).text().match(/safeid\s*=\s*'(.+)';/)?.[1]},e.cache.routeExpire,!1);async function u(e){let c=e.req.param(`subforumid`)??`gqzwzm`,u=c in s?s[c]:c,d=e.req.param(`type`),f=d?`&filter=typeid&typeid=${d}`:``,p=`${o}forum.php?mod=forumdisplay&orderby=dateline&fid=${u}${f}`,m={Cookie:`_safe=${await l()};`},h=await t(p,{headers:m}),g=a(h),_=g(`#threadlisttableid tbody[id^=normalthread]`).slice(0,e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):25).toArray().map(e=>(e=g(e),{title:`${e.find(`th em a`).length?`[${e.find(`th em a`).text()}]`:``} ${e.find(`a.xst`).text()}`,link:o+e.find(`a.xst`).attr(`href`),pubDate:r(e.find(`td.by`).find(`em span span`).attr(`title`)),author:e.find(`td.by cite a`).first().text()})),v=await Promise.all(_.map(e=>n.tryGet(e.link,async()=>{let n=await t(e.link,{headers:m}),s=a(n),c=s(`div[id^="postmessage"], td[id^="postmessage"]`).slice(0,1),l=s(c).find(`img`);for(let e of l){let t=s(e).attr(`file`);!t||t===`undefined`?s(e).replaceWith(``):s(e).replaceWith(s(`<img src="${t}">`))}let u=s(`.pattl`),d=s(u).find(`img`);for(let e of d){let t=s(e).attr(`file`);!t||t===`undefined`?s(e).replaceWith(``):s(e).replaceWith(s(`<img src="${t}" />`))}c.append(s(u)),s(`em[onclick]`).remove(),e.description=(c.html()||`抓取原帖失败`).replaceAll(`ignore_js_op`,`div`),e.pubDate=i(r(s(`.authi em span`).attr(`title`)),8);let f=c.find(`div.blockcode li`).first().text(),p=f.startsWith(`magnet`),h=c.find(`p.attnm a`).attr(`href`);return(p||h!==void 0)&&(e.enclosure_url=p?f:new URL(h,o).href,e.enclosure_type=p?`application/x-bittorrent`:`application/octet-stream`),e})));return{title:`色花堂 - ${g(`#pt > div:nth-child(1) > a:last-child`).text()}`,link:p,item:v}}export{c as route};