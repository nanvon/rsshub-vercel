import"./esm-shims-D5mxTuu_.mjs";import"./config-CDM38Tpk.mjs";import"./logger-B0B1yUZ6.mjs";import{t as e}from"./ofetch-FkpIOIxH.mjs";import{t}from"./parse-date-Cv8vEJfE.mjs";import{t as n}from"./timezone-DuBj3K5r.mjs";import{t as r}from"./types-CypZ_btd.mjs";import{t as i}from"./invalid-parameter-DQLT-Ijk.mjs";import{t as a}from"./valid-host-DCr5060v.mjs";import{load as o}from"cheerio";import s from"markdown-it";const c=s({html:!0}),l={path:`/posts/:site`,categories:[`blog`],example:`/posts/walnut`,parameters:{site:"站点名，原则上只要是 `{site}.hedwig.pub` 都可以匹配"},features:{supportRadar:!1},name:`Posts`,url:`hedwig.pub`,maintainers:[`zwithz`,`GetToSet`],view:r.Articles,handler:async r=>{let{site:s}=r.req.param();if(!a(s))throw new i(`Invalid site`);let l=`https://${s}.hedwig.pub`,u=o(await e(l))(`script#__NEXT_DATA__`).text(),d=JSON.parse(u).props.pageProps,f=d.issuesByNewsletter.map(e=>{let r=e.blocks.reduce((e,t)=>e+c.render(t.markdown.text),``);return{title:e.subject,description:r,pubDate:n(t(e.publishAt,`YYYY-MM-DDTHH:mm:ss.SSS[Z]`),0),link:`${l}/i/${e.urlFriendlyName}`}});return{title:d.newsletter.name,description:d.newsletter.about,link:l,item:f}}};export{l as route};