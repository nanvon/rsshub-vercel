import{n as e,t}from"./esm-shims-DhF_MXa4.mjs";import{t as n}from"./config-PItPnVIx.mjs";import"./logger-BoKmWr7Z.mjs";import"./ofetch-DVhBwO41.mjs";import"./helpers-vRt84cId.mjs";import{t as r}from"./cache-KwJARS5Z.mjs";import{t as i}from"./render-ZYpwNl2L.mjs";import{t as a}from"./parse-date-9Tu6hSFW.mjs";import{t as o}from"./got-D_XeVuz-.mjs";import s from"node:path";import{load as c}from"cheerio";e();const l={path:`/news/author/:mid`,categories:[`new-media`],example:`/tencent/news/author/5933889`,parameters:{mid:`企鹅号 ID`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{title:`当前作者文章`,source:[`news.qq.com/omn/author/:mid`]}],name:`作者`,maintainers:[`LogicJake`,`miles170`],handler:u};async function u(e){let l=e.req.param(`mid`),u=`https://i.news.qq.com/i/getUserHomepageInfo?${/^\d+$/.test(l)?`chlid`:`guestSuid`}=${l}`,d=await r.tryGet(u,async()=>(await o(u)).data.userinfo),f=d.nick,p=d.user_desc,m=`https://i.news.qq.com/getSubNewsMixedList?guestSuid=${encodeURIComponent(d.suid)}&tabId=om_index`,h=await r.tryGet(m,async()=>(await o(m)).data.newslist,n.cache.routeExpire,!1),g=await Promise.all(h.map(e=>{let n=e.title,l=a(e.timestamp,`X`),u=e.url,d=e.source,f=e.abstract;return e.articletype===`4`||e.articletype===`118`?{title:n,description:`<a href=${e.url}><img src="${e.articletype===`4`?e.miniProShareImage:e.miniVideoPic}" style="width: 100%"></a>`,link:u,author:d,pubDate:l}:r.tryGet(u,async()=>{let e=c((await o(u)).data),r=JSON.parse(e(`script:contains("window.DATA")`).text().match(/window\.DATA = ({.+});/)[1]),a=c(r.originContent?.text||``,null,!1);return a&&a(`*`).contents().filter((e,t)=>t.type===`comment`).replaceWith((e,n)=>i(s.join(t,`templates/image-65e537e7.art`),{attribute:n.data.trim(),originAttribute:r.originAttribute})),{title:n,description:a.html()||f,link:u,author:d,pubDate:l}})}));return{title:f,description:p,link:`https://new.qq.com/omn/author/${l}`,item:g,image:d?.shareImg}}export{l as route};