import{n as e,t}from"./esm-shims-mGm6WwCc.js";import{t as n}from"./config-DZMnNPig.js";import{t as r}from"./cache-CpEhLexq.js";import{t as i}from"./render-d6AVTUl2.js";import{t as a}from"./parse-date-CHEO0z5G.js";import{t as o}from"./md5-CWsm3r0H.js";import{t as s}from"./got-CgQXMNWI.js";import{t as c}from"./config-not-found-CX6cWM57.js";import l from"node:path";import{load as u}from"cheerio";import d from"crypto-js";e();const f=`jmcomic1.me`,p=new Set([`18comic.vip`,`18comic.org`,`jmcomic.me`,`jmcomic1.me`,`jm-comic3.art`,`jm-comic.club`,`jm-comic2.ark`]),m=e=>{if(!n.feature.allow_user_supply_unsafe_domain&&!p.has(e))throw new c(`This RSS is disabled unless 'ALLOW_USER_SUPPLY_UNSAFE_DOMAIN' is set to 'true'.`);return`https://${e}`},h=e=>{switch(e){case`another`:return`其他漫畫`;case`doujin`:return`同人`;case`hanman`:return`韓漫`;case`meiman`:return`美漫`;case`short`:return`短篇`;case`single`:return`單本`;default:return null}},g=()=>`https://www.cdnblackmyth.club`,_=async e=>{e=e.replace(/\?$/,``);let t=Date.now(),n=`${t},1.7.5`,r=`${t}18comicAPP`;r=o(r);let i=await s(e,{headers:{token:r,tokenparam:n}}),a=d.enc.Base64.parse(i.data.data),c=d.MD5(t+`185Hcomic3PAPP7R`).toString(),l=d.enc.Utf8.parse(c),u=d.lib.CipherParams.create({ciphertext:a}),f=d.AES.decrypt(u,l,{mode:d.mode.ECB,padding:d.pad.Pkcs7}).toString(d.enc.Utf8);return JSON.parse(f)},v=async(e,n,o)=>{n=n.replace(/\?$/,``);let c=u((await s(n)).data),d=c(`.video-title`).slice(0,e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):20).toArray().map(e=>(e=c(e),{title:e.text().trim(),link:`${o}${e.prev().find(`a`).attr(`href`)}`,guid:`18comic:${e.prev().find(`a`).attr(`href`)}`}));return d=await Promise.all(d.map(e=>r.tryGet(e.guid,async()=>{let n=u((await s(e.link)).data);return e.pubDate=a(n(`div[itemprop="datePublished"]`).first().attr(`content`)),e.updated=a(n(`div[itemprop="datePublished"]`).last().attr(`content`)),e.category=n(`span[data-type="tags"]`).first().find(`a`).toArray().map(e=>c(e).text()),e.author=n(`span[data-type="author"]`).first().find(`a`).toArray().map(e=>c(e).text()).join(`, `),e.description=i(l.join(t,`templates/description-afe7e434.art`),{introduction:n(`#intro-block .p-t-5`).text(),images:n(`.img_zoom_img img`).toArray().map(e=>n(e).attr(`data-original`)),cover:n(`.thumb-overlay img`).first().attr(`src`),category:e.category}),e}))),{title:c(`title`).text(),link:n,item:d,description:c(`meta[property="og:description"]`).attr(`content`),allowEmpty:!0}};export{m as a,g as i,h as n,_ as o,f as r,v as t};