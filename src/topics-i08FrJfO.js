import"./esm-shims-Dqvxr0BZ.js";import"./config-BpwDbAkH.js";import"./logger-B3QfaIfn.js";import"./ofetch-TsvCL7Kz.js";import"./helpers-LVq640iW.js";import"./cache-CzcusEyX.js";import"./parse-date-DHsdom8D.js";import{got_default as e}from"./got-lNAQakSo.js";import{ViewType as t}from"./types-Bi82qguM.js";import{fetchArticle as n,removeDuplicateByKey as r}from"./utils-vnyJzBUw.js";import{routePath as i}from"hono/route";import{load as a}from"cheerio";import o from"p-map";const s=`https://apnews.com`,c={path:[`/topics/:topic?`,`/nav/:nav{.*}?`],categories:[`traditional-media`],example:`/apnews/topics/apf-topnews`,view:t.Articles,parameters:{topic:{description:"Topic name, can be found in URL. For example: the topic name of AP Top News [https://apnews.com/apf-topnews](https://apnews.com/apf-topnews) is `apf-topnews`",default:`trending-news`}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`apnews.com/hub/:topic`],target:`/topics/:topic`}],name:`Topics`,maintainers:[`zoenglinghou`,`mjysci`,`TonyRL`],handler:l};async function l(t){let{topic:c=`trending-news`,nav:l=``}=t.req.param(),u=i(t)===`/apnews/nav/:nav{.*}?`,d=u?`${s}/${l}`:`${s}/hub/${c}`,f=await e(d),p=a(f.data),m=p(`:is(.PagePromo-content, .PageListStandardE-leadPromo-info) bsp-custom-headline`).toArray().slice(0,t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`)):1/0).map(e=>({title:p(e).find(`span.PagePromoContentIcons-text`).text(),link:p(e).find(`a`).attr(`href`)})).filter(e=>typeof e.link==`string`),h=t.req.query(`fulltext`)===`true`?await o(m,e=>n(e),{concurrency:10}):m;return{title:p(`title`).text(),description:p(`meta[property='og:description']`).text(),link:d,item:r(h,`link`),language:p(`html`).attr(`lang`)}}export{c as route};