import"./esm-shims-BGJi2y--.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import"./ofetch-DqHh1IN2.js";import"./helpers-gUVC02jt.js";import{cache_default as e}from"./cache-Dfid4xgQ.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{got_default as n}from"./got-VGofQtEf.js";import{load as r}from"cheerio";const i={path:`/:language?/:category?`,categories:[`new-media`],example:`/swissinfo/eng/latest-news`,parameters:{language:`Language, eng by default`,category:`Category, Latest News by default`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`swissinfo.ch/:language/:category`,`swissinfo.ch/`]}],name:`Category`,maintainers:[`nczitzk`],handler:a};async function a(i){let a=i.req.param(`language`)??`eng`,o=i.req.param(`category`)??`latest-news`,s=`https://www.swissinfo.ch`,c=`${s}/${a}/${o}`,l=await n({method:`get`,url:c}),u=r(l.data),d=u(`title`).text(),f=await n({method:`get`,url:`${s}${u(`main div[data-fragment-placeholder]`).attr(`data-fragment-placeholder`)}`});u=r(f.data);let p=u(`.si-teaser__link`).slice(0,i.req.query(`limit`)?Number.parseInt(i.req.query(`limit`)):20).toArray().map(e=>(e=u(e),{link:`${s}${e.attr(`href`)}`,title:e.find(`.si-teaser__title`).text(),pubDate:t(e.find(`.si-teaser__date`).attr(`datetime`))}));return p=await Promise.all(p.map(t=>e.tryGet(t.link,async()=>{let e=await n({method:`get`,url:t.link}),i=r(e.data);return i(`.si-detail__content .si-grid`).remove(),i(`.si-detail__content .si-teaser`).remove(),i(`.show-for-sr, time, address, .si-detail__translation`).remove(),i(`picture`).each(function(){i(this).html(`<img src="${i(this).find(`source`).first().attr(`srcset`)}">`)}),t.description=i(`.si-detail__content`).html(),t.author=i(`meta[name="author"]`).attr(`content`),t.guid=e.data.match(/content_id: "(.*)",/)[1],t}))),{title:d,link:c,item:p}}export{i as route};