import"./ofetch-BRplXtiZ.mjs";import"./config-D7dgKYF5.mjs";import"./logger-CkUWGGaS.mjs";import{t as e}from"./cache-Bv3_kFbE.mjs";import"./helpers-Tm7Pw8Vq.mjs";import{n as t,t as n}from"./parse-date-_GmTZfjS.mjs";import{t as r}from"./got-BglkE51W.mjs";import{t as i}from"./timezone-BAp4uBjD.mjs";import{load as a}from"cheerio";const o={path:[`/u/:uid`,`/user/:id`],categories:[`programming`],example:`/oschina/u/3920392`,parameters:{uid:`用户 id，可通过查看用户博客网址得到，以 u/数字结尾，数字即为 id`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`my.oschina.net/u/:uid`]}],name:`数字型账号用户博客`,maintainers:[],handler:s};async function s(o){let{id:s,uid:c}=o.req.param(),l=a((s?await r(`https://my.oschina.net/${s}`):await r(`https://my.oschina.net/u/${c}`)).data),u=l(`.user-name .name`).text(),d=l(`#newestBlogList .blog-item`).toArray().map(e=>{e=l(e);let r=e.find(`.extra div .item:nth-of-type(2)`).text(),a=!e.find(`div.label[data-tooltip=审核中]`).length;return e.find(`.label`).remove(),{title:e.find(`.content a.header`).text(),description:e.find(`.description p`).text(),link:e.find(`a.header`).attr(`href`),pubDate:i(/\//.test(r)?n(r,[`YYYY/MM/DD HH:mm`,`MM/DD HH:mm`]):t(r),8),author:u,accessible:a}}),f=await Promise.all(d.map(t=>e.tryGet(t.link,async()=>(t.accessible&&(t.description=a((await r(t.link)).data)(`.article-detail`).html()),delete t.accessible,t))));return{title:u+`的博客`,description:l(`.user-text .user-signature`).text(),link:`https://my.oschina.net/u/${s??c}`,item:f}}export{o as route};