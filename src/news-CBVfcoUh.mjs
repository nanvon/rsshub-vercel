import{n as e,t}from"./esm-shims-D5mxTuu_.mjs";import"./config-CDM38Tpk.mjs";import"./logger-B0B1yUZ6.mjs";import"./ofetch-FkpIOIxH.mjs";import{t as n}from"./header-generator-8QrOYJpR.mjs";import"./helpers-CMl_ndRq.mjs";import{t as r}from"./cache-C6z2tE2n.mjs";import{t as i}from"./render-D2i47mnC.mjs";import{t as a}from"./parse-date-Cv8vEJfE.mjs";import{t as o}from"./got-CxBlPaz_.mjs";import s from"node:path";import{load as c}from"cheerio";import l from"p-map";e();const u=e=>r.tryGet(e.link,async()=>{let r=(await o({url:e.link.replace(/(?<=^https:\/\/\w+\.wsj\.com)/,`/amp`),method:`get`,headerGeneratorOptions:n.MODERN_ANDROID})).data,l=c(r),u=l(`head > meta[name="description"]`).attr(`content`),d=l(`meta[itemprop="dateModified"]`).attr(`content`),f=l(`meta[itemprop="datePublished"]`).attr(`content`),p=l(`.author > a[rel="author"]`).text(),m=l(`meta[name="keywords"]`).attr(`content`).split(`,`).map(e=>e.trim()),h=l(`article`);e.subTitle=l(`h2.sub-head`).html(),h.find(`.media-object-podcast`).remove(),h.find(`.bylineWrap`).each((e,t)=>{l(t).find(`p`).each(function(){l(this).replaceWith(l(this).html())})}),h.find(`.bigTop-hero`).each((e,t)=>{l(l(`<figure><img src="${l(t).find(`amp-img`).attr(`src`)}" alt="${l(t).find(`amp-img`).attr(`alt`)}"><figcaption>${l(t).find(`.imageCaption`).text().trim()} <span>${l(t).find(`.imageCredit`).text().trim()}</span></figcaption></figure>`)).insertBefore(t),l(t).remove()}),h.find(`amp-img`).each((e,t)=>{l(l(`<img width="${t.attribs.width}" height="${t.attribs.height}" src="${t.attribs.src}" alt="${t.attribs.alt}">`)).insertBefore(t),l(t).remove()}),h.find(`amp-iframe`).each((e,t)=>{l(l(`<iframe width="${t.attribs.width}" height="${t.attribs.height}" src="${t.attribs.src}">`)).insertBefore(t),l(t).remove()});for(let e of[`amp-ad`,`.wsj-ad`,`h1`,`h2`,`.zonedModule`,`.snippet`,`.newsletter-inset`])h.find(e).each((e,t)=>{l(t).remove()});return h.find(`.paywall`).each((e,t)=>{l(t.childNodes).insertBefore(t),l(t).remove()}),e.article=h.html(),e.description=i(s.join(t,`templates/article-description-8e28f8db.art`),{item:e}),{title:e.title,pubDate:a(f),updated:a(d),author:p,link:e.link,summary:u,description:e.description,category:m,icon:`https://s.wsj.net/media/wsj_launcher-icon-4x.png`,logo:`https://vir.wsj.net/fp/assets/webpack4/img/wsj-logo-big-black.165e51cc.svg`}}),d={"en-us":`https://www.wsj.com`,"zh-cn":`https://cn.wsj.com/zh-hans`,"zh-tw":`https://cn.wsj.com/zh-hant`},f={path:`/:lang/:category?`,categories:[`traditional-media`],example:`/wsj/en-us/opinion`,parameters:{lang:"Language, `en-us`, `zh-cn`, `zh-tw`",category:`Category. See below`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`News`,maintainers:[`oppilate`],handler:p,description:`en_us

| World | U.S. | Politics | Economy | Business | Tech       | Markets | Opinion | Books & Arts | Real Estate | Life & Work | Sytle               | Sports |
| ----- | ---- | -------- | ------- | -------- | ---------- | ------- | ------- | ------------ | ----------- | ----------- | ------------------- | ------ |
| world | us   | politics | economy | business | technology | markets | opinion | books-arts   | realestate  | life-work   | style-entertainment | sports |

  zh-cn / zh-tw

| 国际  | 中国  | 金融市场 | 经济    | 商业     | 科技       | 派        | 专栏与观点 |
| ----- | ----- | -------- | ------- | -------- | ---------- | --------- | ---------- |
| world | china | markets  | economy | business | technology | life-arts | opinion    |

  Provide full article RSS for WSJ topics.`};async function p(e){let t=e.req.param(`lang`),n=e.req.param(`category`)||``,r=d[t],i=` - ${t.toUpperCase()}`,a=r;n.length>0&&(a=`${r}/news/${n}`,i=`${i} - ${n}`);let s=c((await o({method:`get`,url:a})).data)(`script:contains("window.__STATE__")`).text(),f=JSON.parse(s.match(/{.*}/)[0]).data,p=await l(Object.entries(f).filter(([e,t])=>e.startsWith(`article`)?t.data.data.url.includes(`wsj.com/articles/`):!1).map(([e])=>e).map(e=>({title:f[e].data.data.headline,link:f[e].data.data.url,test:e})),e=>u(e),{concurrency:10});return{title:`WSJ${i}`,link:a,description:`WSJ${i}`,item:p}}export{f as route};