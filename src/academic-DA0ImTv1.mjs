import{n as e,t}from"./esm-shims-D4LgnpSl.mjs";import"./config-L8Ls2W7q.mjs";import"./logger-C50fTRi5.mjs";import"./ofetch-CvLG4YCQ.mjs";import"./helpers-mo8InLYm.mjs";import{t as n}from"./cache-ZTWfXd2T.mjs";import{t as r}from"./render-CBhnapAf.mjs";import{t as i}from"./parse-date-bKmkZ9gg.mjs";import{t as a}from"./got-AYh7EWi-.mjs";import{t as o}from"./timezone-CE0MDOJ-.mjs";import s from"node:path";import{load as c}from"cheerio";e();const l=async e=>{let{id:l=`1`}=e.req.param(),u=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):10,d=`https://www.eshukan.com`,f=new URL(`academic/index.aspx?cid=${l}`,d).href,{data:p}=await a(f),m=c(p),h=m(`ul.article li`).slice(0,u).toArray().map(e=>{e=m(e);let n=e.find(`a`),a=n.contents().last().text(),c=e.find(`p span`).text().match(/(\d{4}\/\d{2}\/\d{2}\s\d{2}:\d{2}:\d{2})/)?.[1];e.find(`p span`).remove();let l=r(s.join(t,`templates/description-f29cc099.art`),{intro:e.find(`p`).text()});return{title:a,description:l,pubDate:c?o(i(c),8):void 0,link:new URL(n.prop(`href`),f).href,content:{html:l,text:e.find(`p`).text()}}});h=await Promise.all(h.map(e=>n.tryGet(e.link,async()=>{let{data:n}=await a(e.link),l=c(n),u=l(`h1`).text(),d=r(s.join(t,`templates/description-f29cc099.art`),{intro:l(`div.summary`).html(),description:l(`div.detail`).html()}),f=l(`div.author`).text().match(/(\d{4}\/\d{2}\/\d{2}\s\d{2}:\d{2}:\d{2})/)?.[1];return e.title=u,e.description=d,e.pubDate=f?o(i(f),8):e.pubDate,e.author=l(`div.author a`).text(),e.content={html:d,text:l(`div.detail`).text()},e})));let g=m(`title`).text(),_=new URL(m(`div.logo img`).prop(`src`),d).href;return{title:g,description:m(`meta[name="description"]`).prop(`content`),link:f,item:h,allowEmpty:!0,image:_,author:g.split(/_/).pop()}},u={path:`/academic/:id?`,name:`学术资讯`,url:`www.eshukan.com`,maintainers:[`nczitzk`],handler:l,example:`/eshukan/academic/1`,parameters:{category:"栏目 id，默认为 `1`，即期刊动态，可在对应栏目页 URL 中找到"},description:"::: tip\n  若订阅 [期刊动态](https://www.eshukan.com/academic/index.aspx?cid=1)，网址为 `https://www.eshukan.com/academic/index.aspx?cid=1`。截取 `https://www.eshukan.com/academic/index.aspx?cid=` 到末尾的部分 `1` 作为参数填入，此时路由为 [`/eshukan/academic/1`](https://rsshub.app/eshukan/academic/1)。\n:::\n    ",categories:[`study`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.eshukan.com/academic/index.aspx`],target:(e,t)=>{t=new URL(t);let n=t.searchParams.get(`id`);return`/academic${n?`/${n}`:``}`}}]};export{l as handler,u as route};