import"./esm-shims-BmHUa0Yk.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as e}from"./ofetch-DCfHHxuQ.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{timezone as n}from"./timezone-CMz5pnRe.js";import{load as r}from"cheerio";const i={path:`/topic/:id`,categories:[`anime`],example:`/bangumi.tv/topic/367032`,parameters:{id:`话题 id, 在话题页面地址栏查看`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`bgm.tv/group/topic/:id`]}],name:`小组话题的新回复`,maintainers:[`ylc395`],handler:a};async function a(i){let a=`https://bgm.tv/group/topic/${i.req.param(`id`)}`,o=await e(a),s=r(o),c=s(`#pageHeader h1`).text(),l=s(`.row_reply`).toArray().map(e=>{let t=s(e);return{id:t.attr(`id`),author:t.find(`.userInfo .l`).text(),content:t.find(`.reply_content .message`).html(),date:t.children().first().find(`small`).children().remove().end().text().slice(3)}}),u=s(`.sub_reply_bg`).toArray().map(e=>{let t=s(e);return{id:t.attr(`id`),author:t.find(`.userName .l`).text(),content:t.find(`.cmt_sub_content`).html(),date:t.children().first().find(`small`).children().remove().end().text().slice(3)}}),d=[...l,...u].toSorted((e,t)=>e.id<t.id?1:-1),f={title:c,description:s(`.postTopic .topic_content`).html(),author:s(`.postTopic .inner strong a`).first().text(),pubDate:n(t(s(`.postTopic .re_info small`).text().trim().slice(5)),8),link:a};return{title:`${c}的最新回复`,link:a,item:[...d.map(e=>({title:`${e.author} 回复了小组话题《${c}》`,description:e.content,pubDate:n(t(e.date),8),author:e.author,link:`${a}#${e.id}`})),f]}}export{i as route};