import{n as e,t}from"./esm-shims-D4LgnpSl.mjs";import"./config-L8Ls2W7q.mjs";import"./logger-C50fTRi5.mjs";import{t as n}from"./ofetch-CvLG4YCQ.mjs";import{t as r}from"./cache-ZTWfXd2T.mjs";import{t as i}from"./render-CBhnapAf.mjs";import{t as a}from"./parse-date-bKmkZ9gg.mjs";import{t as o}from"./timezone-CE0MDOJ-.mjs";import{t as s}from"./types-BD1MU_-b.mjs";import c from"node:path";import{load as l}from"cheerio";e();const u=async e=>{let{id:s=`datalist`}=e.req.param(),u=Number.parseInt(e.req.query(`limit`)??`30`,10),d=new URL(s.endsWith(`/`)?s:`${s}/`,`http://www.fangchan.com`).href,f=new URL(`api/${s.endsWith(`/`)?s.replace(/\/$/,``):s}.json`,`http://news.fangchan.com`).href,p=l(await n(d)),m=p(`html`).attr(`lang`)??`zh-CN`,h=await n(f,{query:{pagesize:u,page:1}}),g=[];g=h.data.slice(0,u).map(e=>{let n=e.title,r=i(c.join(t,`templates/description-ca64252b.art`),{intro:e.zhaiyao}),o=e.createtime,s=e.url,l=[...new Set([e.topcolumn,e.subcolumn,...e.keyword?.split(/,/)??[]].filter(Boolean))],u=e.pic,d=e.createtime;return{title:n,description:r,pubDate:o?a(o,`X`):void 0,link:s,id:l,content:{html:r,text:e.zhaiyao??r},image:u,banner:u,updated:d?a(d,`X`):void 0,language:m}}),g=(await Promise.all(g.map(e=>e.link?r.tryGet(e.link,async()=>{let t=l(await n(e.link)),r=t(`div.summary-text h`).text(),i=(e.description??``)+(t(`div.top-info`).html()??``)+(t(`div.summary-text-p`).html()??``),s=t(`span.news-date`).text().match(/\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}/)?.[1],c=t(`a.news-column, div.label span`).toArray(),u=[...new Set([...e.id,...c.map(e=>t(e).text()).filter(Boolean)].filter(Boolean))],d=t(`span.news-date`).text()?.split(/\d{4}-\d{2}-\d{2}/)?.[0]?.trim()?.split(/\s/)?.map(e=>({name:e})),f=s,p={title:r,description:i,pubDate:s?o(a(s),8):e.pubDate,id:u,author:d,content:{html:i,text:i},updated:f?o(a(f),8):e.updated,language:m},h=t(`ul.xgxw-ul li a`).toArray().map(e=>{let n=t(e);return{url:n.attr(`href`),type:`related`,content_html:n.text()}}).filter(e=>!0);return h&&(p={...p,_extra:{links:h}}),{...e,...p}}):e))).filter(e=>!0);let _=`中房网`;return{title:`${_} - ${p(`div.curmbs a`).text()}`,description:p(`meta[name="description"]`).attr(`content`),link:d,item:g,allowEmpty:!0,author:_,language:m}},d={path:`/list/:id?`,name:`列表`,url:`www.fangchan.com`,maintainers:[`nczitzk`],handler:u,example:`/fangchan/list/datalist`,parameters:{id:{description:"分类，默认为 `datalist`，即数据研究，可在对应分类页 URL 中找到",options:[{label:`数据研究`,value:`datalist`},{label:`行业测评`,value:`industrylist`},{label:`政策法规`,value:`policylist`}]}},description:"::: tip\n若订阅 [列表](https://www.fangchan.com/)，网址为 `https://www.fangchan.com/`，请截取 `https://www.fangchan.com/` 到末尾 `.html` 的部分 `datalist` 作为 `id` 参数填入，此时目标路由为 [`/fangchan/datalist`](https://rsshub.app/fangchan/datalist)。\n:::\n\n| [数据研究](https://www.fangchan.com/datalist)         | [行业测评](https://www.fangchan.com/industrylist)             | [政策法规](https://www.fangchan.com/policylist)           |\n| ----------------------------------------------------- | ------------------------------------------------------------- | --------------------------------------------------------- |\n| [datalist](https://rsshub.app/fangchan/list/datalist) | [industrylist](https://rsshub.app/fangchan/list/industrylist) | [policylist](https://rsshub.app/fangchan/list/policylist) |\n",categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.fangchan.com/:id`],target:e=>{let t=e.id;return`/fangchan/list/${t?`/${t}`:``}`}},{title:`数据研究`,source:[`www.fangchan.com/datalist`],target:`/list/datalist`},{title:`行业测评`,source:[`www.fangchan.com/industrylist`],target:`/list/industrylist`},{title:`政策法规`,source:[`www.fangchan.com/policylist`],target:`/list/policylist`}],view:s.Articles};export{u as handler,d as route};