import{__dirname as e,init_esm_shims as t}from"./esm-shims-rNwigI-Q.js";import{config as n}from"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as r}from"./ofetch-CeMUzp5K.js";import"./helpers-qpI1t-yV.js";import{cache_default as i}from"./cache-Dfid4xgQ.js";import{art as a}from"./render-DftO2d-b.js";import{parseDate as o}from"./parse-date-DHsdom8D.js";import{got_default as s}from"./got-Di2lBekK.js";import c from"node:path";t();const l={path:`/:handle`,categories:[`picture`],example:`/artstation/wlop`,parameters:{handle:`Artist handle, can be found in URL`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.artstation.com/:handle`]}],name:`Artist Profolio`,maintainers:[`TonyRL`],handler:u};async function u(t){let l=t.req.param(`handle`),u={accept:`application/json, text/plain, */*`,"accept-language":`en-US,en;q=0.9`,"content-type":`application/json`,"user-agent":n.trueUA},d=await i.tryGet(`artstation:csrfToken`,async()=>(await r.raw(`https://www.artstation.com/api/v2/csrf_protection/token.json`,{method:`POST`,headers:u})).headers.getSetCookie()[0].split(`;`)[0].split(`=`)[1]),{data:f}=await s(`https://www.artstation.com/users/${l}/quick.json`,{headers:{...u,cookie:`PRIVATE-CSRF-TOKEN=${d}`}}),{data:p}=await s(`https://www.artstation.com/users/${l}/projects.json`,{headers:{...u,cookie:`PRIVATE-CSRF-TOKEN=${d}`},searchParams:{user_id:f.id,page:1}}),m=e=>e.replace(/\/\d{14}\/small_square\//,`/large/`),h=p.data.map(t=>({title:t.title,description:a(c.join(e,`templates/description-674eb99b.art`),{description:t.description,image:{src:m(t.cover.small_square_url),title:t.title}}),pubDate:o(t.published_at),updated:o(t.updated_at),link:t.permalink,author:f.full_name,assetsCount:t.assets_count,hashId:t.hash_id,icons:t.icons})),g=await Promise.all(h.map(t=>i.tryGet(t.link,async()=>{if(t.assetsCount>1||!t.icons.image){let{data:n}=await s(`https://www.artstation.com/projects/${t.hashId}.json`,{headers:{...u,cookie:`PRIVATE-CSRF-TOKEN=${d}`}});t.description=a(c.join(e,`templates/description-674eb99b.art`),{description:n.description,assets:n.assets});for(let e of n.assets)if(e.asset_type!==`video`&&e.asset_type!==`image`&&e.asset_type!==`video_clip`&&e.asset_type!==`cover`)throw Error(`Unhandle asset type: ${e.asset_type}`)}return t})));return{title:`${f.full_name} - ArtStation`,description:f.headline,link:f.permalink,logo:f.large_avatar_url,icon:f.large_avatar_url,image:f.default_cover_url,item:g}}export{l as route};