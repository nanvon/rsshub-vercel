import{n as e,t}from"./esm-shims-BKVRry6h.mjs";import"./ofetch-BRplXtiZ.mjs";import"./config-D7dgKYF5.mjs";import"./logger-CkUWGGaS.mjs";import"./helpers-Tm7Pw8Vq.mjs";import{t as n}from"./parse-date-_GmTZfjS.mjs";import{t as r}from"./render-CSqLtqb8.mjs";import{t as i}from"./got-BglkE51W.mjs";import a from"node:path";import{load as o}from"cheerio";e();const s={path:[`/:language?`],name:`每日环球视野`,example:`/idaily`,maintainers:[`zphw`,`nczitzk`],parameters:{language:`语言，见下表，默认为简体中文`},radar:[{source:[`idai.ly/`]}],handler:c,description:`| 简体中文 | 繁体中文 |
| -------- | -------- |
| zh-hans  | zh-hant  |`};async function c(e){let{language:s=`zh-hans`}=e.req.param(),c=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):100,l=new URL(`api/list/v3/iphone/${s}`,`https://idaily-cdn.idailycdn.com`).href,u=`https://idai.ly`,{data:d}=await i(l),f=d.filter(e=>e.ui_sets?.caption_subtitle).slice(0,c).map(e=>{let i=e.ui_sets?.cover_landscape_hd_4k??e.cover_landscape_hd;return{title:`${e.ui_sets?.caption_subtitle} - ${e.title}`,link:e.link_share,description:r(a.join(t,`templates/description-2f40bb93.art`),{images:i?[{src:i,alt:e.ui_sets?.caption_subtitle??e.title}]:void 0,intro:e.content}),author:e.location,category:e.tags?.map(e=>e.name),guid:`idaily-${e.guid}`,pubDate:n(e.pubdate_timestamp,`X`),updated:n(e.lastupdate_timestamp,`X`),enclosure_url:i,enclosure_type:`image/${i.split(/\./).pop()}`}}),{data:p}=await i(u),m=o(p),h=m(`title`).text(),g=new URL(`img/idaily/logo_2x.png`,u).href;return{item:f,title:h,link:u,description:m(`meta[name="description"]`).prop(`content`),language:`zh`,image:g,subtitle:m(`meta[name="keywords"]`).prop(`content`),author:h.split(/\s/)[0],allowEmpty:!0}}export{s as route};