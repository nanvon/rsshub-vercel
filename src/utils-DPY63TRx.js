import{__dirname as e,init_esm_shims as t}from"./esm-shims-B6VgfGYP.js";import{ofetch_default as n}from"./ofetch-D4MiciTC.js";import{art as r}from"./render-CSnicFA3.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import a from"node:path";t();const o=`https://www.newslaundry.com`;async function s(e,t,r=!1){let i=`${o}/api/v1/collections/${e}`,a=t||`${o}/${e}`,s=await n(i);if(!s.items||!s.items.length)throw Error(`No articles found`);let l=(r?s.items.slice(1):s.items).map(e=>c(e.story));return{title:`${s.name} - Newslaundry`,description:s.summary||`${s.name} articles from Newslaundry`,link:a,item:l,language:`en`,logo:`${o}/favicon.ico`,icon:`${o}/favicon.ico`}}function c(t){let n=t.url,s=t[`published-at`]?i(t[`published-at`]):null,c=t[`hero-image-s3-key`]?`https://media.assettype.com/${t[`hero-image-s3-key`]}?auto=format%2Ccompress&fit=max&dpr=1.0&format=webp`:null,l=t.cards?.flatMap(e=>e?.[`story-elements`]?.map(e=>{if(e.type===`text`&&e.text)return{type:`text`,text:e.text};if(e.type===`image`&&e[`image-s3-key`])return{type:`image`,url:`https://media.assettype.com/${e[`image-s3-key`]}?auto=format%2Ccompress&format=webp`,alt:e[`alt-text`]||``,title:e.title||``};if(e.type===`jsembed`&&e[`embed-js`])try{return{type:`jsembed`,content:Buffer.from(e[`embed-js`],`base64`).toString()}}catch{return null}else if(e.type===`youtube-video`&&e.url)return{type:`youtube-video`,url:e.url,embedUrl:e[`embed-url`]||``};return null}).filter(Boolean)||[])||[],u=r(a.join(e,`templates/description-d23336fb.art`),{heroImage:c,heroAlt:t[`hero-image-alt-text`]||``,heroCaption:t[`hero-image-caption`]||``,heroAttribution:t[`hero-image-attribution`],elements:l,subheadline:t.subheadline}),d=t.authors?.map(e=>({name:e.name,url:e.slug?`${o}/author/${e.slug}`:void 0}))||[];return{title:t.headline,link:n,image:c,description:u||t.subheadline,pubDate:s,updated:t[`last-correction-published-at`]?i(t[`last-correction-published-at`]):void 0,author:d.length>0?d:t[`author-name`],category:t.tags?.map(e=>e.name)||[]}}export{s as fetchCollection,o as rootUrl};