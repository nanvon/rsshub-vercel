import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{ofetch_default as n}from"./ofetch-B4O0sZDE.js";import{cache_default as r}from"./cache-CjzVN0X7.js";import{art as i}from"./render-DE4LRFBD.js";import a from"node:path";import{load as o}from"cheerio";t();const s=async e=>{let t=await n(`https://api.aeonmedia.co/graphql`,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({query:`query getImageById($id: ID!) { image(id: $id) { id url alt caption width height } }`,variables:{id:e,site:`Aeon`},operationName:`getImageById`})});return t.data.image.url};function c(t){let n=t.type.toLowerCase(),r=``,s=``,c=``;switch(n){case`film`:r=i(a.join(e,`templates/video-eb6996af.art`),{article:t});break;case`guide`:{s=t.imageSquare?.url,c=t.authors.map(e=>e.bio).join(` `);let n=[`Need To Know`,`What To Do`,`Key Points`,`Learn More`,`Links & Books`],l=Object.keys(t).filter(e=>e.startsWith(`section`)&&e!==`section`),u=l.map(e=>{let r=o(t[e]);r(`p.pullquote`).remove();let i=n.shift();return`<h2>${i}</h2>`+r.html()}).join(``);r=i(a.join(e,`templates/essay-18b14798.art`),{banner:s,authorsBio:c,content:u});break}case`idea`:{s=t.imageLandscape?.url,c=t.authors.map(e=>e.bio).join(` `);let n=o(t.body);n(`p.pullquote`).remove(),r=i(a.join(e,`templates/essay-18b14798.art`),{banner:s,authorsBio:c,content:n.html()});break}default:break}return r}const l=async e=>{let t=await Promise.all(e.map(e=>r.tryGet(e.link,async()=>{let t=await n(e.json),r=t.pageProps.article;e.pubDate=new Date(r.publishedAt).toUTCString();let i=c(r),a=o(i);await Promise.all(a(`dl > dt`).toArray().map(async e=>{let t=a(e).text(),n=await s(t);a(e).replaceWith(`<img src="${n}" alt="${t}">`)}));let l=``;return l=r.type===`film`?r.creditsShort:r.authors.map(e=>e.name).join(`, `),e.description=a.html(),e.author=l,e})));return t};export{l as getData};