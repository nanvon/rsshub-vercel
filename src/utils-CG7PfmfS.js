import{ofetch_default as e}from"./ofetch-CeMUzp5K.js";import{cache_default as t}from"./cache-Dfid4xgQ.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{load as r}from"cheerio";function i(e,t){return[...new Map(e.map(e=>[e[t],e])).values()]}function a(i){return t.tryGet(i.link,async()=>{let t=r(await e(i.link));if(t(`#link-ld-json`).length===0){let e=t(`meta[name="gtm-dataLayer"]`).attr(`content`);if(e){let r=JSON.parse(e);return{title:r.headline,pubDate:n(r.publication_date),description:t(`div.RichTextStoryBody`).html()||t(`:is(.VideoLead, .VideoPage-pageSubHeading)`).html(),category:r.tag_array.split(`,`),guid:t(`meta[name='brightspot.contentId']`).attr(`content`),author:r.author,...i}}else return i}let a=JSON.parse(t(`#link-ld-json`).text()),o;if(a[`@type`]===`NewsArticle`||Array.isArray(a)&&a.some(e=>e[`@type`]===`NewsArticle`)){o=Array.isArray(a)?a.find(e=>e[`@type`]===`NewsArticle`):a,t(`div.Enhancement`).remove();let e=t(`meta[property='article:section']`).attr(`content`);return{...i,title:o.headline,pubDate:n(o.datePublished),updated:n(o.dateModified),description:t(`div.RichTextStoryBody`).html()||t(`:is(.VideoLead, .VideoPage-pageSubHeading)`).html(),category:[...e?[e]:[],...o.keywords??[]],guid:t(`meta[name='brightspot.contentId']`).attr(`content`),author:o.author?.map(e=>e.mainEntity)}}else{o=a;let e=new URL(i.link),r=e.hash?t(e.hash).parent().find(`.LiveBlogPost-body`).html():o.description,s=e.hash?n(Number.parseInt(t(e.hash).parent().attr(`data-posted-date-timestamp`),10)):n(o.coverageStartTime);return{...i,category:o.keywords,pubDate:s,description:r,guid:t(`meta[name='brightspot.contentId']`).attr(`content`)}}})}export{a as fetchArticle,i as removeDuplicateByKey};