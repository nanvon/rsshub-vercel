import"./esm-shims-BmHUa0Yk.js";import"./config-CVBRPN4O.js";import"./logger-BvonkID1.js";import{ofetch_default as e}from"./ofetch-DCfHHxuQ.js";import"./cache-Dfid4xgQ.js";import"./render-CSnicFA3.js";import"./parse-date-DHsdom8D.js";import{baseUrl as t,parseTradeItem as n}from"./utils-Cs18W7YY.js";import{load as r}from"cheerio";const i={path:`/trading/search/:keyword/:mainCat?`,categories:[`new-media`],example:`/dcfever/trading/search/Sony`,parameters:{keyword:`關鍵字`,mainCat:`主要分類 ID，見上表`},name:`二手市集 - 物品搜尋`,maintainers:[`TonyRL`],handler:a};async function a(i){let{keyword:a,mainCat:o}=i.req.param(),s=new URL(`${t}/trading/search.php`,t);s.searchParams.append(`keyword`,a),s.searchParams.append(`type`,`all`),o&&s.searchParams.append(`main_cat`,o),s.searchParams.append(`form_action`,`search_action`);let c=await e(s.href),l=r(c),u=l(`.item_list li a`).toArray().map(e=>(e=l(e),e.find(`.optional`).remove(),{title:e.find(`.trade_title`).text(),link:new URL(e.attr(`href`),s.href).href,author:e.find(`.trade_info`).text()})),d=await Promise.all(u.map(e=>n(e)));return{title:l(`head title`).text(),link:s.href,image:`https://cdn10.dcfever.com/images/android_192.png`,item:d}}export{i as route};