import{n as e,t}from"./esm-shims-DhF_MXa4.mjs";import"./config-PItPnVIx.mjs";import"./logger-BoKmWr7Z.mjs";import"./ofetch-DVhBwO41.mjs";import"./helpers-vRt84cId.mjs";import{t as n}from"./cache-KwJARS5Z.mjs";import{t as r}from"./render-ZYpwNl2L.mjs";import{t as i}from"./parse-date-9Tu6hSFW.mjs";import"./md5-CNuHcJTL.mjs";import"./got-D_XeVuz-.mjs";import"./config-not-found-B5bqcMj-.mjs";import{a,i as o,n as s,o as c,r as l}from"./utils-ov35o40P.mjs";import u from"node:path";e();const d={path:`/search/:option?/:category?/:keyword?/:time?/:order?`,categories:[`anime`],example:`/18comic/search/photos/all/NTR`,parameters:{option:"选项，可选 `video` 和 `photos`，默认为 `photos`",category:"分类，同上表，默认为 `all` 即全部",keyword:`关键字，同上表，默认为空`,time:"时间范围，同上表，默认为 `a` 即全部",order:"排列顺序，同上表，默认为 `mr` 即最新"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1,nsfw:!0},radar:[{source:[`jmcomic.group/`],target:`/:category?/:time?/:order?/:keyword?`}],name:`搜索`,maintainers:[],handler:f,url:`jmcomic.group/`,description:`::: tip
  关键字必须超过两个字，这是来自网站的限制。
:::`};async function f(e){let d=e.req.param(`option`)??`photos`,f=e.req.param(`category`)??`all`,p=e.req.param(`keyword`)??``,m=e.req.param(`time`)??`a`,{domain:h=l}=e.req.query(),g=a(h),_=e.req.param(`order`)??`mr`,v=`${g}/search/${d}${f===`all`?``:`/${f}`}${p?`?search_query=${p}`:`?`}${m===`a`?``:`&t=${m}`}${_===`mr`?``:`&o=${_}`}`,y=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):20,b=o();_=m===`a`?_:`${_}_${m}`,b=`${b}/search?search_query=${p}&o=${_}`;let x=await c(b),S=x.content;f!==`all`&&(S=x.content.filter(e=>e.category.title===s(f))),S=S.slice(0,y);let C=await Promise.all(S.map(e=>n.tryGet(`18comic:search:${e.id}`,async()=>{let n={title:e.name,link:`${g}/album/${e.id}`,guid:`18comic:/album/${e.id}`,updated:i(e.update_at)},a=await c(`${o()}/album?id=${e.id}`);return n.pubDate=new Date(a.addtime*1e3),n.category=a.tags.map(e=>e),n.author=a.author.map(e=>e).join(`, `),n.description=r(u.join(t,`templates/description-afe7e434.art`),{introduction:a.description,images:[`https://cdn-msp3.${h}/media/albums/${e.id}_3x4.jpg`],cover:`https://cdn-msp3.${h}/media/albums/${e.id}_3x4.jpg`,category:n.category}),n})));return{title:`Search Results For '${p}' - 禁漫天堂`,link:v.replace(/\?$/,``),item:C,allowEmpty:!0}}export{d as route};