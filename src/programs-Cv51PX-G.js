import{n as e,t}from"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CfXAR0UO.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-dCh-Ojgc.js";import o from"node:path";import s from"dayjs";import{load as c}from"cheerio";e();const l={path:`/programs`,categories:[`program-update`],example:`/appstorrent/programs`,name:`Programs`,maintainers:[`xzzpig`],handler:u,url:`appstorrent.ru/programs/`};async function u(e){let l=e?.req.query(`limit`)?Number.parseInt(e?.req.query(`limit`)??`20`):20,u=`https://appstorrent.ru`,d=`${u}/programs/`,f={http2:!0},p=c((await a(d,f)).data),m=p(`article.soft-item:not(.locked)`).slice(0,l).toArray().map(e=>{let t=p(e);return{title:t.find(`.subtitle`).text().trim(),link:t.find(`.subtitle a`).attr(`href`),category:[t.find(`.info .category`).text().trim()],version:t.find(`.version`).text(),architecture:t.find(`.architecture`).text().trim(),size:t.find(`.size`).text().trim()}}),h=await Promise.all(m.map(e=>n.tryGet(e.link,async()=>{let n=c((await a(e.link,f)).data),l=i(n(`.tech-info .date-news a`).attr(`href`)?.replace(`https://appstorrent.ru/`,``)??``);return{title:e.title,link:e.link,category:e.category,pubDate:l,description:r(o.join(t,`templates/description-9593c953.art`),{cover:u+n(`.main-title img`).attr(`src`)?.trim(),title:e.title,pubDate:s(l).format(`YYYY-MM-DD`),version:e.version,architecture:e.architecture,compatibility:n(`div.right > div.info > div.right-container > div:nth-child(5) > div > span:nth-child(2) > a`).text(),size:e.size,activation:n(`div.right > div.info > div.right-container > div:nth-child(4) > div > span:nth-child(2) > a`).text(),description:n(`.content .body-content`).first().text(),changelog:n(`.content .body-content`).last().text(),screenshots:n(`.screenshots img`).toArray().map(e=>n(e).attr(`src`)).map(e=>u+e)})}})));return{title:p(`title`).text(),link:d.toString(),allowEmpty:!0,item:h}}export{l as route};