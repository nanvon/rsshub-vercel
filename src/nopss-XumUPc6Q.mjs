import"./esm-shims-D5mxTuu_.mjs";import"./config-CDM38Tpk.mjs";import"./logger-B0B1yUZ6.mjs";import"./ofetch-FkpIOIxH.mjs";import"./helpers-CMl_ndRq.mjs";import{t as e}from"./cache-C6z2tE2n.mjs";import{t}from"./parse-date-Cv8vEJfE.mjs";import{r as n}from"./common-utils-Dv6nfJoL.mjs";import{t as r}from"./got-CxBlPaz_.mjs";import{t as i}from"./timezone-DuBj3K5r.mjs";import{load as a}from"cheerio";import o from"iconv-lite";const s={path:`/nopss/*`,name:`Unknown`,maintainers:[],handler:c};async function c(s){let c=n(s)===`/nopss`?`/GB/219469`:n(s).replace(/^\/nopss/,``),l=`http://www.nopss.gov.cn`,u=`${l}${c}`,d=await r({method:`get`,url:u,responseType:`buffer`}),f=a(o.decode(d.data,`gbk`)),p=f(`.p2j_list_con .clearfix li a`).slice(0,s.req.query(`limit`)?Number.parseInt(s.req.query(`limit`)):40).toArray().map(e=>(e=f(e),{title:e.text(),link:`${l}${e.attr(`href`)}`,pubDate:i(t(e.next().text(),`[YYYY-MM-DD HH:mm]`),8)}));return p=await Promise.all(p.map(t=>e.tryGet(t.link,async()=>{let e=await r({method:`get`,url:t.link,responseType:`buffer`});return t.description=a(o.decode(e.data,`gbk`))(`.text_con`).html(),t}))),{title:f(`title`).text(),link:u,item:p}}export{s as route};