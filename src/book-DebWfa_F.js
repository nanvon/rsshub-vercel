import{n as e,t}from"./esm-shims-BC3isTv8.js";import"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CfXAR0UO.js";import"./helpers-Cqaav28H.js";import{t as n}from"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./got-dCh-Ojgc.js";import o from"node:path";import s from"crypto-js";e();const c=`https://api.creative-comic.tw`,l=`web_desktop`,u=(e,t)=>a(`${c}/book/${e}/info`,{headers:{device:l,uuid:t}}),d=(e,t)=>a(`${c}/book/chapter/${e}`,{headers:{device:l,uuid:t}}),f=(e,t)=>a(`${c}/book/${e}/chapter`,{headers:{device:l,uuid:t}}),p=async(e,t)=>{let{data:n}=await a(`https://storage.googleapis.com/ccc-www/fs/chapter_content/encrypt/${e}/${t}`,{headers:{device:l},responseType:`buffer`});return Buffer.from(n).toString(`base64`)},m=(e,t)=>a(`${c}/book/chapter/image/${e}`,{headers:{device:l,uuid:t}}),h=e=>e(`creative-comic:uuid`,async()=>{let{data:e}=await a(`${c}/guest`,{headers:{device:l}});return e.data}),g=(e,t)=>s.AES.decrypt(e,s.enc.Hex.parse(t.key),{iv:s.enc.Hex.parse(t.iv),mode:s.mode.CBC,padding:s.pad.Pkcs7}).toString(s.enc.Utf8),_=e=>{let t=s.SHA512(e).toString();return{key:t.slice(0,64),iv:t.slice(30,62)}},v=(e,t=`freeforccc2020reading`)=>{let n=g(e,_(t)).split(`:`);return{key:n[0],iv:n[1]}},y={path:`/book/:id/:coverOnly?/:quality?`,categories:[`anime`],example:`/creative-comic/book/117`,parameters:{id:`漫畫 ID，可在 URL 中找到`,coverOnly:"僅獲取封面，非 `true` 時將獲取**全部**頁面，預設 `true`",quality:"閱讀品質，標準畫質 `1`，高畫質 `2`，預設 `1`"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`creative-comic.tw/book/:id/*`],target:`/:id`}],name:`漫畫`,maintainers:[`TonyRL`],handler:b};async function b(e){let{id:a,coverOnly:s=`true`,quality:l=`1`}=e.req.param(),_=await h(n.tryGet),{data:{data:y}}=await u(a,_),{data:{data:b}}=await f(a,_),x=await Promise.all(b.chapters.toSorted((e,t)=>t.idx-e.idx).slice(0,e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`),10):3).map(async e=>{let a;if(s!==`true`&&s!==`1`){let{data:{data:t}}=await d(e.id,_);(t.chapter.free_day===null||t.chapter.free_day===0)&&(a=await Promise.all(t.chapter.proportion.map(async e=>{let{data:t}=await m(e.id,_);t=t.data.key;let r=v(t),i=await p(e.id,l);return n.tryGet(`${c}/fs/chapter_content/encrypt/${e.id}/${l}`,()=>g(i,r))})))}return{title:e.vol_name,description:r(o.join(t,`templates/chapter-a1c569be.art`),{chapter:e,pages:a,cover:e.image1}),pubDate:i(e.online_at),updated:i(e.updated_at),link:`https://www.creative-comic.tw/reader_comic/${e.id}`,author:y.author.map(e=>e.name).join(`, `),category:y.tags.map(e=>e.name)}}));return{title:`${y.name} | CCC創作集`,description:`${y.brief} ${y.description}`,link:y.share_link,image:y.image1,item:x,language:`zh-hant`}}export{y as route};