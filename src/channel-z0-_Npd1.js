import{n as e,t}from"./esm-shims-CMsyBHYK.js";import{t as n}from"./config-DZMnNPig.js";import"./logger-asV68Lay.js";import"./ofetch-CRUPiVpr.js";import"./cache-CpEhLexq.js";import{t as r}from"./render-d6AVTUl2.js";import{t as i}from"./parse-date-CHEO0z5G.js";import{t as a}from"./config-not-found-CX6cWM57.js";import{a as o,i as s,n as c,r as l}from"./discord-api-Ca0Keg_O.js";import u from"node:path";e();const d={path:`/channel/:channelId`,categories:[`social-media`],example:`/discord/channel/950465850056536084`,parameters:{channelId:`Channel ID`},features:{requireConfig:[{name:`DISCORD_AUTHORIZATION`,description:`Discord authorization header from the browser`}],requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`discord.com/channels/:guildId/:channelId/:messageID`,`discord.com/channels/:guildId/:channelId`]}],name:`Channel Messages`,maintainers:[`TonyRL`],handler:f};async function f(e){if(!n.discord||!n.discord.authorization)throw new a(`Discord RSS is disabled due to the lack of <a href="https://docs.rsshub.app/deploy/config#route-specific-configurations">relevant config</a>`);let{authorization:d}=n.discord,f=e.req.param(`channelId`),p=await l(f,d),m=await s(f,d,e.req.query(`limit`)??100),{name:h,topic:g,guild_id:_}=p,v=await o(_,d),{name:y,icon:b}=v,x=m.map(e=>({title:e.content.split(`
`)[0],description:r(u.join(t,`templates/message-311bc85b.art`),{message:e,guildInfo:v}),author:`${e.author.global_name??e.author.username}(${e.author.username})`,pubDate:i(e.timestamp),updated:e.edited_timestamp?i(e.edited_timestamp):void 0,category:`#${h}`,link:`${c}/channels/${_}/${f}/${e.id}`}));return{title:`#${h} - ${y} - Discord`,description:g,link:`${c}/channels/${_}/${f}`,image:`https://cdn.discordapp.com/icons/${_}/${b}.webp`,item:x,allowEmpty:!0}}export{d as route};