import{n as e,t}from"./esm-shims-BKVRry6h.mjs";import"./ofetch-BRplXtiZ.mjs";import{t as n}from"./config-D7dgKYF5.mjs";import"./logger-CkUWGGaS.mjs";import"./proxy-DbO2Yx6a.mjs";import{t as r}from"./cache-Bv3_kFbE.mjs";import"./helpers-Tm7Pw8Vq.mjs";import{t as i}from"./render-CSqLtqb8.mjs";import{t as a}from"./got-BglkE51W.mjs";import{t as o}from"./types-CaC5w-Pp.mjs";import"./puppeteer-CDBgt5OZ.mjs";import"./readable-social-C6om7oNg.mjs";import"./puppeteer-utils-C8rTdZVH.mjs";import{t as s}from"./utils-WX74SsFx.mjs";import c from"node:path";import{load as l}from"cheerio";e();let u=`false`,d=`false`;const f={path:`/search/hot/:fulltext?`,categories:[`social-media`],view:o.SocialMedia,example:`/weibo/search/hot`,parameters:{fulltext:{description:"\n-   使用`/weibo/search/hot`可以获取热搜条目列表；\n-   使用`/weibo/search/hot/fulltext`可以进一步获取热搜条目下的摘要信息（不含图片视频）；\n-   使用`/weibo/search/hot/fulltext?pic=true`可以获取图片缩略（但需要配合额外的手段，例如浏览器上的 Header Editor 等来修改 referer 参数为`https://weibo.com`，以规避微博的外链限制，否则图片无法显示。）\n-   使用`/weibo/search/hot/fulltext?pic=true&fullpic=true`可以获取 Original 图片（但需要配合额外的手段，例如浏览器上的 Header Editor 等来修改 referer 参数为`https://weibo.com`，以规避微博的外链限制，否则图片无法显示。）"}},features:{requireConfig:[{name:`WEIBO_COOKIES`,optional:!0,description:``}],requirePuppeteer:!0,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`s.weibo.com/top/summary`]}],name:`热搜榜`,maintainers:[`xyqfer`,`shinemoon`],handler:p,url:`s.weibo.com/top/summary`};async function p(e){u=e.req.query(`pic`)??`false`,d=e.req.query(`fullpic`)??`false`;let{data:{data:t}}=await s.tryWithCookies(e=>a({method:`get`,url:`https://m.weibo.cn/api/container/getIndex?containerid=106003type%3D25%26t%3D3%26disable_hot%3D1%26filter_type%3Drealtimehot&title=%E5%BE%AE%E5%8D%9A%E7%83%AD%E6%90%9C&extparam=filter_type%3Drealtimehot%26mi_cid%3D100103%26pos%3D0_0%26c_type%3D30%26display_time%3D1540538388&luicode=10000011&lfid=231583`,headers:{Referer:`https://s.weibo.com/top/summary?cate=realtimehot`,Cookie:e,...s.apiHeaders}})),n=null;if(e.req.param(`fulltext`)===`fulltext`){let e=t.cards[0].card_group.map(e=>({title:e.desc,link:`https://m.weibo.cn/search?containerid=100103type%3D1%26q%3D${encodeURIComponent(e.desc)}`,plink:`https://m.weibo.cn/api/container/getIndex?containerid=100103type%3D1%26q%3D${encodeURIComponent(e.desc)}`}));n=await Promise.all(e.map(e=>r.tryGet(e.plink,async()=>(e.description=(await m(e.plink)).content,e))))}else n=t.cards[0].card_group.map(e=>{let t=e.desc,n=`https://m.weibo.cn/search?containerid=100103type%3D1%26q%3D${encodeURIComponent(e.desc)}`;return{title:t,description:e.desc,link:n}});return{title:`微博热搜榜`,link:`https://s.weibo.com/top/summary?cate=realtimehot`,description:`实时热点，每分钟更新一次`,item:n}}async function m(e){let t=await a(e,{headers:{Cookie:n.weibo.cookies??``}}),r=``;try{let e=t.data.data.cards;r=h(e)}catch{}return{content:r}}function h(e){let n=l(`<div id="wbcontent"></div>`)(`#wbcontent`);for(let r of e){if(r.card_type===9){let e=r.mblog.thumbnail_pic??``,a=e.lastIndexOf(`/`),o=e.slice(0,a+1),s=l(r.mblog.text);u===`true`?s(`img`).attr(`width`,`1em`).attr(`height`,`1em`):s(`img`).remove();let f=i(c.join(t,`templates/digest-69514cd7.art`),{author:{link:r.mblog.user.profile_url,name:r.mblog.user.screen_name},msg:s.html(),link:r.scheme,postinfo:r.mblog.created_at,picnum:u===`true`?r.mblog.pic_num:0,pics:u===`true`&&r.mblog.pic_num>0?r.mblog.pics.map(e=>{let t=e.pid;return d===`false`?{url:o+t+`.jpg`,rurl:e.url}:{url:e.url,rurl:e.url}}):[]});n.append(f)}r.card_type===11&&n.append(h(r.card_group))}return n.html()}export{f as route};